'use strict';(function(g){function t(){l=new b.google.maps.Geocoder;f=new b.google.maps.Map(c.getElementById("map-canvas"),{center:new b.google.maps.LatLng(-34.397,150.644),draggable:!0,scrollwheel:!0,zoomControl:!0,scaleControl:!0,mapTypeControl:!0});h=new b.google.maps.Polyline({});h.setMap(f);u();const a=g("#markers",c).find(".tb_repeatable_field"),n=a.length,e=function(b){setTimeout(function(){const c=g(a[b]);var d=c.find("textarea.latlng");d=""!==d.val()?d.val():c.find(".address .tb_lb_option_child").val();
c.attr("data-marker_index",b);v(d,c.find(".title .tb_lb_option_child").val(),c.find(".tb_uploader_input").val(),b,c,function(){++b;b<n&&e(b)})},100)};0<n&&e(0)}function u(){if("undefined"!==typeof l){var a=jQuery,e={zoom:parseInt(a("#zoom_map",c).val()),mapTypeId:b.google.maps.MapTypeId[a("#type_map",c).val()],disableDefaultUI:"yes"===a("#disable_map_ui",c).val(),draggable:!1,scrollwheel:!1};l.geocode({address:a("#map_center",c).val()},function(a,c){c===b.google.maps.GeocoderStatus.OK&&f.setCenter(a[0].geometry.location)});
f.setOptions(e);z(function(){f.setOptions({styles:q[a("#style_map",c).val()]})});h.setOptions({geodesic:"yes"===a("#map_polyline_geodesic",c).val(),strokeColor:a("#map_polyline_color",c).val(),strokeOpacity:a("#map_polyline_color",c).parent().next(".color_opacity").val()||1,strokeWeight:a("#map_polyline_stroke",c).val(),visible:"yes"===a("#map_polyline",c).val()})}}function v(a,c,m,d,p,k){if(null===a||""===a.trim())return null;const r=a.match(/^([-+]?[1-8]?\d(\.\d+)?|90(\.0+)?),?\s*([-+]?180(\.0+)?|[-+]?((1[0-7]\d)|([1-9]?\d))(\.\d+)?)(,\d+z)?$/),
w=function(a){h&&h.getPath().push(a);e[d]=new b.google.maps.Marker({map:f,position:a,icon:m});m||e[d].setIcon();if(""!==c.trim()){const a=new b.google.maps.InfoWindow({content:'<div class="maps-pro-content">'+c+"</div>"});b.google.maps.event.addListener(e[d],"click",function(){a.open(f,e[d])})}p.find("textarea.latlng").val(a.lat()+","+a.lng());k&&k()};g.isArray(r)?w(new b.google.maps.LatLng(r[1],r[4])):l.geocode({address:a},function(a,c){c===b.google.maps.GeocoderStatus.OK&&w(a[0].geometry.location);
return null})}function x(a){void 0!==e[a]&&(e[a].setMap(null),e[a]=null)}function z(a){null===q?g.ajax({url:themifyBuilder.ajaxurl,dataType:"json",type:"POST",data:{action:"tb_get_maps_pro_styles",tb_load_nonce:themifyBuilder.tb_load_nonce},success:function(b){q=b;a()}}):a()}let f,l,e=[],h,b=window.top,c=b.document,q=null,y=null;tb_app.Constructor.map_pro={render:function(a,n){null===y&&(y=!0,b.Themify.LoadCss(builderMapsPro.admin_css,builderMapsPro.v));const m=ThemifyBuilderCommon.Lightbox.$lightbox,
d=document.createElement("div"),p=document.createElement("div"),k=document.createElement("div");d.id="map-preview";p.id="map-canvas";k.className="tb_group_element_static";k.textContent=a.help;d.appendChild(p);d.appendChild(n.create([a.options]));d.appendChild(k);m.on("change.map_pro","#map_center, #zoom_map, #type_map, #style_map, #disable_map_ui, #map_polyline, #map_polyline_geodesic, #map_polyline_stroke, #map_polyline_color",function(a){a.isTrigger&&!g("#map_polyline_color",c).is(a.target)||u()}).on("change.map_pro",
"#markers .tb_lb_option_child",function(){const a=g(this).closest(".tb_repeatable_field"),b=void 0===a.data("marker_index")?e.length:a.data("marker_index");a.attr("data-marker_index",b);x(b);e[b]=v(a.find(".address .tb_lb_option_child").val(),a.find(".title .tb_lb_option_child").val(),a.find(".image .tb_lb_option_child").val(),b,a)}).on("click.map_pro","#markers .tb_delete_row",function(){x(g(this).closest(".tb_repeatable_field").data("marker_index"))});Themify.body.one("themify_builder_lightbox_close",
function(a){m.off(".map_pro");f=h=l=null;e=[]});setTimeout(function(){"object"!==typeof b.google||null===b.google?b.Themify.LoadAsync("//maps.google.com/maps/api/js?v=3.exp&key="+builderMapsPro.key,function(){const a=setInterval(function(){"object"===typeof b.google&&null!==b.google&&"object"===typeof b.google.maps&&(clearInterval(a),t())},300)},!1,"3",function(){return"object"===typeof b.google&&null!==b.google&&"object"===typeof b.google.maps}):t()},10);return d}}})(jQuery);
