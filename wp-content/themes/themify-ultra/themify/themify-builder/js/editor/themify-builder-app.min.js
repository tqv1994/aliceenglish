'use strict';var tb_app;
(function(k,E,u,z,r,m,l){const M="undefined"!==typeof themifyScript&&themifyScript.is_fullSection;void 0===k.fn.themifySerializeObject&&(k.fn.themifySerializeObject=function(){for(var a={},b=this.length-1;-1<b;--b){var c=this[b].type;if(this[b].classList.contains("wp-editor-area")&&"undefined"!==typeof tinyMCE){var e=tinyMCE.get(this[b].id);e&&(this[b].value=e.getContent())}if(""!==this[b].value&&("text"===c||"number"===c||"radio"===c||"checkbox"===c||"textarea"===c||"select-one"===c||"hidden"===
c||"email"===c||"select"===c||"select-multiple"===c)&&(this[b].name||this[b].id)){e=this[b].name?this[b].name:this[b].id;var f=this[b].value;"radio"===c||"checkbox"===c?f=this[b].checked&&f:"select-multiple"===c&&(f=k(this[b]).val());void 0!==a[e]&&"radio"!==c?(!a[e].push&&(a[e]=[a[e]]),f&&a[e].push(f)):f&&(a[e]=f)}}return a});const c=tb_app={activeModel:null,Models:{},Collections:{},Mixins:{},Views:{Modules:{},Rows:{},SubRows:{},Columns:{}},Forms:{},Constructor:{},Utils:{},Instances:{Builder:{}}};
let G={},A=null;c.builderIndex=0;c.mode="default";c.autoSaveCid=null;c.hasChanged=null;c.editing=!1;c.scrollTo=!1;c.eventName=!1;c.beforeEvent=!1;c.saving=!1;c.activeBreakPoint="desktop";c.zoomMeta={isActive:!1,size:100};c.isPreview=!1;c.clearOnModeChange=null;c.Models.Module=E.Model.extend({defaults:{element_id:null,elType:"module",mod_name:"",mod_settings:{}},initialize(){c.Models.Registry.register(this.cid,this);let a=this.get("element_id");a&&1!==G[a]||(a=c.Utils.generateUniqueID(),this.set({element_id:a},
{silent:!0}));G[a]=1},toRenderData(){const a=this.get("mod_name");return{icon:c.Utils.getIcon("ti-"+themifyBuilder.modules[a].icon).outerHTML,name:themifyBuilder.modules[a].name,slug:a,element_id:this.get("element_id"),excerpt:this.getExcerpt()}},getExcerpt(a){a=a||this.get("mod_settings");return this.limitString(a.content_text||a.content_box||a.plain_text||"",100)},limitString(a,b){let c="";""!==a&&(a=this.stripHtml(a).toString(),c=a.length>b?a.substr(0,b):a);return c},stripHtml(a){const b=m.createElement("div");
b.innerHTML=a;return b.textContent||b.innerText||""},setData(a){c.Utils.clearElementId([a]);a=c.Views.init_module(a);a.model.trigger("custom:change",a)},backendLivePreview(){k(".tb_element_cid_"+this.cid).find(".module_excerpt").text(this.getExcerpt())},getPreviewSettings(){return Object.assign({cid:this.cid},themifyBuilder.modules[this.get("mod_name")].defaults)},getIDattr(){let a=this.get("element_id");a||(a=c.Utils.generateUniqueID());return a}});c.Models.SubRow=E.Model.extend({defaults:{element_id:null,
elType:"subrow",gutter:"gutter-default",column_alignment:M?"col_align_middle":"col_align_top",column_h:"",desktop_dir:"ltr",tablet_dir:"ltr",tablet_landscape_dir:"ltr",mobile_dir:"ltr",col_mobile:"-auto",col_tablet_landscape:"-auto",col_tablet:"-auto",cols:{},styling:{}},initialize(){c.Models.Registry.register(this.cid,this);let a=this.get("element_id");a&&1!==G[a]||(a=c.Utils.generateUniqueID(),this.set({element_id:a},{silent:!0}));G[a]=1},setData(a){c.Utils.clearElementId([a]);a=c.Views.init_subrow(a);
a.model.trigger("custom:change",a)}});c.Models.Column=E.Model.extend({defaults:{element_id:null,elType:"column",grid_class:"",component_name:"column",modules:{},styling:{}},initialize(){c.Models.Registry.register(this.cid,this);let a=this.get("element_id");a&&1!==G[a]||(a=c.Utils.generateUniqueID(),this.set({element_id:a},{silent:!0}));G[a]=1},setData(a){c.Utils.clearElementId([a]);a=c.Views.init_column(a);a.model.trigger("custom:change",a)}});c.Models.Row=E.Model.extend({defaults:{element_id:null,
elType:"row",gutter:"gutter-default",column_alignment:M?"col_align_middle":"col_align_top",column_h:"",desktop_dir:"ltr",tablet_dir:"ltr",tablet_landscape_dir:"ltr",mobile_dir:"ltr",col_mobile:"-auto",col_tablet_landscape:"-auto",col_tablet:"-auto",cols:{},styling:{}},initialize(){c.Models.Registry.register(this.cid,this);let a=this.get("element_id");a&&1!==G[a]||(a=c.Utils.generateUniqueID(),this.set({element_id:a},{silent:!0}));G[a]=1},setData(a){c.Utils.clearElementId([a]);a=c.Views.init_row(a);
a.model.trigger("custom:change",a)}});c.Collections.Rows=E.Collection.extend({model:c.Models.Row});c.Models.Registry={items:{},register(a,b){this.items[a]=b},lookup(a){return this.items[a]||null},remove(a){this.items[a]=null;delete this.items[a]},destroy(){for(let a in this.items)this.items[a].destroy();this.items={}}};c.vent=Object.assign({},E.Events);c.Views.register_module=function(a){"default"!==c.mode&&(this.Modules[c.mode]=this.Modules.default.extend(a))};c.Views.init_module=function(a,b){if(void 0===
themifyBuilder.modules[a.mod_name])return!1;!0===b&&void 0===a.mod_settings&&void 0!==themifyBuilder.modules[a.mod_name].defaults&&(a.mod_settings=Object.assign({},themifyBuilder.modules[a.mod_name].defaults));a=a instanceof c.Models.Module?a:new c.Models.Module(a);b=new (this.get_module())({model:a,type:c.mode});return{model:a,view:b}};c.Views.get_module=function(){return this.Modules[c.mode]};c.Views.unregister_module=function(){"default"!==c.mode&&(this.Modules[c.mode]=null,delete this.Modules[c.mode])};
c.Views.module_exists=function(){return this.Modules.hasOwnProperty(c.mode)};c.Views.register_column=function(a){"default"!==c.mode&&(this.Columns[c.mode]=this.Columns.default.extend(a))};c.Views.init_column=function(a){a=a instanceof c.Models.Column?a:new c.Models.Column(a);const b=new (this.get_column())({model:a,type:c.mode});return{model:a,view:b}};c.Views.get_column=function(){return this.Columns[c.mode]};c.Views.unregister_column=function(){"default"!==c.mode&&(this.Columns[c.mode]=null,delete this.Columns[c.mode])};
c.Views.column_exists=function(){return this.Columns.hasOwnProperty(c.mode)};c.Views.register_subrow=function(a){"default"!==c.mode&&(this.SubRows[c.mode]=this.SubRows.default.extend(a))};c.Views.init_subrow=function(a){a=a instanceof c.Models.SubRow?a:new c.Models.SubRow(a);const b=new (this.get_subrow())({model:a,type:c.mode});return{model:a,view:b}};c.Views.get_subrow=function(){return this.SubRows[c.mode]};c.Views.unregister_subrow=function(){"default"!==c.mode&&(this.SubRows[c.mode]=null,delete this.SubRows[c.mode])};
c.Views.subrow_exists=function(){return this.SubRows.hasOwnProperty(c.mode)};c.Views.register_row=function(a){"default"!==c.mode&&(this.Rows[c.mode]=this.Rows.default.extend(a))};c.Views.init_row=function(a){var b=a.attributes;return void 0===b||void 0!==b.cols&&(0<Object.keys(b.cols).length||0<b.cols.length)||void 0!==b.styling&&0<Object.keys(b.styling).length?(a=a instanceof c.Models.Row?a:new c.Models.Row(a),b=new (this.get_row())({model:a,type:c.mode}),{model:a,view:b}):!1};c.Views.get_row=function(){return this.Rows[c.mode]};
c.Views.unregister_row=function(){"default"!==c.mode&&(this.Rows[c.mode]=null,delete this.Rows[c.mode])};c.Views.row_exists=function(){return this.Rows.hasOwnProperty(c.mode)};c.Views.BaseElement=E.View.extend({type:"default",initialize(){this.listenTo(this.model,"custom:change",this.modelChange);this.listenTo(this.model,"destroy",this.remove);this.listenTo(this.model,"edit",this.edit);this.listenTo(this.model,"duplicate",this.duplicate);this.listenTo(this.model,"save",this.save);this.listenTo(this.model,
"importExport",this.importExport);this.listenTo(this.model,"delete",this.delete);this.listenTo(this.model,"copy",this.copy);this.listenTo(this.model,"visibility",this.visibility);this.listenTo(this.model,"paste",this.paste);this.listenTo(this.model,"change:view",this.setView)},setView(a){this.setElement(a)},modelChange(){this.$el.attr(Object.assign({},_.result(this,"attributes")));let a=this.render(),b=c.beforeEvent.data("cid"),d=m.getElementsByClassName("tb_element_cid_"+b)[0];d.parentNode.replaceChild(a.el,
d);"visual"===c.mode?this.model.trigger("visual:change"):("row"===c.eventName&&(b=this.$el.data("cid")),c.undoManager.push(b,c.beforeEvent,this.$el,c.eventName),c.Mixins.Builder.update(this.$el))},remove(){this.$el.remove()},visibility(a,b){a="module"===this.model.get("elType")?"mod_settings":"styling";const c=this.model.get(a),e=b.name;!0===b.checked?delete c[e]:c[e]=b.value;b={};b[a]=c;this.model.set(b,{silent:!0})},copy(a,b){b=this.$el;var d=this.model;a=d.get("elType");"column"===a&&(a=d.get("component_name"));
null!==c.activeModel&&ThemifyConstructor.saveComponent();b=this.getData(b,a);Object.keys(c.GS.styles).length&&(d=c.GS.findUsedItems(b),!1!==d&&d.length&&(b.attached_gs=d));c.Utils.clearElementId([b]);"sub-column"===a&&(a="column");l.Clipboard.set(a,b)},paste(a,b,d){a=this.$el;var e=this.model,f=e.get("elType");let h=null;"column"===f?f=e.get("component_name"):"module"===f&&(h=e.get("mod_name"));"sub-column"===f&&(f="column");const g="style"===b||null!==b&&void 0!==b&&b.classList.contains("tb_paste_style");
b=l.Clipboard.get(f);!1===g&&!1===b&&"column"===f&&(b=l.Clipboard.get("module"),f="module",h=b.mod_name);if(!1===b||!0===g&&"module"===f&&h!==b.mod_name)!0!==d&&l.alertWrongPaste();else{c.eventName="row";if(!0===g){const c=ThemifyStyles.getStyleOptions("module"===f?h:f);d="module"===f?"mod_settings":"styling";const g=this.getData(a,"column"===f?e.get("component_name"):f),k=function(a){if(-1!==a.indexOf("breakpoint_")||-1!==a.indexOf("_apply_all"))return!0;let b=-1!==a.indexOf("_color")?"color":-1!==
a.indexOf("_style")?"style":!1;if(!1!==b){if(b=a.replace("_"+b,"_width"),void 0!==c[b]&&"border"===c[b].type)return!0}else if(-1!==a.indexOf("_unit")){if(b=a.replace(/_unit$/ig,"",""),void 0!==c[b])return!0}else if(-1!==a.indexOf("_w")){if(b=a.replace(/_w$/ig,"",""),void 0!==c[b]&&"font_select"===c[b].type)return!0}else if(void 0!==c[a]&&"radio"===c[a].type)return!0;return!1};void 0===g[d]&&(g[d]={});for(var n in b[d])void 0!==c[n]||k(n)?(g[d][n]=b[d][n],void 0!==c[n]&&(!0===c[n].isFontColor&&void 0!==
b[d][c[n].g+"-gradient"]?g[d][c[n].g+"-gradient"]=b[d][c[n].g+"-gradient"]:(void 0!==c[n].posId&&void 0!==b[d][c[n].posId]&&(g[d][c[n].posId]=b[d][c[n].posId]),void 0!==c[n].repeatId&&void 0!==b[d][c[n].repeatId]&&(g[d][c[n].repeatId]=b[d][c[n].repeatId])))):delete b[d][n];void 0!==b.used_gs&&(g.used_gs=b.used_gs);b=g;delete b.element_id}if("column"===f){b.grid_class=c.Utils.filterClass(a.prop("class"));if(a.hasClass("first")||a.hasClass("last"))b.grid_class+=a.hasClass("first")?" first":" last";
n=a[0].style.width;b.grid_width=n?n.replace("%",""):null;b.component_name=e.get("component_name")}!1===g&&c.Utils.clearElementId([b]);c.hasChanged=!0;!1===g&&"module"===f&&"column"===e.get("elType")&&(e=c.Views.init_module({mod_name:h},!0),f=e.view.render().$el,a[0].getElementsByClassName("tb_holder")[0].appendChild(f[0]),e=e.model,a=f);c.beforeEvent=l.clone(a);e.setData(b);null!==c.activeModel&&l.Lightbox.close()}},importExport(a,b){const d=b.classList.contains("tb_import")?"import":"export",e=this,
f=this.$el,h=this.model;let g=h.get("elType");g="column"===g?h.get("component_name"):g;b=g.charAt(0).toUpperCase()+g.slice(1);const n="subrow"===g?"Sub-Row":"sub-column"===g?"Sub-Column":b;b={contructor:!0,loadMethod:"html",data:{component_form:{name:ThemifyConstructor.label[d+"_tab"].replace("%s",b),options:[{id:"tb_data_field",type:"textarea",label:ThemifyConstructor.label.import_label.replace("%s",n),help:ThemifyConstructor.label[d+"_data"].replace("%s",b),"class":"fullwidth",rows:13}]}}};"import"===
d&&(b.save={});l.Lightbox.$lightbox[0].style.display="none";l.Lightbox.open(b,function(){r.document.body.classList.add("tb_standalone_lightbox")},function(){const b=this.$lightbox;b.addClass("tb_import_export_lightbox");this.setStandAlone(a.clientX,a.clientY);if("import"===d)b.find(".builder_save_button").on("click.tb_import",function(a){a.preventDefault();a.stopPropagation();a=JSON.parse(b.find("#tb_data_field").val());if("column"===g&&"sub-column"===a.component_name||"sub-column"===g&&"column"===
a.component_name)a.component_name=g;if(a.component_name&&a.component_name===g){if("column"===g||"sub-column"===g){var d=f[0].closest(".module_column");const b=d.style.width,e=d.classList;a.grid_class=c.Utils.filterClass(d.className);if(e.contains("first")||e.contains("last"))a.grid_class+=e.contains("first")?" first":" last";a.grid_width=b?b.replace("%",""):null}c.eventName="row";c.hasChanged=!0;c.beforeEvent=l.clone(f);d=function(a){a=c.Utils.clear(a);h.setData(a);l.Lightbox.close()};void 0!==a.used_gs?
c.GS.setImport(a.used_gs,d,a):d(a)}else l.alertWrongPaste()});else{let a=e.getData(f,g);a.component_name=g;const d=c.GS.findUsedItems(a);if(!1!==d){const b={};for(let a=d.length-1;-1<a;--a){let e=c.GS.styles[d[a]],f=k.extend(!0,{},e.data[0]);"row"===e.type||"subrow"===e.type?f=f.styling:void 0!==f.cols?(f=f.cols[0])&&(f="column"===e.type?f.styling:void 0!==f.modules?f.modules[0].mod_settings:void 0):f=void 0;void 0!==f&&0<Object.keys(f).length&&(b[d[a]]={title:e.title,type:e.type,data:c.Utils.clear(f,
!1)})}Object.keys(b).length&&(a.used_gs=b)}a=JSON.stringify(a);b.find("#tb_data_field").val(a).on("click",function(){k(this).trigger("focus").trigger("select")})}u.body.one("themify_builder_lightbox_close",function(){b.removeClass("tb_import_export_lightbox");r.document.body.classList.remove("tb_standalone_lightbox");"import"===d&&b.find(".builder_save_button").off("click.tb_import")})})},getData(a,b){var d={};switch(b){case "row":case "subrow":d=c.Utils._getRowSettings(a.closest("."+("row"===b?"module_row":
"active_subrow"))[0],b);break;case "module":d=c.Models.Registry.lookup(a.closest(".active_module").data("cid")).attributes;break;case "column":case "sub-column":a=a.closest(".module_column"),d=a.closest("column"===b?".module_row":".active_subrow"),d=c.Utils._getRowSettings(d[0],"column"===b?"row":"subrow").cols[a.index()]}return c.Utils.clear(d)},duplicate(a,b){a=this.$el;b=l.clone(a);null!==c.activeModel&&l.Lightbox.$lightbox.is(":visible")&&ThemifyConstructor.saveComponent();a.removeClass("tb_element_cid_"+
this.model.cid);b.hide().insertAfter(a);const d=this.getData(b,this.model.get("elType"));c.eventName="duplicate";c.beforeEvent=b;c.hasChanged=!0;this.model.setData(d);a.addClass("tb_element_cid_"+this.model.cid)},edit(a,b){if(c.isPreview)return!0;"breadcrumb"!==a?c.ActionBar.breadCrumbsPath.lightbox=null:a=null;let d=c.hasChanged=!1,e=l.Lightbox.$lightbox,f=this.model.get("elType"),h=!1,g="module"===f?this.model.get("mod_name"):f,n=!1;if(null!==a){const e=b?b.classList:a.target,f=e.contains("tb_dragger");
if(!0===f&&(!b.hasAttribute("data-v")||""===b.getAttribute("data-v")))return;"dblclick"===a.type&&this.model.cid!==c.autoSaveCid&&c.ActionBar.clear();n=f||e.contains("tb_styling");if(!0===n)this.model.set({styleClicked:!0},{silent:!0}),!0===f&&(h=function(a){var b=e.contains("tb_dragger_padding")?"p":"m";b=ThemifyConstructor.label[b];const c=a.getElementsByClassName("tb_style_toggle");for(let a=c.length-1;-1<a;--a)if(c[a].textContent===b){c[a].classList.contains("tb_closed")&&c[a].click();setTimeout(function(){c[a].closest(".tf_scrollbar").scrollTop=
c[a].offsetTop},10);break}});else if(e.contains("tb_visibility_component"))d=!0,this.model.set({visibileClicked:!0},{silent:!0});else if(!0===(e.contains("tb_swap")?!1:"layout-part"===g?!0:u.body.triggerHandler("tb_edit_"+g,[a,this.el,this.model]))&&"visual"===c.mode&&!c.Forms.LayoutPart.id&&("dblclick"===a.type||e.contains("tb_edit"))){c.activeModel=this.model;c.Forms.LayoutPart.edit(this.el);return}}null!==c.activeModel&&null!==c.autoSaveCid&&this.model.cid!==c.autoSaveCid&&ThemifyConstructor.saveComponent(!0);
c.activeModel=this.model;if(c.autoSaveCid===this.model.cid){a=null;if(!0===n)a=e.find('a[href="#tb_options_styling"]'),this.model.unset("styleClicked",{silent:!0});else if(!0===d)a=e.find('a[href="#tb_options_visibility"]'),this.model.unset("visibileClicked",{silent:!0});else if("module"===f||"row"===f)a=e.find('a[href="#tb_options_setting"]');null!==a&&0<a.length&&(a[0].click(),!1!==h&&!0===n&&h(l.Lightbox.$lightbox[0].querySelector("#tb_lightbox_container")))}else l.Lightbox.open({loadMethod:"inline",
templateID:g},!1,h),!1===c.GS.isGSPage&&(c.ActionBar.hideContextMenu(),("row"!==g||"row"===g&&null!==c.ActionBar.breadCrumbsPath.lightbox)&&l.Lightbox.$lightbox[0].getElementsByClassName("tb_action_breadcrumb")[0].appendChild(c.ActionBar.getBreadCrumbs(c.Instances.Builder[c.builderIndex].el.getElementsByClassName("tb_element_cid_"+this.model.cid)[0])))},delete(a,b,d){let e=this.$el,f=this.model;b=a=f.cid;let h=f.get("elType");if(!0===d||confirm(themifyBuilder.i18n[h+"DeleteConfirm"])){d=e.closest(".module_row");
var g="row",n="",p,q={};"row"===h?(q.pos_cid=d.next(".module_row"),q.pos="before",0===q.pos_cid.length&&(q.pos="after",q.pos_cid=d.prev(".module_row")),g="delete_row",q.pos_cid=q.pos_cid.data("cid")):a=d.data("cid");d=l.clone(d);"row"!==h&&(p=e.closest(".active_subrow"));f.destroy();p&&0<p.length&&0===p.find(".active_module").length&&p.addClass("tb_row_empty");"row"!==h&&(n=k(".tb_element_cid_"+a),p=n.closest(".module_row"),0===p.find(".active_module").length&&p.addClass("tb_row_empty"));c.hasChanged=
!0;c.undoManager.push(a,d,n,g,q);c.toolbar.pageBreakModule.countModules();c.activeModel&&c.activeModel.cid===b&&l.Lightbox.$lightbox.find(".tb_close_lightbox")[0].click()}},save(a){c.activeModel&&null!==c.autoSaveCid&&ThemifyConstructor.saveComponent(!0);const b=this.model.get("elType"),d={contructor:!0,loadMethod:"html",save:{done:"save"},data:{}},e=this.model.cid;d.data["s"+b]={options:[{id:"item_title_field",type:"text",label:ThemifyConstructor.label.title},{id:"item_layout_save",type:"checkbox",
label:"",options:[{name:"layout_part",value:ThemifyConstructor.label.slayout_part}],new_line:!1,after:"",help:'Any changes made to a Layout Part are saved and reflected everywhere else they are being used (<a href="https://themify.me/docs/builder#layout-parts" target="_blank">learn more</a>)'}]};l.Lightbox.$lightbox[0].style.display="none";l.Lightbox.open(d,function(){r.document.body.classList.add("tb_standalone_lightbox")},function(d){const f=this.$lightbox,g=function(a){if("keypress"!==a.type||
13===a.keyCode){a.preventDefault();a.stopPropagation();l.showLoader("show");a=c.Models.Registry.lookup(e);switch(b){case "row":var f=b;var g=c.Utils._getRowSettings(k(".tb_element_cid_"+e)[0]);c.Utils.clearElementId([g],!0);break;case "module":f=a.get("mod_name"),g={mod_name:f,element_id:c.Utils.generateUniqueID(),mod_settings:a.get("mod_settings")}}g=c.Utils.clear(g);var h=ThemifyStyles.builder_id;a=k.extend(c.Forms.serialize(d),{action:"tb_save_custom_item",item:JSON.stringify(g),tb_load_nonce:themifyBuilder.tb_load_nonce,
postid:h,type:b});var n=a.item_layout_save;f=c.GS.findUsedItems(g);!1!==f&&(a.usedGS=f);k.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:a,success(a){if("success"===a.status){const d=function(a){k("#tb_module_panel",r.document).find(".tb_module_panel_search_text").val("");if(n){c.hasChanged=!0;var d={mod_name:"layout-part",mod_settings:{selected_layout_part:a.post_name}};delete a.status;0<ThemifyConstructor.layoutPart.data.length&&ThemifyConstructor.layoutPart.data.push(a);var f=
k(".tb_element_cid_"+e);let g,h,n=l.clone(f);"row"===b?(h=c.Views.init_row({cols:[{grid_class:"col-full first last",element_id:c.Utils.generateUniqueID(),modules:[d]}]}).view.render(),d=c.Models.Registry.lookup(h.$el.find(".active_module").data("cid"))):(d=c.Views.init_module(d),h=d.view.render(),d=d.model);f.replaceWith(h.el);if("visual"===c.mode){const a=function(d,f,e){-1!==e.data.indexOf("tb_load_module_partial",3)&&(k(this).off("ajaxComplete",a),g=c.liveStylingInstance.$liveStyledElmt,"row"===
b&&(g=g.closest(".module_row")),c.undoManager.push(h.$el.data("cid"),n,g,"row"))};k(m).ajaxComplete(a);d.trigger("custom:preview:refresh",d.get("mod_settings"))}else g=h.el,c.undoManager.push(h.$el.data("cid"),n,g,"row")}if(!0===c.toolbar.libraryItems.is_init){f=k(".tb_library_item_list");a=c.toolbar.libraryItems.template([a]);"visual"===c.mode&&(f=f.add(c.toolbar.$el.find(".tb_library_item_list")));f=f.get();for(let b=0,c=f.length;b<c;++b)f[b].insertAdjacentHTML("afterbegin",a),f[b].previousElementSibling.getElementsByClassName("current")[0].click()}l.showLoader("hide");
l.Lightbox.close()};n?(ThemifyStyles.builder_id=a.id,c.Utils.saveCss([g],"",a.id).done(function(){ThemifyStyles.builder_id=h;d(a)})):d(a)}else alert(a.msg)}})}};f.addClass("tb_save_module_lightbox");this.setStandAlone(a.clientX,a.clientY);f.on("click.saveLayout",".builder_save_button",g).on("keypress.saveLayout","input",g);u.body.one("themify_builder_lightbox_close",function(){f.removeClass("tb_save_module_lightbox").off(".saveLayout");r.document.body.classList.remove("tb_standalone_lightbox")})})}});
c.Views.BaseElement.extend=function(a){const b=this,c=E.View.extend.apply(this,arguments);c.prototype.events=Object.assign({},this.prototype.events,a.events);c.prototype.initialize=function(){"function"===typeof b.prototype.initialize&&b.prototype.initialize.apply(this,arguments);"function"===typeof a.initialize&&a.initialize.apply(this,arguments)};return c};c.Views.Modules["default"]=c.Views.BaseElement.extend({tagName:"div",attributes(){const a={"class":"active_module tb_element_cid_"+this.model.cid,
"data-cid":this.model.cid,draggable:"visual"!==c.mode},b=this.model.get("mod_settings");if("visual"===c.mode){if("hide_all"===b.visibility_all||"hide"===b.visibility_desktop||"hide"===b.visibility_tablet||"hide"===b.visibility_tablet_landscape||"hide"===b.visibility_mobile)a["class"]+=" tb_visibility_hidden";a["class"]+=" tb_module_front"}void 0!==b.custom_css_id&&""!==b.custom_css_id&&(a.id=b.custom_css_id);return a},template:"visual"===c.mode?null:wp.template("builder_module_item"),initialize(){this.listenTo(this.model,
"dom:module:unsaved",this.removeUnsaved)},removeUnsaved(){this.model.destroy()},render(){"visual"!==c.mode&&(this.el.innerHTML=this.template(this.model.toRenderData()),c.Utils.visibilityLabel(this.el,this.model));return this}});c.Views.Columns["default"]=c.Views.BaseElement.extend({tagName:"div",attributes(){const a={"class":"module_column tb_element_cid_"+this.model.cid+" tb_"+this.model.get("element_id")+" tf_box "+this.model.get("grid_class"),"data-cid":this.model.cid};this.model.get("grid_width")&&
(a.style="width:"+this.model.get("grid_width")+"%");a["class"]+="column"!==this.model.get("component_name")?" sub_column":" tb-column";return a},render(){const a=this.model.get("modules");this.el.innerHTML=l.templateCache.get("tmpl-builder_column_item");if(a){const d=this.el.getElementsByClassName("tb_holder")[0];for(let e in a)if(void 0!==a[e]&&null!==a[e]){var b=a[e];(b=void 0===b.cols?c.Views.init_module(b):c.Views.init_subrow(b))&&d.appendChild(b.view.render().el)}"sub-column"===this.model.get("component_name")&&
d.classList.add("tb_subrow_holder")}return this}});c.Views.SubRows["default"]=c.Views.BaseElement.extend({tagName:"div",attributes(){return{"class":"active_module active_subrow tb_element_cid_"+this.model.cid,"data-cid":this.model.cid,draggable:"visual"!==c.mode}},template:wp.template("builder_subrow_item"),render(){const a=this.model.get("cols"),b=Object.keys(a).length;this.el.innerHTML=this.template({element_id:this.model.get("element_id")});if(0<b){const d=this.el.getElementsByClassName("subrow_inner")[0];
let e=!1;for(let f=0;f<=b;++f)void 0!==a[f]&&null!==a[f]&&(a[f].component_name="sub-column",d.appendChild(c.Views.init_column(a[f]).view.render().el),!1===e&&void 0!==a[f].modules&&0<a[f].modules.length&&(e=!0));!1===e&&this.el.classList.add("tb_row_empty")}c.Utils.selectedGridMenu(this.el,"subrow");c.Utils.visibilityLabel(this.el,this.model);return this}});c.Views.Rows["default"]=c.Views.BaseElement.extend({tagName:"div",attributes(){const a=this.model.get("styling"),b={"class":"module_row themify_builder_row tb_element_cid_"+
this.model.cid+" tf_clearfix tf_box tb_"+this.model.get("element_id"),"data-cid":this.model.cid,draggable:"visual"!==c.mode};null!==a&&(void 0!==a.custom_css_row&&""!==a.custom_css_row&&(b["class"]+=" "+a.custom_css_row),void 0!==a.custom_css_id&&""!==a.custom_css_id&&(b.id=a.custom_css_id),"fullwidth-content"===a.row_width&&(b["class"]+=" fullwidth"));return b},render(){const a=this.model.get("cols"),b=Object.keys(a).length;let d=!1;this.el.innerHTML=l.templateCache.get("tmpl-builder_row_item");
const e=this.el.getElementsByClassName("row_inner")[0];if(0<b)for(let f=0;f<=b;++f)void 0!==a[f]&&null!==a[f]&&(a[f].component_name="column",e.appendChild(c.Views.init_column(a[f]).view.render().el),!1===d&&void 0!==a[f].modules&&(0<a[f].modules.length||"object"===typeof a[f].modules&&0<Object.keys(a[f].modules).length)&&(d=!0));else c.Utils._addNewColumn({newclass:"col-full",component:"column"},e);!1===d&&this.el.classList.add("tb_row_empty");c.Utils.selectedGridMenu(this.el,"row");c.Utils.visibilityLabel(this.el,
this.model);return this}});c.Views.Builder=E.View.extend({type:"default",lastRow:null,events:{"click .tb_import_layout_button":"importLayoutButton"},initialize(){this.$el.off("tb_init tb_new_row").on("tb_init",this.init.bind(this)).on("tb_init",this.newRowAvailable.bind(this))},init(a){"visual"===c.mode&&setTimeout(function(){c.Utils._onResize(!0)},1500);const b=this;setTimeout(function(){c.ActionBar.init();c.Utils.setCompactMode(b.el.getElementsByClassName("module_column"));b.insertLayoutButton();
"visual"!==c.mode&&c.GS.init()},1E3);G={}},render(){const a=this.collection;c.Utils.clearLastEmptyRow(a.models);for(let b=0,d=a.models.length;b<d;++b){let d=c.Views.init_row(a.models[b]);!1!==d&&this.el.appendChild(d.view.render().el)}return this},insertLayoutButton(){this.removeLayoutButton();this.lastRowAddBtn();var a=this.el.getElementsByClassName("module_row");void 0!==a[0]&&2>a.length&&a[0].classList.contains("tb_row_empty")&&(a=m.createElement("a"),a.className="tb_import_layout_button",a.href=
"#",a.textContent=themifyBuilder.i18n.text_import_layout_button,this.el.appendChild(a))},removeLayoutButton(){const a=this.el.getElementsByClassName("tb_import_layout_button");for(let b=a.length-1;-1<b;--b)a[b].parentNode.removeChild(a[b])},importLayoutButton(a){c.Views.Toolbar.prototype.loadLayout(a)},newRowAvailable(a,b){const d=this.el.children,e=d.length;let f=!0;if(0!==e&&!0!==b)for(b=e-1;-1<b;--b)if(d[b].classList.contains("module_row")){f=!1;break}if(!0===f)return a=c.Views.init_row(c.Utils.grid(a||
1)[0]).view.render().$el,a[0].className+=" tb_new_row",this.el.insertBefore(a[0],this.lastRow),c.Utils.setCompactMode(a[0].getElementsByClassName("module_column")),c.Mixins.Builder.update(a),c.Utils.calculateHeight(),a},lastRowShowHide(a){this.lastRow&&(a?this.lastRow.classList.remove("hide"):(this.lastRow.classList.remove("expanded"),this.lastRow.classList.add("hide")))},lastRowAddBtn(){if(!0!==c.GS.isGSPage){var a=m.getElementById("tb_add_container"),b=m.createElement("div");null!==a&&a.parentNode.removeChild(a);
this.lastRow=m.createElement("div");var d=null;this.lastRow.id="tb_add_container";b.className="tb_last_add_btn";b.textContent="+";this.lastRow.addEventListener("click",function(a){a.preventDefault();const b=a.target,e=b.closest(".tb_row_grid");null!==e?(this.classList.remove("expanded"),c.Mixins.Builder.rowDrop(c.Utils.grid(e.dataset.col),k("<div>").insertBefore(this),!0,!0)):b.classList.contains("tb_add_blocks")?(this.classList.remove("expanded"),c.toolbar.common.show(a,k(this).find(".tb_last_add_btn")),
c.toolbar.common.clicked=this.previousElementSibling?k(this.previousElementSibling):null,c.toolbar.common.btn[0].querySelector('[data-target="tb_module_panel_rows_wrap"]').click()):b.classList.contains("tb_last_add_btn")&&(null===d&&(d=!0,this.appendChild(m.getElementById("tmpl-last_row_add_btn").content.cloneNode(!0))),this.classList.add("expanded"))});this.lastRow.appendChild(b);this.el.appendChild(this.lastRow)}}});c.Mixins.Builder={before:null,zindex:null,r:null,w:null,h:null,type:null,isFullWidth:null,
update(a){if("visual"===c.mode){const b=null!==c.activeModel?c.activeModel.get("elType"):a?c.Models.Registry.lookup(a.data("cid")).get("elType"):null;c.Utils.loadContentJs(a,b)}},columnDrag(a,b,d,e){if(b)if(b instanceof jQuery&&(b=b.get()),a=b.length,d&&e)for(d=parseFloat((("gutter-narrow"===d?1.6:"gutter-none"===d?0:3.2)-("gutter-narrow"===e?1.6:"gutter-none"===e?0:3.2))*(a-1)/a),e=a-1;-1<e;--e)(a=b[e].style.width)&&(b[e].style.width=parseFloat(a)+d+"%");else{for(d=a-1;-1<d;--d)b[d].style.width=
"";c.Utils.setCompactMode(b)}else{a.stopPropagation();c.ActionBar.clear();c.ActionBar.disable=!0;c.ActionBar.hoverCid=null;var f,h=!1,g=u.body[0].classList,n=a.target,p=c.Utils.getMouseEvents(),q=n.parentNode,w=n.classList.contains("tb_drag_right")?"w":"e",t=a.clientX,v=m.createElement("div"),x=m.createElement("div"),Q=l.clone(q.closest(".module_row")),r=q.parentNode;b=r.classList.contains("direction-rtl");var L=r.offsetWidth;v.className=x.className="tb_grid_drag_tooltip";n.classList.add("tb_drag_grid_current");
q.classList.add("tb_element_clicked");g.add("tb_start_animate","tb_drag_grid_start");if("w"===w){v.className+=" tb_grid_drag_right_tooltip";x.className+=" tb_grid_drag_left_tooltip";var y=b?q.previousElementSibling:q.nextElementSibling;var K=q.offsetWidth;var C=K+n.offsetWidth}else v.className+=" tb_grid_drag_left_tooltip",x.className+=" tb_grid_drag_right_tooltip",y=b?q.nextElementSibling:q.previousElementSibling,K=C=q.offsetWidth;q.style.willChange=y.style.willChange="width";var F=function(a){a.stopImmediatePropagation();
f&&cancelAnimationFrame(f);f=requestAnimationFrame(function(){h=!0;var b=parseInt(a.clientX)-t;b=C+("e"===w?-b:b);const c=parseFloat(100*b/L).toFixed(2);if(5<=c&&100>c){let a=I;a+="w"===w?-(b-K):K-b;const d=parseFloat(100*a/L).toFixed(2);5<d&&100>d&&(y.style.width=a+"px",q.style.width=b+"px",v.textContent=c+"%",x.textContent=d+"%")}})};m.addEventListener(p.mouseup,function(a){a.stopImmediatePropagation();this.removeEventListener(p.mousemove,F,{passive:!0});f&&cancelAnimationFrame(f);q.style.willChange=
y.style.willChange="";requestAnimationFrame(function(){h&&(q.style.width=parseFloat(v.textContent).toFixed(2)+"%");v.remove();x.remove();q.classList.remove("tb_element_clicked");n.classList.remove("tb_drag_grid_current");c.ActionBar.disable=null;c.ActionBar.clear();g.remove("tb_start_animate","tb_drag_grid_start");if(h){var a={default:{"col6-1":14,"col5-1":17.44,"col4-1":22.6,"col4-2":48.4,"col2-1":48.4,"col4-3":74.2,"col3-1":31.2,"col3-2":65.6},narrow:{"col6-1":15.33,"col5-1":18.72,"col4-1":23.8,
"col4-2":49.2,"col2-1":49.2,"col4-3":74.539,"col3-1":32.266,"col3-2":66.05},none:{"col6-1":16.666,"col5-1":20,"col4-1":25,"col4-2":50,"col2-1":50,"col4-3":75,"col3-1":33.333,"col3-2":66.666}},b=r.children,d=3.2,e=a["default"];r.classList.contains("gutter-narrow")?(e=a.narrow,d/=2):r.classList.contains("gutter-none")&&(e=a.none,d=0);a=d*(b.length-1);for(d=b.length-1;-1<d;--d)if(b[d]!==y){var t=b[d].style.width;t?t=parseFloat(t):(t=c.Utils.filterClass(b[d].className),t=e[t]);a+=t}y.style.width=100-
a+"%";c.Utils.setCompactMode([q,y]);b=k(q.closest(".module_row"));e=!0===c.hasChanged;c.hasChanged=!0;c.undoManager.push(b.data("cid"),Q,b,"row");c.hasChanged=e;u.body.triggerHandler("tb_grid_changed",[b])}h=f=I=y=K=C=null})},{once:!0,passive:!0});if(y){var I=parseInt(y.offsetWidth)-2;n.appendChild(v);n.appendChild(x);m.addEventListener(p.mousemove,F,{passive:!0})}}},updateModuleSort(a){if(!0!==c.GS.isGSPage){var b=this,d=c.Utils.getMouseEvents(),e;a.addEventListener(d.mousedown,function(a){if(1!==
a.which||a.target.closest(".tb_dragger")||a.target.closest(".tb_editor_on")||a.target.closest(".tb_disable_sorting"))e=null;else if(e=a.target,e.classList.contains("tb_grid_drag"))b.columnDrag(a);else if("visual"===c.mode){let b=e.closest("[draggable]");if(b&&!1===b.draggable){const c=function(a){m.removeEventListener(d.mouseup,c,{passive:!0,once:!0});r.removeEventListener(d.mouseup,c,{passive:!0,once:!0});b&&(b.removeEventListener("dragend",c,{passive:!0,once:!0}),b.setAttribute("draggable",!1));
b=null};if(a=e.closest("[contenteditable=true]"))a.setAttribute("contentEditable",!1),a=null;b.setAttribute("draggable",!0);m.addEventListener(d.mouseup,c,{passive:!0,once:!0});r.addEventListener(d.mouseup,c,{passive:!0,once:!0});b.addEventListener("dragend",c,{passive:!0,once:!0})}}},{passive:!0});a.addEventListener("dragstart",function(a){let d=a.target&&e?a.target.closest("[draggable]"):null,f=d&&d.classList.contains("module_row");if("visual"===c.mode){if(!a.target||a.target.nodeType===Node.TEXT_NODE||
a.target.closest(".tb_editor_on"))return;d&&"desktop"!==c.activeBreakPoint&&d.classList.contains("active_module")&&(d=null)}if(!d||d.classList.contains("tb_grid_drag")||d.classList.contains("tb_dragger")||!e.classList.contains("tb_move")&&e.closest("#"+c.ActionBar.el.id)||!e.classList.contains("tb_move")&&(f||d.classList.contains("active_subrow")))if(!d||!f||!d.classList.contains("tb-page-break"))return e=null,a.preventDefault(),!1;e=null;a.stopImmediatePropagation();let n=d.classList;f||(f=n.contains("tb_page_break_module")||
n.contains("predesigned_row")||n.contains("tb_item_row"));let p,q,w=null,t=f?"row":n.contains("tb_row_grid")?"column":"module",v=t,x=d.closest(".module_row"),Q=u.body[0],O=0,L=0,y,K,C,F=null,I=null,N=c.toolbar.$el,D=c.Instances.Builder[c.builderIndex].el,B=m.createElement("div");N=N.add(k("#tb_fixed_bottom_scroll",r.document));const z=f&&n.contains("module_row"),A=function(a){function b(a){if(null===I&&F){I=!0;let c;c=("tb_toolbar"===a||"wpadminbar"===a?"-":"+")+("="+e*f+"px");F.stop().animate({scrollTop:c},
{duration:10,complete(){!0===I&&(I=null,b(a))}})}}let d=k("body",r.document);"visual"===c.mode&&(d=d.add(Q));C&&clearInterval(C);N.off(".tb_drag");if(!0===a)"row"===v&&"visual"===c.mode&&c.toolbar.$el.find('.tb_zoom[data-zoom="100"]').click(),d.removeClass("tb_start_animate tb_drag_start tb_drag_"+v),N=I=C=F=null;else{var e=1,f=5;"visual"!==c.mode&&(F=c.toolbar.$el.closest(".interface-interface-skeleton__content"),F[0]||(F=k(".edit-post-layout__content").first()),F[0]?e/=2:F=null);null===F&&(F="desktop"===
c.activeBreakPoint?k("body,html"):k("body,html",r.document));d.addClass("tb_start_animate tb_drag_start tb_drag_"+v);"row"===v&&"visual"===c.mode&&c.toolbar.$el.find('.tb_zoom[data-zoom="50"]').click();if(0<e)N.on("dragenter.tb_drag",function(){C&&clearInterval(C);f=5;C=setInterval(function(){51>f?f+=5:(clearInterval(C),C=null)},1200);y=null;null!==w&&(w.style.display="none");for(let a=D.querySelectorAll("[data-pos]"),b=a.length-1;-1<b;--b)a[b].removeAttribute("data-pos");b(this.id)}).on("dragleave.tb_drag",
function(){C&&clearInterval(C);f=5;I=C=null;F.stop()})}},E=function(a){a.dataTransfer.dropEffect=a.dataTransfer.effectAllowed="none";y&&y.removeAttribute("data-pos");null!==w&&(w.style.display="none")},G=function(a){a.preventDefault();a.stopImmediatePropagation();p&&(p.style.top=a.clientY-q+"px");if(!a.target||null!==I||a.target===Q||a.target===d||"IMG"===a.target.tagName||"module"===t&&a.target.classList.contains("module_row"))E(a);else if(null===w||a.target!==w&&!a.target.classList.contains("tb_sortable_placeholder"))if(a.dataTransfer.effectAllowed=
"move",0===O||0===L||10<a.clientY-O||10<O-a.clientY||10<a.clientX-L||10<L-a.clientX||a.target!==y){O=a.clientY;L=a.clientX;let c=a.target;var b=c.getBoundingClientRect();b=.5<(O-b.top)/b.height?"bottom":"top";if(c!==N[0]&&c!==N[1]){if(!p){if(c.classList.contains("module_column")){if(c=c.getElementsByClassName("tb_holder")[0],!c){E(a);return}}else c.classList.contains("tb_dragger")&&(c=c.parentNode);if(c.classList.contains("tb_holder")&&0<c.childElementCount&&(c="top"===b&&c.firstChild!==d?c.firstChild:
c.lastChild,c===d)){E(a);return}}if(y&&y!==c){a="top"===b?c.previousSibling:c.nextElementSibling;if(a===y&&(a=a.dataset.pos,"top"===b&&"bottom"===a||"bottom"===b&&"top"===a))return;y.removeAttribute("data-pos")}c.dataset.pos!==b&&(c.setAttribute("data-pos",b),null!==w&&(w.style.display="",c.classList.contains("tb_holder")?c.appendChild(w):"top"===b?c.before(w):c.after(w)));y=c}}},M=function(a){a.stopImmediatePropagation();c.ActionBar.clear();c.ActionBar.disable=!0;c.ActionBar.hoverCid=null;c.toolbar.common.hide(!0);
this.classList.add("tb_draggable_item");A();p&&(p.style.top=a.clientY+"px")},J=function(a){a.stopImmediatePropagation()},R=function(a){a.target&&(a.preventDefault(),a.stopImmediatePropagation());K=c.hasChanged=!0;d.classList.remove("tb_draggable_item");var e=!0,g=a.target?a.target:a;g.classList.contains("module_column")?g=g.querySelector("[data-pos]"):g.classList.contains("tb_dragger")&&(g=g.closest("[draggable]"));if(g===w||g.classList.contains("tb_sortable_placeholder"))g=g.closest(".tb_active_builder").querySelector("[data-pos]"),
g.classList.contains("tb_sortable_placeholder")&&(g=g.closest(".tb_holder"));w&&w.remove();if(g&&("module"!==t||!g.classList.contains("module_row"))){a=x?d:d.cloneNode(!0);var h=d.closest(".active_subrow"),q=d.closest(".module_row");z&&(x=k(d).next(".module_row"),0===x.length&&(x=k(d).prev(".module_row"),e=!1),x=x.data("cid"));if(g.classList.contains("tb_holder"))g.appendChild(a);else{const b="top"===g.getAttribute("data-pos")?g:g.nextElementSibling;g.parentNode.insertBefore(a,b)}var p=k(a);if(f)if("visual"===
c.mode&&("desktop"===c.activeBreakPoint?k("html,body"):k("body",r.document)).scrollTop(k(d).offset().top),z)h=k(d).next(".module_row"),q=!0,0===h.length&&(h=k(d).prev(".module_row"),e=q=!1),h=h.data("cid"),c.undoManager.push(d.dataset.cid,null,null,"row_sort",{bnext:e,before:x,anext:q,after:h});else{if(n.contains("predesigned_row")||n.contains("tb_page_break_module")||"row"===d.dataset.type)"row"===d.dataset.type?c.toolbar.libraryItems.get(d.dataset.id,"row",function(a){if(!Array.isArray(a)){a=Array(a);
const b=c.GS.findUsedItems(a);!1!==b&&b.length&&(a[0].used_gs=b)}b.rowDrop(a,p)}):n.contains("tb_page_break_module")?(b.rowDrop(c.toolbar.pageBreakModule.get(),p),c.toolbar.pageBreakModule.countModules()):c.toolbar.preDesignedRows.get(d.dataset.slug,function(a){b.rowDrop(a,p)})}else e=g.closest(".module_row"),"module"===t&&((g=g.closest(".tb_row_empty"))&&g.classList.remove("tb_row_empty"),e.classList.remove("tb_row_empty"),x&&(h&&h.classList.toggle("tb_row_empty",!h.querySelector(".active_module")),
q&&q.classList.toggle("tb_row_empty",!q.querySelector(".active_module")))),x?c.undoManager.push(a.dataset.cid,x,e,"sort",{before:x.dataset.cid,after:e.dataset.cid}):b.moduleDrop(k(a),!1,l.clone(e));u.body.triggerHandler("tb_"+t+"_sort",[a])}};B.className="tb_sortable_helper tf_box tf_overflow";x&&(x=l.clone(x)[0]);n.contains("active_subrow")&&(v+=" tb_drag_subrow");if(z){p=B.cloneNode();B.style.opacity=0;if("visual"!==c.mode){var H=d.getBoundingClientRect();p.style.width=H.width+"px";p.style.left=
H.left+"px"}m.body.appendChild(p);q=p.offsetHeight/2}else if("module"===t)if(n.contains("active_subrow"))B.innerHTML="Subrow";else{H=d.getAttribute("data-module-slug");if(!H){var P=c.Models.Registry.lookup(d.getAttribute("data-cid"));P&&"module"===P.get("elType")&&(H=P.get("mod_name"))}if(H&&themifyBuilder.modules[H]){P=themifyBuilder.modules[H].icon;const a=m.createElement("span");a.textContent=themifyBuilder.modules[H].name;a.className="tf_vmiddle";P&&B.appendChild(c.Utils.getIcon("ti-"+P));B.appendChild(a)}}else"column"===
t?(B.className+=" "+d.className,B.innerHTML='<div class="tb_row_grid_title"></div>'):"row"===t&&(n.contains("tb_page_break_module")||n.contains("predesigned_row"))&&(H=n.contains("tb_page_break_module")?"tb_page_break_title":"tb_predesigned_rows_title",B.textContent=d.getElementsByClassName(H)[0].textContent);if("visual"!==c.mode||f)w=m.createElement("div"),w.className="tb_sortable_placeholder tf_rel tf_w";m.body.appendChild(B);a.dataTransfer.setDragImage(B,B.offsetWidth/2+2,B.offsetHeight/2);d.addEventListener("dragend",
function(a){a.stopImmediatePropagation();u.body[0].removeEventListener("dragover",G);D.removeEventListener("drop",R,{once:!0});D.removeEventListener("mousemove",J,{passive:!0});D.removeEventListener("mouseover",J,{passive:!0});D.removeEventListener("mouseout",J,{passive:!0});D.removeEventListener("mouseenter",J,{passive:!0});D.removeEventListener("mouseleave",J,{passive:!0});this.removeEventListener("drag",M,{once:!0,passive:!0});K||(a=D.querySelector("[data-pos]"))&&R(a);B.remove();z&&p.remove();
w&&w.remove();a=m.querySelectorAll("[data-pos]");for(let b=a.length-1;-1<b;--b)a[b].removeAttribute("data-pos");this.classList.remove("tb_draggable_item");A(!0);"visual"!==c.mode&&k(".is-drop-target").removeClass("is-drop-target");c.ActionBar.disable=w=K=e=d=n=y=B=p=q=Q=D=L=O=v=t=x=null;c.ActionBar.clear()},{once:!0,passive:!0});d.addEventListener("drag",M,{once:!0,passive:!0});D.addEventListener("drop",R,{once:!0});u.body[0].addEventListener("dragover",G);D.addEventListener("mousemove",J,{passive:!0});
D.addEventListener("mouseover",J,{passive:!0});D.addEventListener("mouseout",J,{passive:!0});D.addEventListener("mouseenter",J,{passive:!0});D.addEventListener("mouseleave",J,{passive:!0})})}},subRowDrop(a,b){c.ActionBar.clear();const d=0<b.parent(".themify_builder_content,#tb_row_wrapper").length;if(d||0===b.closest(".sub_column").length){a=c.Utils.grid(a);let e,f,h;d||(e=l.clone(b.closest(".module_row")),e.find(".tb_row_grid").remove(),f="row");a=(d?c.Views.init_row({cols:a[0].cols}):c.Views.init_subrow({cols:a[0].cols})).view.render().$el;
if(d||b[0].parentNode.classList.contains("tb_holder")||b[0].parentNode.parentNode.classList.contains("tb_holder"))b[0].parentNode.replaceChild(a[0],b[0]),a[0].className+=" tb_element_clicked",c.ActionBar.type="subrow";else{let c=b.next(".tb_holder");0<c.length?c.prepend(a):(c=b.prev(".tb_holder"),c.append(a))}d&&(e=a.next(".module_row"),h=!0,0===e.length&&(h=!1,e=a.prev(".module_row")),e=e.data("cid"),f="grid_sort");c.Utils.setCompactMode(a[0].getElementsByClassName("module_column"));c.Mixins.Builder.update(a);
b.remove();c.hasChanged=!0;b=a.closest(".module_row");d||b.removeClass("tb_row_empty");b.find(".tb_row_grid").remove();c.Utils.scrollToDropped(a[0]);c.undoManager.push(b.data("cid"),e,b,f,{next:h})}else b.remove()},rowDrop(a,b,d,e){c.ActionBar.clear();const f=m.createDocumentFragment(),h=[],g=[],n=function(a){for(let b in a)if(a[b].styling&&0<Object.keys(a[b].styling).length||a[b].modules&&0<Object.keys(a[b].modules).length)return!0;return!1},k=function(){var a=b.prev(".module_row");let d;0===a.length?
(d="visual"===c.mode?b.closest(".themify_builder_content").data("postid"):null,a=!1):a=a.data("cid");b[0].innerHTML="";c.ActionBar.type="row";b[0].parentNode.replaceChild(f,b[0]);c.hasChanged=!0;c.Instances.Builder[c.builderIndex].removeLayoutButton();c.undoManager.push("","","","predesign",{prev:a,rows:h,bid:d});for(let b=0,d=h.length;b<d;++b)a=h[b][0].getElementsByClassName("module_column"),0===b&&h[b][0].classList.add("tb_element_clicked"),c.Utils.setCompactMode(a),c.Mixins.Builder.update(h[b]);
c.Utils.scrollToDropped(h[0][0]);l.showLoader("hide");c.Utils.calculateHeight()};e||c.Utils.clearLastEmptyRow(a);for(let b=0,k=a.length;b<k;++b)if(!0===d||a[b].styling&&0<Object.keys(a[b].styling).length||a[b].cols&&n(a[b].cols))if(e=c.Views.init_row(a[b]),!1!==e){e=e.view.render();f.appendChild(e.el);if("visual"===c.mode){let a=e.el.querySelectorAll("[data-cid]");g[e.el.dataset.cid]=1;for(let b=a.length-1;-1<b;--b)g[a[b].dataset.cid]=1}h.push(e.$el)}"visual"===c.mode?c.bootstrap(g,k):k()},moduleDrop(a,
b,d){function e(e){function f(e){g||n.model.set({is_new:1},{silent:!0});e=!0===e?n.model.getPreviewSettings():n.model.get("mod_settings");let f=!1;b?b.hasClass("tb_module_front")?b.after(k.el):b.append(k.el):a.replaceWith(k.el);g?c.activeModel=n.model:n.model.trigger("edit",null);c.hasChanged=!0;if("visual"===c.mode&&"layout-part"!==n.model.get("mod_name")&&1<=Object.keys(e).length){var q=e.cid;"part"===h||"ajax"===a.data("type")?(f=!0,n.model.trigger("custom:preview:refresh",e)):"module"!==h?n.model.trigger("custom:preview:live",
e):c.Utils.loadContentJs(k.$el,"module")}g&&(f&&(e=n.view.$el.find(".tb_preview_component").detach(),n.view.el.prepend(e)),d&&(q=k.$el.closest(".module_row"),q.removeClass("tb_row_empty").find(".tb_module_dragging_helper").remove(),k.$el.closest(".active_subrow").removeClass("tb_row_empty"),e=d[0].getElementsByClassName("tb_library_item"),e[0]&&e[0].remove(),c.undoManager.push(q.data("cid"),d,q,"row"),q=q.data("cid"),c.Instances.Builder[c.builderIndex].removeLayoutButton(),c.activeModel=null),c.Utils.calculateHeight());
c.Utils.scrollToDropped(null,q)}const n=c.Views.init_module(e,!0),k=n.view.render();"visual"===c.mode&&g?(e=[],e[n.model.cid]=1,c.bootstrap(e,f)):f(!0);return k}c.ActionBar.clear();const f={mod_name:a.data("module-slug")},h=a.data("type"),g="part"===h||"module"===h;if(a[0].classList.contains("tb_row_grid"))this.subRowDrop(a.data("slug"),a);else{if(g)c.toolbar.libraryItems.get(a.data("id"),h,e);else return e(f);"visual"!==c.mode&&k(".themify-wp-editor-holder").addClass("themify-active-holder")}},toJSON(a){const b=
[];a=a.children;for(let d=0,e=a.length;d<e;++d)if(a[d].classList.contains("module_row")){let e=c.Utils._getRowSettings(a[d]);0<Object.keys(e).length&&b.push(e)}return b},columnHover(a){var b=a.closest(".sub_column"),d=c.Instances.Builder[c.builderIndex].el.getElementsByClassName("tb_hover_sub_column");for(var e=d.length-1;-1<e;--e)d[e].classList.remove("tb_hover_sub_column");d=c.Instances.Builder[c.builderIndex].el.getElementsByClassName("tb_action_overlap");for(e=d.length-1;-1<e;--e)d[e].classList.remove("tb_action_overlap");
if(null!==b){var f=b.parentNode.closest(".module_column");if(!f.classList.contains("tb_hover_sub_column")&&(f.classList.add("tb_hover_sub_column"),d=b.getElementsByClassName("tb_column_action")[0],void 0!==d)){e=d.getBoundingClientRect();var h=!0;f=5>e.left?f.closest(".module_row").getElementsByClassName("tb_row_action")[0]:b.closest(".module_subrow").getElementsByClassName("tb_subrow_action")[0];void 0!==f&&(h=f.getBoundingClientRect(),h=Math.abs(e.left-h.left)<e.width?Math.abs(h.top-e.top)>e.height:
!0);d.classList.toggle("tb_action_overlap",!1===h)}}!0!==this.isFullWidth&&(b=null!==b?b.parentNode.closest(".module_column"):a.closest(".module_column"),!1!==this.isFullWidth&&(a=null!==b?b.closest(".module_row"):a.closest(".module_row"),null!==a&&(a.offsetWidth<m.body.clientWidth?(this.isFullWidth=!0,m.body.classList.remove("tb_page_row_fullwidth")):(this.isFullWidth=!1,m.body.classList.add("tb_page_row_fullwidth")))),null!==b&&null!==b.parentNode.parentNode.closest(".fullwidth")&&(a=b.getElementsByClassName("tb_column_action")[0],
void 0!==a&&a.getBoundingClientRect().right>=m.body.clientWidth&&a.classList.add("tb_action_outside")))}};c.undoManager={stack:[],is_working:!1,index:-1,btnUndo:null,btnRedo:null,compactBtn:null,init(){this.btnUndo=c.toolbar.el.getElementsByClassName("tb_undo_btn")[0];this.btnRedo=c.toolbar.el.getElementsByClassName("tb_redo_btn")[0];this.compactBtn=c.toolbar.el.getElementsByClassName("tb_compact_undo")[0];c.toolbar.$el.find(".tb_undo_redo").on("click",this.do_change.bind(this));themifyBuilder.disableShortcuts||
(r.document.addEventListener("keydown",this.keypres.bind(this)),"visual"===c.mode&&m.addEventListener("keydown",this.keypres.bind(this)))},push(a,b,d,e,f){c.hasChanged&&(c.editing=!1,d&&d instanceof HTMLElement&&(d=l.clone(d)),"visual"!==c.mode||"duplicate"!==e&&"sort"!==e||u.trigger("tfsmartresize"),this.stack.splice(this.index+1,this.stack.length-this.index),this.stack.push({cid:a,type:e,data:f,before:b,after:d}),this.index=this.stack.length-1,this.updateUndoBtns(),"visual"===c.mode&&(c.Forms.LayoutPart.isSaved=
null,u.body.triggerHandler("builder_dom_changed",[e])))},set(a){let b=a[0].querySelectorAll("[data-cid]");b=Array.prototype.slice.call(b);b.unshift(a[0]);for(a=b.length-1;-1<a;--a){let d=c.Models.Registry.lookup(b[a].getAttribute("data-cid"));d&&d.trigger("change:view",b[a])}},doScroll(a){return a},keypres(a){if(!0===a.ctrlKey||!0===a.metaKey){const b=m.activeElement.tagName,c=r.document.activeElement.tagName,e=a.which;"INPUT"!==b&&"TEXTAREA"!==b&&"INPUT"!==c&&"TEXTAREA"!==c&&(89===e||90===e&&!0===
a.shiftKey?(a.preventDefault(),this.hasRedo()&&this.changes(!1)):90===e&&(a.preventDefault(),this.hasUndo()&&this.changes(!0)))}},changes(a){c.ActionBar.clearClicked();var b=a?0:1;if(null!==c.activeModel&&("visual"!==c.mode||!m.activeElement.contentEditable&&c.liveStylingInstance.$liveStyledElmt[0].contains(m.activeElement))){if(!0===c.hasChanged){ThemifyConstructor.saveComponent(!1);k(this.btnUndo).triggerHandler("click");return}l.Lightbox.close()}b=this.stack[this.index+b];if(void 0!==b){this.is_working=
!0;let p="",q=b.type;var d=k(".tb_element_cid_"+b.cid);let w=!1;c.eventName=q;if("row"===q)a?(p=l.clone(b.before),w=b.cid):(p=l.clone(b.after),w=b.before.data("cid"),d=k(".tb_element_cid_"+w)),this.doScroll(d),this.set(p),p.toggleClass("tb_row_empty",0===p.find(".active_module").length),d.replaceWith(p);else if("duplicate"===q)a?this.doScroll(k(".tb_element_cid_"+b.after.data("cid"))).remove():(this.doScroll(d),p=l.clone(b.after),w=b.before.data("cid"),this.set(p),d.after(p));else if("delete_row"===
q)a?(p=l.clone(b.before),w=b.cid,d=k(".tb_element_cid_"+b.data.pos_cid),this.doScroll(d),this.set(p),"after"===b.data.pos?d.after(p):d.before(p)):this.doScroll(d).remove();else if("sort"===q){w=b.cid;a?(d=b.data.before,p=l.clone(b.before)):(d=b.data.after,p=l.clone(b.after));this.doScroll(p);this.set(p);var e=k(".tb_element_cid_"+w).closest(".module_row");k(".tb_element_cid_"+w).remove();e.toggleClass("tb_row_empty",0===e.find(".active_module").length);k(".tb_element_cid_"+d).replaceWith(p);d=p.closest(".module_row");
d.toggleClass("tb_row_empty",0===d.find(".active_module").length)}else if("row_sort"===q){w=b.cid;d=b.data[a?"bnext":"anext"];e=k(".tb_element_cid_"+b.data[a?"before":"after"]);var f=k(".tb_element_cid_"+w);p=l.clone(f);f.remove();this.set(p);d?e.before(p):e.after(p);this.doScroll(p)}else if("save"===q){w=b.cid;e=c.Models.Registry.lookup(w);var h="module"===e.get("elType");f=h?"mod_settings":"styling";if(h&&b.data.column)a?(e=k(".tb_element_cid_"+w).closest(".module_row"),w=!1,this.doScroll(d).remove()):
(w=b.data.column.data("cid"),p=l.clone(b.data.column),d=k(".tb_element_cid_"+w),this.doScroll(d),this.set(p),d.replaceWith(p),e=p.closest(".module_row")),e.toggleClass("tb_row_empty",0===e.find(".active_module").length),e=null;else{this.doScroll(d);h={};a?(p=l.clone(b.before),h[f]=b.data.bsettings):(p=l.clone(b.after),h[f]=b.data.asettings);if("visual"===c.mode){const d=k.extend(!0,{},b.data.styles);for(var g in d){var n=ThemifyStyles.getSheet(g);n=n.cssRules?n.cssRules:n.rules;for(let b in d[g])if(n[b])for(let c in d[g][b])n[b].style["backgroundClip"===
c||"background-clip"===c?"WebkitBackgroundClip":c]=a?d[g][b][c].b:d[g][b][c].a}g=c.activeModel;f=void 0!==h[f][c.GS.key]?h[f][c.GS.key].split(" "):[];c.activeModel=e;c.GS.liveInstance=null;c.GS.generateValues(null,f,!0);c.activeModel=g;c.GS.liveInstance=null}e.set(h,{silent:!0});this.set(p);d.replaceWith(p)}}else if("inline"===q)b.data.innerHTML=a?b.before:b.after,u.triggerEvent(b.data,"change");else if("predesign"===q)if(d=b.data.rows,a){this.doScroll(k(".tb_element_cid_"+d[0].data("cid")));for(let a=
0,b=d.length;a<b;++a)k(".tb_element_cid_"+d[a].data("cid")).remove()}else{d=m.createDocumentFragment();e=[];for(let a=0,b=e.length;a<b;++a)f=l.clone(e[a]),d.appendChild(f[0]),e.push(f);!1!==b.data.prev?this.doScroll(k(".tb_element_cid_"+b.data.prev)).after(d):this.doScroll("visual"===c.mode?k("#themify_builder_content-"+b.data.bid):k("#tb_row_wrapper")).prepend(d);for(let a=0,b=e.length;a<b;++a)this.set(e[a]),c.Mixins.Builder.update(e[a])}else if("import"===q){d=k('[data-postid="'+b.data.bid+'"]');
e=l.clone(a?b.data.before:b.data.after);const c=this;d.children().remove();d.prepend(e);e.each(function(){c.set(k(this))})}else"grid_sort"===q&&(a?k(".tb_element_cid_"+b.cid).remove():(d=k(".tb_element_cid_"+b.before),e=l.clone(b.after),w=b.cid,b.data.next?d.before(e):d.after(e),this.set(e)));w&&"inline"!==q&&(c.ActionBar.hoverCid=null,c.Mixins.Builder.update(k(p)));a?--this.index:++this.index;u.trigger("undo",[p,q,a,b]);this.is_working=!1;this.updateUndoBtns();"inline"!==q&&c.toolbar.pageBreakModule.countModules();
c.Utils.calculateHeight()}},hasRedo(){return this.index<this.stack.length-1},hasUndo(){return-1!==this.index},disable(){this.btnUndo.classList.add("tb_disabled");this.btnRedo.classList.add("tb_disabled");this.compactBtn.classList.add("tb_disabled")},updateUndoBtns(){const a=this.hasUndo(),b=this.hasRedo();this.btnUndo.classList.toggle("tb_disabled",!a);this.btnRedo.classList.toggle("tb_disabled",!b);this.compactBtn.classList.toggle("tb_disabled",!(a||b))},reset(){this.stack=[];this.index=-1;this.updateUndoBtns()},
do_change(a){a.preventDefault();a.stopPropagation();!1!==this.is_working||a.currentTarget.classList.contains("tb_disabled")||this.changes(a.currentTarget.classList.contains("tb_undo_btn"))}};c.Views.Toolbar=E.View.extend({events:{"click .tb_import":"import","click .tb_load_layout":"loadLayout","click .tb_save_layout":"saveLayout","click .tb_dup_link":"duplicate","click .tb_toolbar_save":"save","click .tb_toolbar_backend_edit a":"save","click .tb_toolbar_close_btn":"panelClose","click .tb_breakpoint_switcher":"breakpointSwitcher",
"click .tb_popular_devices li":"deviceSwitcher","change .tb_change_mode input":"modChange","click .tb_float_minimize":"minimize","click .tb_float_close":"closeFloat","click .tb_toolbar_add_modules":"openFloat","click .tb_custom_css":"addCustomCSS","click .tb_zoom":"zoom","click .tb_toolbar_zoom_menu_toggle":"zoom","click .tb_toolbar_builder_preview":"previewBuilder","click .js-tb_module_panel_acc":"toggleAccordion"},lightboxStorageKey:"tb_module_panel",render(){const a=this;var b={},d=1;for(var e in themifyBuilder.modules){var f=
m.createElement("div"),h=m.createElement("span");let a=m.createElement("span"),n=m.createElement("a"),k=themifyBuilder.modules[e].icon;f.className="tb_module tb-module-"+e;f.dataset.categories=themifyBuilder.modules[e].category;themifyBuilder.modules[e].favorite&&(f.className+=" favorited");h.className="tb_favorite tb_disable_sorting";a.className="module_name";a.textContent=themifyBuilder.modules[e].name;n.href="#";n.className="tf_plus_icon add_module_btn tb_disable_sorting";n.dataset.type="module";
n.title=themifyBuilder.i18n.add_module;f.dataset.moduleSlug=e;f.dataset.index=d++;f.draggable=!0;themifyBuilder.modules[e].type&&(f.dataset.type=themifyBuilder.modules[e].type);h.appendChild(c.Utils.getIcon("ti-star"));k&&f.appendChild(c.Utils.getIcon("ti-"+k));f.appendChild(h);f.appendChild(a);f.appendChild(n);h=themifyBuilder.modules[e].favorite?["favorite"]:themifyBuilder.modules[e].category;for(let a=0,c=h.length;a<c;++a)void 0===b[h[a]]&&(b[h[a]]=m.createDocumentFragment()),b[h[a]].appendChild(f.cloneNode(!0))}d=
this.el.getElementsByClassName("tb_module_category_content");for(e=d.length-1;-1<e;--e)if(f=d[e].getAttribute("data-category"))void 0!==b[f]?d[e].appendChild(b[f]):d[e].parentNode.style.display="none";"visual"===c.mode&&r.document.body.appendChild(this.el);b=function(){a.Panel.init();c.undoManager.init();a.preDesignedRows.init();a.libraryItems.init();a.common.init();a.darkMode();setTimeout(function(){a.setMode();a.help.init();setTimeout(function(){a.Revisions.init();if("visual"===c.mode){const b=
m.createElement("div");for(let a=6;1<a;--a){let c=m.createElement("div");c.className+="tb_row_grid tb_row_grid_"+a;c.innerHTML='<div class="tb_row_grid_title"></div>';b.appendChild(c)}b.className="tf_abs";b.style.visibility="hidden";m.body.appendChild(b);setTimeout(function(){b.remove()},500);a.$el.on("click",".tb_favorite",a.toggleFavoriteModule);a.unload()}u.body.on("click",".tb_favorite",a.toggleFavoriteModule)},2E3);c.Mixins.Builder.updateModuleSort(c.Instances.Builder[c.builderIndex].el);c.Mixins.Builder.updateModuleSort(a.el.getElementsByClassName("tb_module_panel_container")[0]);
u.LoadCss(themifyBuilder.meta_url+"css/themify.minicolors.css");u.LoadCss(themifyBuilder.builder_url+"/css/editor/themify.combobox.css");"visual"===c.mode&&(r.Themify.LoadCss(themifyBuilder.meta_url+"css/themify.minicolors.css"),r.Themify.LoadCss(themifyBuilder.builder_url+"/css/editor/themify.combobox.css"))},800);a.draggable();"true"===localStorage.getItem("tb_panel_closed")?a.closeFloat():a.Panel.setFocus()};if("visual"===c.mode)r.jQuery("body").one("themify_builder_ready",b);else b()},setMode(){localStorage.getItem("tb_mode")?
c.ActionBar.isHoverMode=null:(c.ActionBar.isHoverMode=!0,this.el.getElementsByClassName("tb_change_mode")[0].getElementsByClassName("tb-checkbox")[0].checked=!0);!0===c.ActionBar.isInit&&c.ActionBar.changeMode()},darkMode(){localStorage.getItem("tb_dark_mode")?(c.ActionBar.darkMode=!0,this.el.getElementsByClassName("tb_dark_mode")[0].checked=!0,c.ActionBar.changeDarkMode()):c.ActionBar.darkMode=null},modChange(a){a.stopPropagation();a.currentTarget.classList.contains("tb_mode")?(!0===a.currentTarget.checked?
(localStorage.removeItem("tb_mode"),c.ActionBar.isHoverMode=!0):(localStorage.setItem("tb_mode",1),c.ActionBar.isHoverMode=null),c.ActionBar.clear(),c.ActionBar.clearClicked(),c.ActionBar.clearSelected(),c.ActionBar.changeMode()):a.currentTarget.classList.contains("tb_right_click_mode")?(!0===a.currentTarget.checked?localStorage.removeItem("tb_right_click"):localStorage.setItem("tb_right_click",1),c.ActionBar.initRightClick()):a.currentTarget.classList.contains("tb_padding_dragging_mode")?(!0===a.currentTarget.checked?
localStorage.removeItem("tb_disable_padding_dragging"):localStorage.setItem("tb_disable_padding_dragging",1),c.EdgeDrag.init()):a.currentTarget.classList.contains("tb_dark_mode")&&(!0===a.currentTarget.checked?(localStorage.setItem("tb_dark_mode",1),c.ActionBar.darkMode=!0):(localStorage.removeItem("tb_dark_mode"),c.ActionBar.darkMode=null),c.ActionBar.changeDarkMode())},getStorage(){const a=localStorage.getItem(this.lightboxStorageKey);return a?JSON.parse(a):null},updateStorage(){const a=this.$el.find("#tb_module_panel"),
b=a.position();var c=a.outerHeight();0>=c&&(c=(c=this.getStorage())?c.height:"");localStorage.setItem(this.lightboxStorageKey,JSON.stringify({top:b.top,left:b.left,width:a.outerWidth(),height:c}))},getPanelClass(a){return 195>=a?"tb_float_xsmall":270>=a?"tb_float_small":400>=a?"tb_float_medium":"tb_float_large"},_setResponsiveTabs(a){const b=c.toolbar.el.getElementsByClassName("tb_module_types");for(let c=b.length-1;-1<c;--c)"tb_float_xsmall"===a?(b[c].classList.add("tb_ui_dropdown_items"),b[c].parentNode.classList.add("tb_compact_tabs")):
(b[c].classList.remove("tb_ui_dropdown_items"),b[c].parentNode.classList.remove("tb_compact_tabs"))},resize(){const a=this.el.getElementsByClassName("tb_modules_panel_wrap")[0],b=this,d=c.Utils.getMouseEvents(),e=a.getElementsByClassName("tb_resizable");for(let c=e.length-1;-1<c;--c)e[c].addEventListener(d.mousedown,function(c){if("touchstart"===c.type||1===c.which){c.stopImmediatePropagation();let e,f;const h=this.ownerDocument,q=.9*h.documentElement.clientHeight,w=parseInt(k(a).css("min-width")),
t=parseInt(k(a).css("max-width")),v=this.dataset.axis,l=parseInt(a.offsetHeight,10),m=parseInt(a.offsetWidth,10),r=c.touches?c.touches[0].clientX:c.clientX,u=c.touches?c.touches[0].clientY:c.clientY,y=function(c){c.stopImmediatePropagation();f&&cancelAnimationFrame(f);f=requestAnimationFrame(function(){var d=c.touches?c.touches[0].clientX:c.clientX;var f=c.touches?c.touches[0].clientY:c.clientY;if("w"===v)d=r+m-d,d>t&&(d=t),d>=w&&d<=t&&(f=a.style.width,a.style.width=d+"px",a.style.left=parseInt(a.style.left)+
parseInt(f)-d+"px");else{f="-y"===v||"ne"===v||"nw"===v?u+l-f:l+f-u;d="sw"===v||"nw"===v?r+m-d:m+d-r;d>t&&(d=t);if(("se"===v||"x"===v||"sw"===v||"nw"===v||"ne"===v)&&d>=w&&d<=t){const b=a.style.width;a.style.width=d+"px";if("sw"===v||"nw"===v)a.style.left=parseInt(a.style.left)+parseInt(b)-d+"px"}if(("se"===v||"y"===v||"-y"===v||"sw"===v||"nw"===v||"ne"===v)&&50<=f&&f<=q){if("-y"===v||"nw"===v||"ne"===v)a.style.top=parseInt(a.style.top)+parseInt(a.style.height)-f+"px";a.style.height=f+"px"}}"y"!==
v&&"-y"!==v&&(d=b.getPanelClass(d),e!==d&&(e&&a.classList.remove(e),a.classList.add(d),e=d,b._setResponsiveTabs(d)))})};h.addEventListener(d.mousemove,y,{passive:!0});h.addEventListener(d.mouseup,function(){c.stopImmediatePropagation();this.removeEventListener(d.mousemove,y,{passive:!0});f&&cancelAnimationFrame(f);f=null;this.body.style.cursor="";this.body.classList.remove("tb_start_animate","tb_move_drag","tb_panel_resize");b.updateStorage()},{passive:!0,once:!0});h.body.classList.add("tb_start_animate",
"tb_move_drag","tb_panel_resize");h.body.style.cursor=k(this).css("cursor")}},{passive:!0})},setFloat(){const a=this.Panel.el.find("#tb_module_panel")[0];var b=this.getStorage();a.classList.add("tb_panel_floating");b&&(a.style.width=b.width+"px",a.style.height=b.height+"px");b=this.getPanelClass(a.offsetWidth);a.classList.add(b);this._setResponsiveTabs(b)},removeFloat(){this.Panel.el.find("#tb_module_panel").css({top:"",width:"",height:"",left:"",right:"",bottom:""}).removeClass("tb_panel_floating tb_float_xsmall tb_float_small tb_float_medium tb_float_large tb_is_minimize")},
draggable(){const a=this.el.querySelector("#tb_module_panel"),b=c.Utils.getMouseEvents(),d=this;if(!l.Lightbox.dockMode.get()){var e=this.getStorage();if(e){for(let b in e)a.style[b]=e[b]+"px";e=e.width}else e=a.offsetWidth;e=this.getPanelClass(e);a.classList.add("tb_panel_floating",e);this._setResponsiveTabs(e)}a.getElementsByClassName("tb_drag_handle")[0].addEventListener(b.mousedown,function(e){if("touchstart"===e.type||1===e.which){e.stopImmediatePropagation();let f;const g=this.ownerDocument,
n=a.offsetLeft-(e.touches?e.touches[0].clientX:e.clientX),p=a.offsetTop-(e.touches?e.touches[0].clientY:e.clientY),q=function(b){b.stopImmediatePropagation();f&&cancelAnimationFrame(f);f=requestAnimationFrame(function(){const d=n+(b.touches?b.touches[0].clientX:b.clientX),e=p+(b.touches?b.touches[0].clientY:b.clientY);a.style.left=d+"px";a.style.top=e+"px";"visual"===c.mode&&l.Lightbox.dockMode.drag(b,d)})},w=function(a){g.body.classList.add("tb_start_animate","tb_move_drag","tb_panel_drag");d.setFloat();
l.Lightbox.dockMode.get()&&(l.Lightbox.dockMode.close(),setTimeout(function(){c.Utils._onResize(!0)},100))};g.addEventListener(b.mouseup,function(c){c.stopImmediatePropagation();this.removeEventListener(b.mousemove,w,{passive:!0,once:!0});this.removeEventListener(b.mousemove,q,{passive:!0});q(c);requestAnimationFrame(function(){g.body.classList.remove("tb_start_animate","tb_move_drag","tb_panel_drag");if(l.Lightbox.dockMode.get())d.removeFloat(),d._setResponsiveTabs(!1);else{const b=k(r).height()-
30,c=a.offsetTop;if(0>c||c>b)a.style.top=(0>c?0:b)+"px";d.updateStorage()}f=null})},{passive:!0,once:!0});g.addEventListener(b.mousemove,w,{passive:!0,once:!0});g.addEventListener(b.mousemove,q,{passive:!0})}},{passive:!0});this.resize()},minimize(a){a.preventDefault();a.stopPropagation();a=k(a.currentTarget).closest("#tb_module_panel");if(a.hasClass("tb_is_minimize")){a.removeClass("tb_is_minimize");const b=this.getStorage();a.css("height",b?b.height:"")}else a.addClass("tb_is_minimize")},import(a){a.preventDefault();
a.stopPropagation();var b=a.currentTarget.getAttribute("data-component");const d=r.document.getElementsByTagName("body")[0];var e={contructor:"file"!==b,dataType:"json",data:{action:"builder_import",type:b}};if("file"!==b||confirm(themifyBuilder.i18n.importFileConfirm))if("file"===b)a=r.document.getElementById("tb_import_filestb_plupload_browse_button"),null===a?(a=m.createElement("input"),b=m.createElement("div"),e=m.createElement("span"),b.id="tb_import_filestb_plupload_upload_ui",b.style.display=
"none",a.type="button",a.id="tb_import_filestb_plupload_browse_button",e.className="ajaxnonceplu",e.id=themifyBuilder.import_nonce,b.appendChild(a),b.appendChild(e),d.appendChild(b),c.Utils.builderPlupload("",a.parentNode)):a.click();else{l.Lightbox.$lightbox[0].style.display="none";const b=k(a.currentTarget.closest("ul")),h=b.offset();let g=h.top+b.height()-40;u.body.off("themify_builder_lightbox_close.import");b.addClass("tb_current_menu_selected");null!==c.Forms.LayoutPart.id&&(g-=z.pageYOffset+
60);l.Lightbox.open(e,function(){d.classList.add("tb_standalone_lightbox")},function(){this.$lightbox[0].classList.add("tb_import_post_lightbox");this.setStandAlone(h.left,g,!0);u.body.one("themify_builder_lightbox_close.import",function(){d.classList.remove("tb_standalone_lightbox");l.Lightbox.$lightbox[0].classList.remove("tb_import_post_lightbox");b.removeClass("tb_current_menu_selected")});k("#tb_submit_import_form",l.Lightbox.$lightbox).one("click",function(a){a.preventDefault();l.LiteLightbox.confirm(themifyBuilder.i18n.dialog_import_page_post,
function(a){k.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"builder_import_submit",nonce:themifyBuilder.tb_load_nonce,data:c.Forms.serialize("tb_options_import"),importType:"no"===a?"replace":"append",importTo:themifyBuilder.post_ID},beforeSend(a){l.showLoader("show")},success(a){void 0!==a.builder_data?c.Forms.reLoad(a,themifyBuilder.post_ID):l.showLoader("error");l.Lightbox.close()}})},{buttons:{no:{label:ThemifyConstructor.label.replace_builder},yes:{label:ThemifyConstructor.label.append_builder}}})})})}},
unload(){"visual"===c.mode&&m.head.insertAdjacentHTML("afterbegin",'<base target="_parent">');r.onbeforeunload=function(){return c.editing||!c.hasChanged&&!c.undoManager.hasUndo()?null:"Are you sure"}},panelClose(a){a.preventDefault();r.location.reload(!0)},loadLayout(a){a.preventDefault();a.stopPropagation();var b=this,d=r.document.body,e=k(a.currentTarget.closest("ul"));a=b.layoutsList?{loadMethod:"html",data:b.layoutsList}:{data:{action:"tb_load_layout"}};l.Lightbox.$lightbox[0].style.display=
"none";e.addClass("tb_current_menu_selected");u.body.off("themify_builder_lightbox_close.loadLayout");l.Lightbox.open(a,function(){d.classList.add("tb_load_layout_active","tb_standalone_lightbox")},function(){function a(){g.on("click.loadLayout",".layout_preview img",function(a){a.preventDefault();a.stopPropagation();const d=k(this).closest(".layout_preview");l.LiteLightbox.confirm(themifyBuilder.i18n.confirm_template_selected,function(a){const e=d.closest("ul").data("group"),f=function(d){if("no"!==
a){var e="visual"!==c.mode?m.getElementById("tb_row_wrapper"):m.getElementsByClassName("themify_builder_content-"+themifyBuilder.post_ID)[0];e=c.Mixins.Builder.toJSON(e);const a=[];for(let b in e)a.push(e[b]);for(let b in d)a.push(d[b]);d=a}!0!==b.is_set&&k.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:{action:"set_layout_action",nonce:themifyBuilder.tb_load_nonce,mode:"no"!==a?1:0,id:themifyBuilder.post_ID},success(){b.is_set=!0}});c.Forms.reLoad(d,themifyBuilder.post_ID);l.Lightbox.close()};
if("pre-designed"===e){l.showLoader("show");const a=d.data("slug"),b=themifyBuilder.paths.layout_template.replace("{SLUG}",a);if(!c.layouts_selected)c.layouts_selected={};else if(c.layouts_selected[a]){c.Utils.clearElementId(c.layouts_selected[a]);f(JSON.parse(c.layouts_selected[a]));return}k.get(b,null,null,"text").done(function(b){c.layouts_selected[a]=b;let d=JSON.parse(b);-1!==b.indexOf(c.GS.key)?k.getJSON(themifyBuilder.paths.layout_template.replace("{SLUG}",a+"-gs")).done(function(a){const b=
{};for(let c in a)void 0!==a[c]["class"]?b[a[c]["class"]]=a[c]:b[c]=a[c];c.GS.setImport(b,function(){f(d)},d)}).fail(function(a,b,c){f(d)}):f(d)}).fail(function(a,c,d){l.LiteLightbox.alert(ThemifyConstructor.label.layout_error.replace("{FILE}",b))}).always(function(){l.showLoader()})}else k.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_set_layout",nonce:themifyBuilder.tb_load_nonce,layout_slug:d.data("slug"),layout_group:e,mode:"no"!==a?1:0},beforeSend(){"visual"===
c.mode&&l.showLoader("show")},success(a){a.data?(a.gs&&(c.GS.styles=k.extend(!0,{},a.gs,c.GS.styles)),f(a.data),l.showLoader()):(l.showLoader("error"),alert(a.msg),l.Lightbox.close())}})},{buttons:{no:{label:ThemifyConstructor.label.layout_replace},yes:{label:ThemifyConstructor.label.layout_append}}})})}function h(){a();const b=n.find(".layout_preview_list");p.show().find("li").on("click",function(a){a.preventDefault();a.stopPropagation();this.classList.contains("current")||(a=b,this.classList.contains("all")||
(b.hide(),a=b.filter("[data-category"+(""!==themifyBuilder.paths.layouts_index?"*":"")+'="'+k(this).text()+'"]')),a.show(),k(this).addClass("current").siblings().removeClass("current"),p.parent().find(".tb_ui_dropdown_label").html(k(this).text()));c.Utils.hideOnClick(p)});p.find(".tb_selected_cat").click();g.find("#tb_layout_search").on("keyup",function(){let a=k.trim(k(this).val());var c=b;""!==a&&(c=p.find("li.all"),c[0].classList.contains("current")||c.click(),b.hide(),c=b.find(".layout_title:contains("+
a+")").closest(".layout_preview_list"));c.show()})[0].focus();u.body.one("themify_builder_lightbox_close.loadLayout",function(){g.off("click.loadLayout")[0].classList.remove("tb_predesigned_lightbox");n.find("#tb_layout_search").off("keyup");d.classList.remove("tb_load_layout_active","tb_standalone_lightbox");e.removeClass("tb_current_menu_selected")})}const g=this.$lightbox,n=g.find("#tb_tabs_pre-designed");if(0===n.length)d.classList.remove("tb_load_layout_active","tb_standalone_lightbox"),e.removeClass("tb_current_menu_selected"),
a();else{g[0].classList.add("tb_predesigned_lightbox");this.setStandAlone(r.innerWidth/2,(r.document.documentElement.clientHeight-g.height())/2,!0);var p=n.find(".tb_ui_dropdown_items");b.layoutsList?h():k.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_load_predesigned_layouts",nonce:themifyBuilder.tb_load_nonce,src:themifyBuilder.paths.layouts_index,id:themifyBuilder.post_ID},success(a){const d=JSON.parse(a.data);if(""===themifyBuilder.paths.layouts_index){var e=Object.keys(d);
c.layouts_selected={};for(var f=e.length-1;-1<f;--f)c.layouts_selected[d[e[f]].slug]=d[e[f]].data}{a=a.selected;e={};f=m.createDocumentFragment();const t=m.createDocumentFragment();for(let b=0,g=d.length;b<g;++b){var k=m.createElement("li"),q=m.createElement("div");let g=m.createElement("div"),h=m.createElement("img"),n=m.createElement("div");var l=m.createElement("div");k.className="layout_preview_list";k.dataset.category=d[b].category;q.className="layout_preview";q.dataset.id=d[b].id;q.dataset.slug=
d[b].slug;g.className="thumbnail";h.src=d[b].thumbnail;h.alt=d[b].title;h.title=d[b].title;n.className="layout_action";l.className="layout_title";l.textContent=d[b].title;n.appendChild(l);void 0!==d[b].url&&(l=m.createElement("a"),l.className="layout-preview-link",l.href=d[b].url,l.target="_blank",l.title=themifyBuilder.i18n.preview,l.appendChild(c.Utils.getIcon("ti-search")),n.appendChild(l));g.appendChild(h);q.appendChild(g);q.appendChild(n);k.appendChild(q);f.appendChild(k);if(d[b].category){k=
String(d[b].category).split(",");for(let b=0,c=k.length;b<c;++b)""!==k[b]&&1!==e[k[b]]&&(q=m.createElement("li"),q.textContent=k[b],t.appendChild(q),e[k[b]]=1,k[b]===a&&(q.className="tb_selected_cat"))}}p[0].appendChild(t);n[0].getElementsByClassName("tb_layout_lists")[0].appendChild(f);b.layoutsList=g[0].getElementsByClassName("tb_options_tab_wrapper")[0].cloneNode(!0);h()}},error(){l.LiteLightbox.alert(k("#tb_load_layout_error",n).show().text())}})}})},saveLayout(a){a.preventDefault();a.stopPropagation();
const b={contructor:!0,loadMethod:"html",save:{},data:{save_as_layout:{options:[{id:"layout_title_field",type:"text",label:ThemifyConstructor.label.title},{id:"layout_img_field",type:"image",label:ThemifyConstructor.label.image_preview},{id:"layout_img_field_id",type:"hidden"},{id:"postid",type:"hidden",value:themifyBuilder.post_ID}]}}},d=k(a.currentTarget.closest("ul"));d.addClass("tb_current_menu_selected");l.Lightbox.$lightbox[0].style.display="none";l.Lightbox.open(b,function(){r.document.body.classList.add("tb_standalone_lightbox")},
function(){const b=this.$lightbox;b.find(".builder_save_button").one("click",function(a){a.stopPropagation();a.preventDefault();k.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_save_custom_layout",nonce:themifyBuilder.tb_load_nonce,form_data:c.Forms.serialize(b[0])},beforeSend(){l.showLoader("show")},success(a){"success"===a.status?(l.showLoader(),l.Lightbox.close()):(l.showLoader("error"),alert(a.msg))}})});b.addClass("tb_savead_lightbox");this.setStandAlone(a.clientX,
a.clientY);u.body.one("themify_builder_lightbox_close",function(){b.removeClass("tb_savead_lightbox").find(".builder_save_button").off("click");r.document.body.classList.remove("tb_standalone_lightbox");d.removeClass("tb_current_menu_selected")})})},duplicate(a){a.preventDefault();a.stopPropagation();if(confirm(themifyBuilder.i18n.confirm_on_duplicate_page)){const a=this;c.Utils.saveBuilder(function(){a.Revisions.ajax({action:"tb_duplicate_page",tb_is_admin:"visual"!==c.mode},function(a){a&&(r.location.href=
k("<div/>").html(a).text())})})}},addCustomCSS(a){a.preventDefault();a.stopPropagation();null!==c.activeModel&&ThemifyConstructor.saveComponent(!0);null===A&&(A=themifyBuilder.custom_css,delete themifyBuilder.custom_css);A||(A="");const b={contructor:!0,loadMethod:"html",save:{},data:{css:{options:[{id:"custom_css",type:"textarea",rows:17,class:"fullwidth"},{id:"custom_css_m",type:"message",label:"",comment:ThemifyConstructor.label.cus_css_m},{id:"postid",type:"hidden",value:themifyBuilder.post_ID}]}}},
d=a.currentTarget;d.classList.add("tb_tooltip_active");l.Lightbox.$lightbox[0].style.display="none";r.document.body.classList.add("tb_standalone_lightbox");l.Lightbox.open(b,null,function(){const b=this.$lightbox,f=b[0].querySelector("#custom_css");f.value=A;"visual"===c.mode&&f.addEventListener("input",function(){let a=m.getElementById("tb_custom_css_tmp");null===a&&(a=m.createElement("style"),a.type="text/css",a.id="tb_custom_css_tmp",m.head.appendChild(a));a.innerHTML=this.value.trim()});b.addClass("tb_custom_css_lightbox").find(".builder_save_button").one("click",
function(a){a.stopImmediatePropagation();a.preventDefault();A=f.value.trim();l.Lightbox.close()});this.setStandAlone(a.clientX,a.clientY);u.body.one("themify_builder_lightbox_close",function(){A||(A="",d.classList.add("tb_tooltip_active"));const a=m.getElementById("tb_custom_css_tmp");a&&(a.innerHTML=A);r.document.body.classList.remove("tb_standalone_lightbox")})})},Revisions:{init(){c.toolbar.$el.find(".tb_toolbar_revision_btn").on("click",this.revision.bind(this))},revision(a){const b=a.target.classList;
if(b.contains("tb_toolbar_revision_btn"))null!==c.activeModel&&l.Lightbox.$lightbox.is(":visible")&&ThemifyConstructor.saveComponent();else if(b.contains("tb_save_revision")||b.contains("tb_load_revision"))a.preventDefault(),a.stopPropagation(),b.contains("tb_save_revision")?this.saveEvent():this.load(a)},load(a){const b=this,c=k("body",r.document),e=k(a.target.closest("ul")),f=e.offset();e.addClass("tb_current_menu_selected");l.Lightbox.$lightbox[0].style.display="none";u.body.off("themify_builder_lightbox_close.revisions");
b.ajax({action:"tb_load_revision_lists"},function(a){l.Lightbox.open({contructor:!0,loadMethod:"html",data:{revision:{html:k(a)[0]}}},function(){c.addClass("tb_standalone_lightbox")},function(){this.$lightbox[0].classList.add("tb_revision_lightbox");this.setStandAlone(f.left,f.top,!0);c.on("click.revision",".js-builder-restore-revision-btn",b.restore.bind(b)).on("click.revision",".js-builder-delete-revision-btn",b.delete.bind(b));u.body.one("themify_builder_lightbox_close.revisions",function(){e.removeClass("tb_current_menu_selected");
c.off(".revision").removeClass("tb_standalone_lightbox");l.Lightbox.$lightbox[0].classList.remove("tb_revision_lightbox")})})})},ajax(a,b){a=k.extend({},a,{tb_load_nonce:themifyBuilder.tb_load_nonce,postid:themifyBuilder.post_ID,sourceEditor:"visual"===c.mode?"frontend":"backend"});return k.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:a,beforeSend(){l.showLoader("show")},complete(){l.showLoader("hide")},success(a){"function"===typeof b&&b.call(this,a)}})},saveEvent(a){const b=this;l.LiteLightbox.prompt(themifyBuilder.i18n.enterRevComment,
function(c){null!==c&&b.saveRevision(c,a)})},saveRevision(a,b){const d=c.Utils.saveBuilder(null,!0);this.ajax({action:"tb_save_revision",rev_comment:a,data:JSON.stringify(c.Utils.clear(d.data)),postid:d.id},b)},restore(a){a.preventDefault();a.stopPropagation();const b=k(a.currentTarget).data("rev-id"),d=this,e=function(){d.ajax({action:"tb_restore_revision_page",revid:b},function(a){a.builder_data?(c.Forms.reLoad(a,themifyBuilder.post_ID),l.Lightbox.close()):(l.showLoader("error"),alert(a.data))})};
l.LiteLightbox.confirm(themifyBuilder.i18n.confirmRestoreRev,function(a){"yes"===a?d.saveEvent(e):e()},{buttons:{no:{label:ThemifyConstructor.label.save_no},yes:{label:ThemifyConstructor.label.save}}})},delete(a){a.preventDefault();a.stopPropagation();if(confirm(themifyBuilder.i18n.confirmDeleteRev)){var b=k(a.currentTarget);a=b.data("rev-id");this.ajax({action:"tb_delete_revision",revid:a},function(a){a.success?b.closest("li").remove():(l.showLoader("error"),alert(a.data))})}}},save(a){a.preventDefault();
a.stopPropagation();const b=a.currentTarget.closest(".tb_toolbar_backend_edit")?a.currentTarget.getAttribute("href"):!1;themifyBuilder.is_gutenberg_editor&&!1!==b?(c.undoManager.reset(),c._backendSwitchFrontend(b)):c.Utils.saveBuilder(function(a){!1!==b&&("visual"===c.mode?(c.editing=!0,sessionStorage.setItem("focusBackendEditor",!0),r.location.href=b):(c.undoManager.reset(),c._backendSwitchFrontend(b)))})},libraryItems:{items:[],is_init:null,init(){k(m).one("tb_panel_tab_tb_module_panel_library_wrap",
this.load.bind(this))},load(a,b){const d=this;b=k(b).find(".tb_module_panel_library_wrap");b.addClass("tb_busy");k.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:{action:"tb_get_library_items",nonce:themifyBuilder.tb_load_nonce,part:"all",pid:themifyBuilder.post_ID},success(a){d.setData(a);b.removeClass("tb_busy");d.is_init=!0},error(){b.removeClass("tb_busy");l.showLoader("error");d.init();c.toolbar.$el.find(".tb_library_item_list").html("<h3>Failed to load Library Items.</h3>")}})},get(a,b,d){if(void 0!==
this.items[a])d(this.items[a]);else{const e=this;k.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_get_library_item",nonce:themifyBuilder.tb_load_nonce,type:b,id:a},beforeSend(a){l.showLoader("show")},success(b){b.content.gs&&(c.GS.styles=k.extend(!0,{},b.content.gs,c.GS.styles),delete b.content.gs);l.showLoader("hide");"success"===b.status?(e.items[a]=b.content,d(b.content)):l.showLoader("error")},error(){l.showLoader("error")}})}},template(a){let b="";for(let c=0,e=
a.length;c<e;++c){let d="part";-1!==a[c].post_type.indexOf("_rows",5)?d="row":-1!==a[c].post_type.indexOf("_module",5)&&(d="module");b+='<div class="tb_library_item tb_item_'+d+'" draggable="true" data-type="'+d+'" data-id="'+a[c].id+'">';b+='<div class="tb_library_item_inner"><span>'+a[c].post_title+"</span>";b+='<a href="#" class="remove_item_btn tb_disable_sorting tf_close" title="Delete"></a></div></div>'}return b},setData(a){a='<span class="tb_no_content" style="display:none">No library content found.</span>'+
this.template(a);let b=k(".tb_library_item_list");"visual"===c.mode&&(b=b.add(c.toolbar.$el.find(".tb_library_item_list")));b=b.get();for(let c=b.length-1;-1<c;--c)b[c].insertAdjacentHTML("afterbegin",a),b[c].previousElementSibling.getElementsByClassName("current")[0].click();u.body.on("click",".remove_item_btn",this.delete.bind(this));if("visual"===c.mode)c.toolbar.$el.on("click",".remove_item_btn",this.delete.bind(this))},delete(a){a.preventDefault();a.stopPropagation();let b=k(a.currentTarget).closest(".tb_library_item"),
d=b.data("type");if(confirm(themifyBuilder.i18n[d+"LibraryDeleteConfirm"])){const a=b.data("id");k.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:{action:"tb_remove_library_item",nonce:themifyBuilder.tb_load_nonce,id:a},beforeSend(a){l.showLoader("show")},success(e){l.showLoader("hide");if(e){var f=0<b.closest("#"+c.toolbar.common.btn.prop("id")).length?c.toolbar.$el.find(".tb_item_"+d+'[data-id="'+a+'"]'):c.toolbar.common.btn.find(".tb_item_"+d+'[data-id="'+a+'"]');b=b.add(f);if("part"===d){b=
b.add(k(".themify_builder_content-"+a).closest(".active_module"));f=ThemifyConstructor.layoutPart.data;for(let a=f.length-1;-1<a;--a)if(f[a].post_name===e){ThemifyConstructor.layoutPart.data.splice(a,1);break}}e=b.parent().siblings(".tb_library_types").find(".current");b.remove();e.trigger("click")}else l.showLoader("error")},error(){l.showLoader("error")}})}}},preDesignedRows:{is_init:null,rows:{},items:{},currentCategory:"All",categories:{All:{isLoaded:!1}},loadingItems:!1,init(){setTimeout(function(){var a=
r.document.createElement("meta");const b=r.document.head,c=[{href:"//themify.me",rel:"dns-prefetch preconnect"},{href:"//fonts.googleapis.com",rel:"dns-prefetch preconnect"},{href:"//maps.googleapis.com",rel:"dns-prefetch preconnect"},{href:themifyBuilder.paths.rows_index,rel:"prefetch",as:"fetch"},{href:themifyBuilder.paths.layouts_index,rel:"prefetch",as:"fetch"}];a.content="on";a.setAttribute("http-equiv","x-dns-prefetch-control");b.appendChild(a);for(let d in c)a=r.document.createElement("link"),
a.setAttribute("crossorigin",!0),a.rel=c[d].rel,a.href=c[d].href,c[d].as&&a.setAttribute("as",c[d].as),b.appendChild(a)},7E3);k(m).one("tb_panel_tab_tb_module_panel_rows_wrap",this.load.bind(this))},load(a,b){const d=this;b=k(b).find(".tb_predesigned_rows_list");b.addClass("tb_busy");k.getJSON(themifyBuilder.paths.rows_index).done(function(a){d.setData(a,b)}).fail(function(a,f,h){d.setData({},b);d.is_init=null;l.showLoader("error");c.toolbar.$el.find(".tb_predesigned_rows_container").append("<h3>"+
ThemifyConstructor.label.rows_fetch_error+"</h3>");k(m).one("tb_panel_tab_tb_module_panel_rows_wrap",d.load.bind(d))})},masonry(a){const b=a.querySelectorAll('.predesigned_row:not([data-masonry="done"])');for(let d=0,h=b.length;d<h;d++)a:{var c=b[d],e=parseInt(z.top.getComputedStyle(a).getPropertyValue("grid-row-gap"));const f=parseInt(z.top.getComputedStyle(a).getPropertyValue("grid-auto-rows"));if(isNaN(e)||isNaN(f))break a;const h=c.getElementsByClassName("tb_predesigned_rows_image")[0].getBoundingClientRect().height+
c.getElementsByClassName("tb_predesigned_rows_title")[0].getBoundingClientRect().height;e=Math.ceil((h+e)/(f+e));c.style.gridRowEnd="span "+e;5<e&&(c.dataset.masonry="done")}},loadItems(a){this.loadingItems=!0;const b=this.currentCategory,c=m.createDocumentFragment();if(!0===this.categories.All.isLoaded||!0===this.categories[b].isLoaded)return this.loadingItems=!1,c;let e=0,f=Object.keys(this.items),h=f.length;for(let d=0;d<h&&!(10<=e&&void 0==a);d++){let h=this.items[f[d]];var g=""!==a?new RegExp(a,
"i"):!1;if(!g||!g.test(h.title))continue;var n=h.category.split(",");if("All"!==b&&-1===n.indexOf(b))continue;delete this.items[f[d]];g="";for(let a=0,b=n.length;a<b;++a)g+=this.categories[n[a]].hash;n=m.createElement("div");let k=m.createElement("figure"),p=m.createElement("div"),l=new Image,x=m.createElement("a");n.className="predesigned_row "+g;n.draggable=!0;n.setAttribute("data-slug",h.slug);k.className="tb_predesigned_rows_image";p.className="tb_predesigned_rows_title";p.textContent=l.alt=l.title=
h.title;l.src=void 0===h.thumbnail||""===h.thumbnail?"https://placeholdit.imgix.net/~text?txtsize=24&txt="+encodeURI(h.title)+"&w=181&h=77":h.thumbnail;l.width=500;l.height=300;x.href="#";x.className="tf_plus_icon add_module_btn tb_disable_sorting";x.dataset.type="predesigned";k.appendChild(l);k.appendChild(x);n.appendChild(k);n.appendChild(p);c.appendChild(n);++e}this.categories[b].isLoaded=10>e&&void 0===a;return c},setData(a){this.items=a;var b=[];a=m.createDocumentFragment();const d=this;for(let a=
0,c=this.items.length;a<c;++a){var e=this.items[a].category.split(",");for(let a=0,c=e.length;a<c;++a){var f=u.hash(e[a]);-1===b.indexOf(e[a])&&(b.push(e[a]),this.categories[e[a]]={hash:"tb"+f})}}b.sort();for(let c=0,d=b.length;c<d;++c)e=m.createElement("li"),e.setAttribute("data-slug",u.hash(b[c])),e.textContent=b[c],a.appendChild(e);b=k(".tb_module_panel_container .tb_ui_dropdown .tb_ui_dropdown_items");e=k(".tb_predesigned_rows_container");"visual"===c.mode&&(e=e.add(c.toolbar.$el.find(".tb_predesigned_rows_container")),
b=b.add(c.toolbar.$el.find(".tb_module_panel_container .tb_ui_dropdown .tb_ui_dropdown_items")));b=b.get();e=e.get();f=this.loadItems();for(let c=b.length-1;-1<c;--c){b[c].appendChild(a.cloneNode(!0));e[c].appendChild(f.cloneNode(!0));let g=e[c].getElementsByTagName("img");0<g.length?(g=g[g.length-1],k(g).one("load",function(){d.initCallback(k(this).closest(".tb_predesigned_rows_container")[0],!0)})):d.initCallback(e[c],!0)}u.body.on("click",".tb_module_panel_container .tb_ui_dropdown_items li",this.filter.bind(this));
if("visual"===c.mode)k("body",r.document).on("click",".tb_module_panel_container .tb_ui_dropdown_items li",this.filter.bind(this))},initCallback:function(a,b){b&&(a.closest(".tb_module_panel_rows_wrap").addEventListener("scroll",this.scrollLoadMore.bind(this),{passive:!0}),this.is_init=!0);const c=k(a);b&&c.closest(".tb_predesigned_rows_list").removeClass("tb_busy").closest(".tb_module_panel_tab").find(".tb_ui_dropdown").css("visibility","visible");c.parents("#tb_module_panel_dropdown").length&&this.masonry(a);
this.loadingItems=!1},get(a,b){l.showLoader("show");if(void 0!==this.rows[a])"function"===typeof b&&b(this.rows[a]);else{var d=this;k.getJSON(themifyBuilder.paths.row_template.replace("{SLUG}",a)).done(function(e){c.Utils.clearElementId(e);d.rows[a]=e;-1!==JSON.stringify(e).indexOf(c.GS.key)?k.getJSON(themifyBuilder.paths.row_template.replace("{SLUG}",a+"-gs")).done(function(a){const d={};for(let b in a)void 0!==a[b]["class"]?d[a[b]["class"]]=a[b]:d[b]=a[b];c.GS.setImport(d,b,e)}).fail(function(a,
c,d){"function"===typeof b&&b(e)}):"function"===typeof b&&b(e)}).fail(function(a,b,c){l.showLoader("error");alert(ThemifyConstructor.label.row_fetch_error)})}},filter(a){a.preventDefault();a.stopPropagation();a=k(a.currentTarget);const b=a.data("slug"),d=a.closest(".tb_module_panel_tab"),e=d.find(".tb_ui_dropdown_label"),f=d.find(".predesigned_row"),h=a.text(),g=b?"tb"+b:!1;this.currentCategory=h;this.addNewItems();e.text(h);d.find(".tb_module_panel_search_text").val("");e.data("active",g);a.addClass("current").siblings().removeClass("current");
f.each(function(){!g||this.classList.contains(g)?k(this).show():k(this).hide()}).filter(":visible").each(function(a){0===(a+1)%4?k(this).addClass("tb_column_break"):k(this).removeClass("tb_column_break")});c.Utils.hideOnClick(d.find(".tb_ui_dropdown_items"))},addNewItems:function(a){this.currentCategory=void 0!==a?"All":this.currentCategory;if(!this.categories[this.currentCategory].isLoaded){var b=k(".tb_module_panel_container .tb_ui_dropdown .tb_ui_dropdown_items"),d=k(".tb_predesigned_rows_container");
"visual"===c.mode&&(d=d.add(c.toolbar.$el.find(".tb_predesigned_rows_container")),b=b.add(c.toolbar.$el.find(".tb_module_panel_container .tb_ui_dropdown .tb_ui_dropdown_items")));b=b.get();d=d.get();a=this.loadItems(a);var e=this;for(b=b.length-1;-1<b;--b){d[b].appendChild(a.cloneNode(!0));let c=d[b].getElementsByTagName("img");0<c.length?(c=c[c.length-1],k(c).one("load",function(){e.initCallback(k(this).closest(".tb_predesigned_rows_container")[0])})):e.initCallback(d[b])}}},scrollLoadMore:function(a){this.loadingItems||
!0===this.categories[this.currentCategory].isLoaded||(a=a.target,a=Math.max(a.scrollHeight-(a.scrollTop+a.offsetHeight),0),0<a&&200>=a&&this.addNewItems())}},pageBreakModule:{countModules(){const a="visual"===c.mode,b=a?m.getElementsByClassName("module-page-break"):m.getElementsByClassName("tb-page-break");for(let c=b.length-1;-1<c;--c)!0===a?b[c].getElementsByClassName("page-break-order")[0].textContent=c+1:b[c].getElementsByClassName("page-break-overlay")[0].textContent="PAGE BREAK - "+(c+1)},get(){return[{cols:[{grid_class:"col-full first last",
modules:[{mod_name:"page-break"}]}],column_alignment:"col_align_middle",styling:{custom_css_row:"tb-page-break"}}]}},common:{btn:null,is_init:null,clicked:null,init(){const a=this;let b=m.createElement("div"),d=c.toolbar.$el;b.className="tb_modules_panel_wrap";b.id="tb_module_panel_dropdown";this.btn=k(b);d=d.add(l.Lightbox.$lightbox);"visual"!==c.mode&&null!==m.querySelector(".edit-post-layout__content")?k(".edit-post-layout__content")[0].appendChild(this.btn[0]):u.body[0].appendChild(this.btn[0]);
if("visual"===c.mode)c.toolbar.$el.find(".tb_module_types li").on("click",this.tabs.bind(this));u.body.on("click",".tb_module_types li",this.tabs.bind(this)).on("click",".tb_column_btn_plus",this.show.bind(this));d.on("click",".tb_clear_input",this.clear);c.toolbar.$el.find(".tb_module_panel_search_text").on("keyup",this.search.bind(this));this.btn.on("click",".add_module_btn,.js-tb_module_panel_acc",function(b){b.preventDefault();b.stopPropagation();let d,e=null,g=this.classList,n=this.dataset.type;
a.clicked||(a.clicked=c.Instances.Builder[c.builderIndex].newRowAvailable(1,!0),e=!0);if("module"===n)d=a.clicked.hasClass("tb_module_btn_plus")?a.clicked.parent():a.clicked.closest(".module_column").find(".tb_holder").last(),c.toolbar.Panel.add_module(b,d);else if("row"===n)d=a.clicked.hasClass("tb_module_btn_plus")?a.clicked.parent():a.clicked.closest(".module_column").find(".tb_holder").first(),c.toolbar.Panel.click_add_sub_row(b,d);else if(g.contains("js-tb_module_panel_acc"))c.toolbar.toggleAccordion(b);
else if("predesigned"===n||"page_break"===n)d=a.clicked.closest(".module_row"),"page_break"===n?c.toolbar.Panel.click_add_page_break(b,d):c.toolbar.preDesignedRows.get(k(b.currentTarget).closest(".predesigned_row").data("slug"),function(a){c.Mixins.Builder.rowDrop(a,e?d:k("<div>").insertAfter(d),!0)});g.contains("js-tb_module_panel_acc")||a.hide(!0)}).on("keyup",".tb_module_panel_search_text",this.search.bind(this)).on("click",".tb_clear_input",this.clear)},run(){this.btn[0].insertAdjacentHTML("beforeend",
c.toolbar.el.querySelector("#tb_module_panel").innerHTML);this.btn.find(".tb_module").show();const a=this.btn.find(".tb_module_types").closest("div")[0];a.parentNode.parentNode.insertBefore(a,a.parentNode);a.parentNode.removeChild(a.nextElementSibling);this.btn.find(".tb_compact_tabs").removeClass("tb_compact_tabs").find(".tb_ui_dropdown_items").removeClass("tb_ui_dropdown_items");this.btn.find(".tb_module_panel_search_text").val("");c.Mixins.Builder.updateModuleSort(this.btn[0]);this.is_init=!0},
tabs(a){a.preventDefault();a.stopPropagation();a=k(a.currentTarget);const b=a.closest("ul");var d=a.data("target");const e=a.closest(".tb_modules_panel_wrap");e.find("."+a.data("hide")).hide();const f=e.find("."+d),h=e.find(".tb_no_content");0<f.length?(h.hide(),f.show()):h.show();a.closest("li").addClass("current").siblings().removeClass("current");e.find(".tb_module_panel_search_text").val("").focus().trigger("keyup");k(m).triggerHandler("tb_panel_tab_"+d,e);d=b.parent().find(".tb_ui_dropdown_label");
0<d.length&&d.text(a.text());c.Utils.hideOnClick(b)},show(a,b){a.preventDefault();a.stopPropagation();!c.activeModel&&r.document.body.classList.contains("tb_standalone_lightbox")&&l.Lightbox.close();null===this.is_init&&this.run();this.clicked&&this.clicked[0].classList.remove("clicked");this.clicked=b?b:k(a.currentTarget);var d=this.clicked.offset();a="visual"!==c.mode?k(".edit-post-layout__content"):!1;b=u.body;let e=d.left+this.clicked.width()/2;d=d.top;!1!==a&&0<a.length&&(d+=a.scrollTop()-70,
e=a.width()/2);e-=this.btn.outerWidth()/2;0>e&&(e=0);this.btn[0].classList.toggle("tb_subrow_open",0<this.clicked.parents(".sub_column").length);this.btn.css({top:d,left:e}).show();this.resize();const f=this.btn[0].getElementsByClassName("tb_predesigned_rows_container")[0];f.closest(".tb_module_panel_rows_wrap").addEventListener("scroll",c.toolbar.preDesignedRows.scrollLoadMore.bind(c.toolbar.preDesignedRows),{passive:!0});"visual"===c.mode&&(b=b.add(k("body",r.document)),"desktop"!==c.activeBreakPoint&&
(k("body",r.document).height(m.body.scrollHeight+this.btn.outerHeight(!0)),u.body.css("padding-bottom",180)));b.addClass("tb_panel_dropdown_openend");this.clicked.addClass("clicked");"desktop"===c.activeBreakPoint&&setTimeout(function(){this.btn.find(".tb_module_panel_search_text").focus()}.bind(this),50);this.hide();c.ActionBar.clear();null!==c.activeModel&&(a=l.Lightbox.$lightbox[0].getElementsByClassName("builder_save_button")[0],void 0!==a&&a.click());a=f.getElementsByTagName("img");0<a.length?
(a=a[a.length-1],k(a).one("load",function(){c.toolbar.preDesignedRows.masonry(f)})):c.toolbar.preDesignedRows.masonry(f);u.trigger("disableInline")},resize(){null!==this.btn&&c.Utils.addViewPortClass(this.btn[0])},hide(a){function b(){if(!0===a||!d.btn.is(":hover")){let a=u.body;null!==d.btn&&(d.btn.hide().css("width",""),d.clicked&&d.clicked[0].classList.remove("clicked"),d.clicked=null);k(m).off("click",b);k(r.document).off("click",b);"visual"===c.mode&&(a=a.add(k("body",r.document)),"desktop"!==
c.activeBreakPoint&&(k("body",r.document).height(m.body.scrollHeight),u.body.css("padding-bottom","")));a.removeClass("tb_panel_dropdown_openend")}}const d=this;if(!0===a)b();else{if("visual"===c.mode)k(r.document).on("click",b);k(m).on("click",b)}},search(a){var b=k(a.currentTarget);a=b.closest(".tb_modules_panel_wrap");const d=a.find(".tb_module_types .current").first().data("target");b=k.trim(b.val());let e=!1,f=!1,h=!1,g=!1,n=!1;"tb_module_panel_modules_wrap"===d?(e=a.find(".tb_module"),h=!0):
"tb_module_panel_rows_wrap"===d&&c.toolbar.preDesignedRows.is_init?(c.toolbar.preDesignedRows.addNewItems(b),f=a.find(".tb_ui_dropdown_label").data("active"),e=a.find(".predesigned_row"),n=!0):"tb_module_panel_library_wrap"===d&&(e=a.find(".tb_library_item"),f=a.find(".tb_library_types .current").data("target"),g=!0);if(!1!==e){const d=""===b,q=d?!1:new RegExp(b,"i");e.each(function(){if(f&&!this.classList.contains(f))return!0;let a=h?k(this).find(".module_name"):g?k(this).find(".tb_library_item_inner span"):
k(this).find(".tb_predesigned_rows_title");d||q.test(a.text())?k(this).show():k(this).hide()});d?a.removeClass("tb_module_panel_searching"):a.addClass("tb_module_panel_searching");h?a.find(".tb_module_category_content").each(function(){this.parentNode.style.display=!1!==d||k(this).find(".tb_module:visible").length?"block":"none"}):n&&c.toolbar.preDesignedRows.masonry(a[0].getElementsByClassName("tb_predesigned_rows_container")[0])}},clear(a){a.preventDefault();a.stopPropagation();a=k(this).parent().children("input").first();
0<a.length&&(a.val(""),a[0].hasAttribute("data-search")?a.trigger("keyup").focus():(a.trigger("change"),u.triggerEvent(a[0],"change")))}},help:{init(){k(".tb_help_btn",c.toolbar.$el).on("click",this.show.bind(this))},show(a){a.preventDefault();a.stopPropagation();const b=this,c=function(a){r.document.body.insertAdjacentHTML("beforeend",a);a=k("#tb_help_lightbox",r.document.body);k(".tb_help_tab_link",a).on("click",b.mainTabs.bind(b));k(".tb_player_btn",a).on("click",b.play.bind(b));k(".tb_help_menu a",
a).on("click",b.tabs.bind(b));k(".tb_close_lightbox",a).on("click",b.close.bind(b));a.slideDown()};let e=!1;l.showLoader("show");r.Themify.LoadCss(themifyBuilder.builder_url+"/css/editor/help-lightbox.css",null,null,null,function(){e||c(e);e=!0});k.ajax({type:"POST",url:themifyBuilder.ajaxurl,data:{tb_load_nonce:themifyBuilder.tb_load_nonce,action:"tb_help"},complete(){l.showLoader("spinhide")},success(a){e?c(a):e=a}})},play(a){a.preventDefault();a.stopPropagation();a=k(a.currentTarget).closest("a");
const b=a.prop("href"),c=m.createElement("iframe");c.setAttribute("frameborder","0");c.setAttribute("allow","autoplay; fullscreen");c.setAttribute("src",b+"?rel=0&showinfo=0&autoplay=1&enablejsapi=1&html5=1&version=3");a.replaceWith(c)},tabs(a){a.preventDefault();a.stopPropagation();a=k(a.currentTarget);const b=k(".tb_help_video_wrapper",r.document),c=b.find(a.attr("href")),e=c.find(".tb_player_btn");b.find(".tb_player_wrapper").removeClass("current").hide();c.addClass("current").show();a.closest("li").addClass("current").siblings().removeClass("current");
this.stopPlay();0<e.length?e.trigger("click"):this.startPlay()},execute(a,b){a.contentWindow.postMessage('{"event":"command","func":"'+b+'","args":""}',"*")},stopPlay(){const a=this;k(".tb_player_wrapper",r.document).each(function(){if(!this.classList.contains("current")){let b=k(this).find("iframe");0<b.length&&a.execute(b[0],"pauseVideo")}})},startPlay(){const a=k(".tb_player_wrapper.current",r.document).find("iframe");0<a.length&&this.execute(a[0],"playVideo")},close(a,b){a.preventDefault();a.stopPropagation();
k(a.currentTarget).closest("#tb_help_lightbox").slideUp("normal",function(){k(this).next(".tb_overlay").remove();k(this).remove();b&&b()})},mainTabs(a){a.preventDefault();a.stopPropagation();a=k(a.currentTarget);const b=k(".tb_help_lightbox_inner_wrapper",r.document);a.hasClass("tb_help_active_tab")||(b.find(".tb_help_active_tab").removeClass("tb_help_active_tab"),a.addClass("tb_help_active_tab"),b.attr("data-active-tab",a.data("type")))}},deviceSwitcher(a){const b=a.target,c=b.parentNode.previousElementSibling;
c.classList.contains("tb_breakpoint_switcher")&&(a.tb_device=[b.dataset.height,b.dataset.width],a.target=c,a.currentTarget=c,this.breakpointSwitcher(a))},breakpointSwitcher(a){a.preventDefault();a.stopPropagation();let b="desktop",d=k("body",r.document);const e=this;var f=a.currentTarget;const h="visual"===c.mode&&c.iframe[0].classList.contains("tb_resizing_start"),g=c.activeBreakPoint,n=function(){e.responsive_grids(b,g);const a=function(){c.Utils.setCompactMode(m.getElementsByClassName("module_column"));
d.removeClass("tb_start_animate tb_start_change_mode").toggleClass("tb_responsive_mode","desktop"!==b).removeClass("builder-breakpoint-"+g).addClass("builder-breakpoint-"+b);u.body.triggerHandler("themify_builder_change_mode",[g,b]);"visual"===c.mode&&(c.iframe[0].style.willChange="",setTimeout(function(){"desktop"!==c.activeBreakPoint?c.Utils.calculateHeight():r.document.body.style.height="";!h&&c.scrollTo&&(k(z).add(r.document).scrollTop(c.scrollTo.offset().top),c.scrollTo=!1);u.trigger("tf_isotop_layout")},
150));c.ActionBar.disable=c.clearOnModeChange=null};"visual"===c.mode?c.Utils._onResize(!0,function(){e.iframeScroll("desktop"!==b);c.ActionBar.hoverCid=null;c.EdgeDrag.clearEdges();setTimeout(a,h?1:100)}):a()};f.classList.contains("breakpoint-tablet")?b="tablet":f.classList.contains("breakpoint-tablet_landscape")?b="tablet_landscape":f.classList.contains("breakpoint-mobile")&&(b="mobile");if(void 0!==a.tb_device||!u.body[0].classList.contains("builder-breakpoint-"+b)){var p;f="desktop"!==b?void 0!==
a.tb_device&&a.tb_device[1]?a.tb_device[1]:c.Utils.getBPWidth(b)-1:"";if(c.isPreview){var q={tablet_landscape:768,tablet:1024,mobile:667};void 0!==q[b]&&(p=void 0!==a.tb_device&&a.tb_device[0]?a.tb_device[0]:q[b])}if(g===b&&void 0!==a.originalEvent&&(f?f+"px":f)===c.iframe[0].style.width&&(p?p+"px":p)===c.iframe[0].style.height)return d.removeClass("tb_start_animate tb_start_change_mode"),!1;c.ActionBar.disable=!0;var w=[];if("visual"===c.mode){null===c.clearOnModeChange&&c.ActionBar.clear();if(!h&&
!c.isPreview){a=c.Instances.Builder[0].el.children;const b=z.innerHeight;q=function(a){if(null!==a&&void 0!==a){const c=a.getBoundingClientRect();if(0>c.bottom&&0>c.top||c.top>b)a.style.display="none",w.push(a)}};for(let b=a.length-1;-1<b;--b)q(a[b]);q(m.getElementById("headerwrap"));q(m.getElementById("footerwrap"))}d=d.add(u.body)}c.activeBreakPoint=b;d.addClass("tb_start_animate tb_start_change_mode");"visual"===c.mode?(c.iframe[0].style.willChange="width",a=r.document.getElementsByClassName("tb_toolbar_zoom_menu")[0],
a.classList.remove("tb_toolbar_zoom_active"),a.getElementsByClassName("tb_toolbar_zoom_menu_toggle")[0].dataset.zoom=100,"tablet_landscape"===b&&l.Lightbox.dockMode.get()&&(a=k(".tb_workspace_container",r.document).width(),a<f&&(f=a)),c.iframe[0].parentNode.classList.remove("tb_zoom_bg"),h?n():(r.document.body.offsetHeight,c.iframe.one("transitionend",function(){for(let a=w.length-1;-1<a;--a)w[a].style.display="";setTimeout(n,10)}),c.iframe[0].style.width=f?f+"px":"",c.iframe[0].style.height=p?p+
"px":"")):n()}},iframeScroll(a){const b=k(r.document);b.off("scroll.themifybuilderresponsive");if(a)b.on("scroll.themifybuilderresponsive",function(){z.scrollTo(0,k(this).scrollTop())})},responsive_grids(a,b){u.LoadCss(tbLocalScript.css_module_url+"responsive-column.css");const c=m.querySelectorAll(".row_inner,.subrow_inner"),e="desktop"===a,f=e||"desktop"===b;for(let d=c.length-1;-1<d;--d){var h=c[d].getAttribute("data-basecol");if(null!==h){let n=c[d].children;var g=c[d].dataset["col_"+a];let q=
n[0],l=n[n.length-1];if(!e){if("desktop"!==b){c[d].classList.remove("tb_3col");let a=c[d].getAttribute("data-col_"+b);a&&c[d].classList.remove(k.trim(a.replace("tb_3col","").replace("mobile","column").replace("tablet","column")))}if(g&&"-auto"!==g&&g!==a+"-auto"){if(g=c[d].getAttribute("data-col_"+a)){c[d].classList.add("tb_grid_classes","col-count-"+h);g=g.split(" ");for(let a=0,b=g.length;a<b;++a)c[d].classList.add(k.trim(g[a].replace("mobile","column").replace("tablet","column")))}}else c[d].classList.remove("tb_grid_classes",
"col-count-"+h)}if(f)for(let a=0,b=n.length;a<b;++a)h=n[a].dataset.w,void 0!==h&&(n[a].style.width=e?h+"%":"");"rtl"===c[d].getAttribute("data-"+a+"_dir")?(q.classList.remove("first"),q.classList.add("last"),l.classList.remove("last"),l.classList.add("first"),c[d].classList.add("direction-rtl")):(q.classList.remove("last"),q.classList.add("first"),l.classList.remove("first"),l.classList.add("last"),c[d].classList.remove("direction-rtl"))}}},Panel:{el:null,init(){this.el=c.toolbar.$el.find(".tb_toolbar_add_modules_wrap");
this.el.on("click",".add_module_btn",this.initEvents.bind(this));this.compactToolbar();"visual"===c.mode&&l.Lightbox.dockMode.setDoc()},initEvents(a){a.preventDefault();a.stopPropagation();const b=a.currentTarget.dataset.type;"module"===b?this.add_module(a):"row"===b?this.click_add_sub_row(a):"page_break"===b?this.click_add_page_break(a):"predesigned"===b&&c.toolbar.preDesignedRows.get(a.currentTarget.closest(".predesigned_row").dataset.slug,function(a){const b=c.Instances.Builder[c.builderIndex].$el.find(".module_row").last();
c.Mixins.Builder.rowDrop(a,k("<div>").insertAfter(b),!0)})},setFocus(){c.toolbar.el.getElementsByClassName("tb_module_panel_search_text")[0].focus()},add_module(a,b){a.preventDefault();a.stopPropagation();b&&0!==b.length||(b=c.Instances.Builder[c.builderIndex].newRowAvailable(1,!0).find(".tb_holder").first());c.Mixins.Builder.moduleDrop(k(a.currentTarget).closest(".tb_module"),b)},click_add_sub_row(a,b){a.preventDefault();a.stopPropagation();const d=!!b;a=k(a.currentTarget).closest(".tb_row_grid").data("slug");
b=b||c.Instances.Builder[c.builderIndex].$el.find(".module_row").last();d?b.hasClass("tb_module_front")?c.Mixins.Builder.subRowDrop(a,k("<div>").insertAfter(b)):c.Mixins.Builder.subRowDrop(a,k("<div>").appendTo(b)):c.Mixins.Builder.rowDrop(c.Utils.grid(a),k("<div>").insertAfter(b),!0,!0)},click_add_page_break(a,b){a.preventDefault();a.stopPropagation();b=b||c.Instances.Builder[c.builderIndex].$el.find(".module_row").last();c.Mixins.Builder.rowDrop(c.toolbar.pageBreakModule.get(),k("<div>").insertAfter(b),
!0);c.toolbar.pageBreakModule.countModules()},compactToolbar(){function a(){c.toolbar.$el.outerWidth()<b?r.document.body.classList.add("tb_compact_toolbar"):r.document.body.classList.remove("tb_compact_toolbar");c.toolbar.common.resize()}const b="visual"===c.mode?850:750;k(r).on("resize.compact",a);if("visual"===c.mode)r.jQuery("body").one("themify_builder_ready",a);else a()}},toggleFavoriteModule(){var a=k(this),b=a.closest(".tb_module"),d=a.parent().data("module-slug");k.ajax({type:"POST",url:themifyBuilder.ajaxurl,
dataType:"json",data:{action:"tb_module_favorite",module_name:d,module_state:+!b.hasClass("favorited")},beforeSend(a){function e(a,b){function f(){if(a.length){if(b)var f=0<a.closest("#tb_module_panel_dropdown").length?c.toolbar.$el:k("#tb_module_panel_dropdown");a.removeAttr("style");var g=a.data("categories").split(","),h=a.closest(".tb_module_panel_modules_wrap"),n=h.find('.tb_module_category_content[data-category="favorite"]');if(a.hasClass("favorited")){for(var l=g.length-1;-1<l;--l){var m=h.find('.tb_module_category_content[data-category="'+
g[l]+'"]').parent();m.find(".tb_module.tb-module-"+d).css({opacity:0,transform:"scale(0.5)"}).remove();m.find(".tb_module").length||m.css({display:"none"})}n.parent().css({display:"block"});a.clone().css({opacity:0,transform:"scale(0.5)"}).appendTo(n).css({opacity:1,transform:"scale(1)"})}else for(l=g.length-1;-1<l;--l){m=h.find('.tb_module_category_content[data-category="'+g[l]+'"]');let b=a.clone().css({opacity:0,transform:"scale(0.5)"}),c=null,d=parseInt(b[0].dataset.index);for(;0!==--d&&!(c=m.find('[data-index="'+
d+'"]'),0<c.length););c?b.insertAfter(c):m.prepend(b);m.parent().css({display:"block"});b.css({opacity:1,transform:"scale(1)"})}b&&e(f.find(".tb_module.tb-module-"+d),!1);a.remove();n.find(".tb_module").length||n.parent().css({display:"none"})}}if(a.length&&!a.is(":visible"))a.toggleClass("favorited"),f();else a.css({opacity:0,transform:"scale(0.5)"}).one("transitionend",function(){a.toggleClass("favorited").one("transitionend",f)})}e(b,!0)}})},zoom(a){function b(){c.Utils._onResize(!0)}a.preventDefault();
if("desktop"!==c.activeBreakPoint)return!0;var d=k(a.currentTarget);a=d.data("zoom");let e=k(".tb_iframe",r.document),f=d.closest(".tb_toolbar_zoom_menu");d.hasClass("tb_toolbar_zoom_menu_toggle")?(a="100"==a?50:100,d.data("zoom",a),d=d.next("ul").find('[data-zoom="'+a+'"]')):f.find(".tb_toolbar_zoom_menu_toggle").data("zoom",a);e.removeClass("tb_zooming_50 tb_zooming_75");d.parent().addClass("selected-zoom-size").siblings().removeClass("selected-zoom-size");"50"==a||"75"==a?(d="50"==a?2:1.25,e.addClass("tb_zooming_"+
a).one("transitionend",b).parent().addClass("tb_zoom_bg").css("height",Math.max(r.innerHeight*d,600)),f.addClass("tb_toolbar_zoom_active"),c.zoomMeta.isActive=!0,c.zoomMeta.size=a,u.body.addClass("tb_zoom_only")):(e.addClass("tb_zooming_"+a).one("transitionend",b).parent().css("height",""),f.removeClass("tb_toolbar_zoom_active"),c.zoomMeta.isActive=!1,u.body.removeClass("tb_zoom_only"))},previewBuilder(a){a.preventDefault();k(a.currentTarget).toggleClass("tb_toolbar_preview_active");c.isPreview=!c.isPreview;
c.isPreview||(c.iframe[0].style.height="");u.body.toggleClass("tb_preview_only themify_builder_active");k("body",r.document).toggleClass("tb_preview_parent");if(c.isPreview){const a=m.getElementsByClassName("row_inner");for(let d=a.length-1;-1<d;--d)if(a[d].classList.contains("col-count-1")&&0===a[d].getElementsByClassName("active_module").length){var b=a[d].getElementsByClassName("module_column")[0];if((b=c.Models.Registry.lookup(b.getAttribute("data-cid")))&&0===Object.keys(b.get("styling")).length){b=
a[d].closest(".module_row");let e=c.Models.Registry.lookup(b.getAttribute("data-cid"));e&&0===Object.keys(e.get("styling")).length&&b.classList.add("tf_hide")}}}else k(".tf_hide.module_row").removeClass("tf_hide");"visual"===c.mode&&(!r.document.body.classList.contains("tb_panel_minimized")&&l.Lightbox.dockMode.get()&&c.Utils._onResize(!0),c.isPreview||"desktop"===c.activeBreakPoint||(a.tb_device="mobile"===c.activeBreakPoint?[tbLocalScript.breakpoints[c.activeBreakPoint],""]:tbLocalScript.breakpoints[c.activeBreakPoint],
a.currentTarget=a.target=c.toolbar.el.getElementsByClassName("breakpoint-"+c.activeBreakPoint)[0],this.breakpointSwitcher(a)));c.vent.trigger("dom:preview")},toggleAccordion(a){k(a.currentTarget).closest(".tb_module_panel_tab_acc_component").toggleClass("tb_collapsed")},closeFloat(a){a&&(a.preventDefault(),a.stopPropagation(),localStorage.setItem("tb_panel_closed",!0));r.document.body.classList.add("tb_panel_closed")},openFloat(a){a&&(a.preventDefault(),a.stopPropagation(),localStorage.removeItem("tb_panel_closed"));
r.document.body.classList.remove("tb_panel_closed");c.toolbar.common.hide(!0)}});c.Forms={Data:{},Validators:{},parseSettings(a,b){var d=a.classList;b=b?a.getAttribute("data-input-id"):a.getAttribute("id");if(!d.contains("tb_row_js_wrapper")){var e=a.closest(".tb_field");if(null!==e&&!e.classList.contains("_tb_hide_binding")&&("none"!==e.style.display||-1===e.className.indexOf("tb_group_element_"))&&(e=e.parentNode,e.classList.contains("tb_multi_fields")&&e.parentNode.classList.contains("_tb_hide_binding")))return!1}e=
"";if(d.contains("tb_lb_wp_editor"))"undefined"!==typeof tinyMCE?(e=a.id,d=tinyMCE.get(e),e=null!==d?!1===d.hidden?d.getContent():switchEditors.wpautop(tinymce.DOM.get(e).value):a.value):e=a.value;else if(d.contains("themify-checkbox")){e=[];a=a.getElementsByClassName("tb-checkbox");d=d.contains("tb_switcher");for(let b=0,c=a.length;b<c;++b)!0!==d&&!0!==a[b].checked||""===a[b].value||e.push(a[b].value);e=0<e.length?e.join("|"):d?"":!1}else if(d.contains("themify-layout-icon"))e=a.getElementsByClassName("selected")[0],
e=void 0!==e?e.id:"";else if(d.contains("tb_search_input")){if(e=a.getAttribute("data-value"),a=a.closest(".tb_input").getElementsByClassName("query_category_multiple")[0])a=void 0===a?"":a.value.trim(),e=""!==a?a+"|"+(-1!==a.indexOf(",")?"multiple":"single"):e+"|single"}else if(d.contains("tb_radio_input_container")){a=a.getElementsByTagName("input");d=null;for(var f=a.length-1;-1<f;--f)if(!0===a[f].checked){d=a[f];break}null===d||"desktop"!==c.activeBreakPoint&&d.classList.contains("responsive_disable")||
(e=d.value)}else if(d.contains("tb_search_container"))e=a.previousElementSibling.dataset.value;else if(d.contains("tb_row_js_wrapper")){e=[];a=a.getElementsByClassName("tb_repeatable_field_content");for(let b=0,c=a.length;b<c;++b){d=a[b].getElementsByClassName("tb_lb_option_child");e[b]={};for(let a=0,c=d.length;a<c;++a)(f=this.parseSettings(d[a],!0))&&(e[b][f.id]=f.v)}}else if(d.contains("module-widget-form-container"))e=k(a).find(":input").themifySerializeObject();else if(d.contains("tb_widget_select"))e=
a.getElementsByClassName("selected")[0],e=void 0!==e?e.dataset.value:"";else if(d.contains("tb_sort_fields_parent")){a=a.children;e=[];for(let b=0,c=a.length;b<c;++b)if(d=a[b].getAttribute("data-type")){f=a[b].getElementsByClassName("tb_sort_field_dropdown")[0];d={type:d,id:a[b].getAttribute("data-id")};if(void 0!==f){d.val={};f=f.getElementsByClassName("tb_lb_sort_child");for(var h=f.length-1;-1<h;--h){var g=this.parseSettings(f[h],!0);g&&(d.val[g.id]=g.v)}}else f=a[b].getElementsByTagName("input")[0].value,
""!==f&&(d.val=JSON.parse(f));e.push(d)}0===e.length&&(e="")}else if(d.contains("tb_accordion_fields")){a=a.children;e={};for(let b=0,c=a.length;b<c;++b)if(d=a[b].getAttribute("data-id"))h=a[b].getElementsByTagName("input")[0],g=a[b].getElementsByClassName("tb_accordion_fields_options")[0],f={},void 0!==g?f.val=this.serialize(g,null,!0):(h=h.value,""!==h&&(f.val=JSON.parse(h))),e[d]=f}else if(d.contains("tb_toggleable_fields")){a=a.children;e={};for(let b=0,c=a.length;b<c;++b)if(d=a[b].getAttribute("data-id"))h=
a[b].getElementsByTagName("input")[0],g=a[b].getElementsByClassName("tb_toggleable_fields_options")[0],f={on:a[b].getElementsByClassName("tb_switcher")[0].getElementsByClassName("toggle_switch")[0].value},void 0!==g?f.val=this.serialize(g,null,!0):(h=h.value,""!==h&&(f.val=JSON.parse(h))),e[d]=f}else if(e=a.value,void 0!==z.tbpDynamic&&b===tbpDynamic.field_name){if(""===e)return!1;"string"===typeof e&&(e=JSON.parse(e))}else{if(b===c.GS.key&&"desktop"!==c.activeBreakPoint)return!1;""!==e&&("builder_content"===
b?"string"===typeof e&&(e=JSON.parse(e)):(a=a.getAttribute("data-opacity"),null!==a&&""!==a&&1!=a&&"0.99"!=a&&(e+="_"+a)))}if(void 0===e||null===e)e="";return{id:b,v:e}},serialize(a,b,c){const d={};a="object"===typeof a?a:r.document.getElementById(a);c=c||!1;if(null!==a){a=a.getElementsByClassName(c?"tb_lb_option_child":"tb_lb_option");for(let e=a.length-1;-1<e;--e){let f=this.parseSettings(a[e],c);!1===f||!0!==b&&""===f.v||(d[f.id]=f.v)}}return d},LayoutPart:{cache:[],undo:null,old_id:null,isReload:null,
id:null,init:!1,html:null,el:null,options:null,isSaved:null,scrollTo(a,b){c.scrollTo=c.Forms.LayoutPart.el},edit(a){function b(a){c.ActionBar.clear();m.getElementById("themify_builder_content-"+themifyBuilder.post_ID).insertAdjacentHTML("afterbegin",'<div class="tb_overlay"></div>');e.addClass("tb_active_layout_part").closest(".row_inner").find(".active_module").each(function(){this.classList.contains("tb_active_layout_part")||this.insertAdjacentHTML("afterbegin",'<div class="tb_overlay"></div>')});
const b="themify_builder_content-"+d.id,g=[];d.html=e[0].innerHTML;themifyBuilder.post_ID=ThemifyStyles.builder_id=d.id;e[0].insertAdjacentHTML("afterbegin",h.replace("#postID#",d.id));k("."+b).each(function(){k(this).closest(".active_module").find(".themify-builder-generated-css").first().prop("disabled",!0)});c.Instances.Builder[0].el.classList.remove("tb_active_builder");e.removeClass("active_module module").closest(".tb_holder").removeClass("tb_holder").addClass("tb_layout_part_parent").closest(".module_row").addClass("tb_active_layout_part_row");
f.attr("id",b).removeClass("not_editable_builder").addClass("tb_active_builder").empty();d.el=e;c.id=d.id;c.builderIndex=1;c.Instances.Builder[c.builderIndex]=new c.Views.Builder({el:f,collection:new c.Collections.Rows(a),type:c.mode});a=c.Instances.Builder[c.builderIndex].render().el.querySelectorAll("[data-cid]");for(let b=0,c=a.length;b<c;++b)g[a[b].dataset.cid]=1;c.bootstrap(g,function(){e.triggerHandler("tb_layout_part_before_init");c.activeModel=null;c.Utils.loadContentJs(f);c.id=!1;u.body.on("themify_builder_change_mode",
d.scrollTo);c.hasChanged=null;c.Instances.Builder[c.builderIndex].$el.triggerHandler("tb_init");e.find(".tb_toolbar_save").on("click",d.save.bind(d));e.find(".tb_toolbar_close_btn").on("click",d.close.bind(d));e.find(".tb_load_layout").on("click",c.Views.Toolbar.prototype.loadLayout);e.find(".tb_toolbar_import ul a").on("click",c.Views.Toolbar.prototype.import);l.showLoader("hide");d.init=!1;d.undo=c.undoManager.stack;c.undoManager.btnUndo=e[0].getElementsByClassName("tb_undo_btn")[0];c.undoManager.btnRedo=
e[0].getElementsByClassName("tb_redo_btn")[0];c.undoManager.reset();e.find(".tb_undo_redo").on("click",function(a){c.undoManager.do_change(a)});c.ActionBar.disable=c.ActionBar.hoverCid=null;e.triggerHandler("tb_layout_part_after_init")})}c.ActionBar.disable=!0;l.showLoader("show");m.body.classList.add("tb_layout_part_edit");if(null!==c.activeModel){const a=l.Lightbox.$lightbox[0].getElementsByClassName("builder_save_button")[0];void 0!==a&&a.click()}r.document.body.classList.add("tb_layout_part_edit");
const d=this,e=k(a).closest(".active_module"),f=e.find(".themify_builder_content"),h=l.templateCache.get("tmpl-small_toolbar");this.id=f.data("postid");this.old_id=themifyBuilder.post_ID;this.init=!0;this.isSaved=null;void 0!==this.cache[this.id]?b(this.cache[this.id]):k.ajax({type:"POST",dataType:"json",url:themifyBuilder.ajaxurl,data:{action:"tb_layout_part_swap",nonce:themifyBuilder.tb_load_nonce,id:d.id},success(a){a.data&&(d.cache[d.id]=a.data,a.gs&&(c.GS.styles=k.extend(!0,{},a.gs,c.GS.styles)),
b(a.data))}})},close(a){function b(){d.el.removeClass("tb_active_layout_part").addClass("active_module module").closest(".tb_layout_part_parent").addClass("tb_holder").removeClass("tb_layout_part_parent").closest(".module_row").removeClass("tb_active_layout_part_row");k("#tb_small_toolbar",d.el).remove();const a=e[0].querySelectorAll("[data-cid]");for(let b=a.length-1;-1<b;--b){let d=a[b].dataset.cid,e=c.Models.Registry.lookup(d);e&&(e.destroy(),c.Models.Registry.remove(d))}e.removeAttr("id").addClass("not_editable_builder").removeClass("tb_active_builder");
m.body.classList.remove("tb_layout_part_edit");r.document.body.classList.remove("tb_layout_part_edit");k(".tb_overlay").remove();c.undoManager.stack=d.undo;c.undoManager.index=d.undo.length-1;c.undoManager.btnUndo=c.toolbar.el.getElementsByClassName("tb_undo_btn")[0];c.undoManager.btnRedo=c.toolbar.el.getElementsByClassName("tb_redo_btn")[0];themifyBuilder.post_ID=ThemifyStyles.builder_id=d.old_id;d.undo=d.isSaved=d.old_id=d.html=d.id=d.options=d.isReload=d.el=c.Instances.Builder[c.builderIndex]=
null;delete c.Instances.Builder[c.builderIndex];c.builderIndex=0;u.body.off("themify_builder_change_mode",d.scrollTo);c.undoManager.updateUndoBtns();c.ActionBar.hoverCid=null;c.ActionBar.clear();c.Instances.Builder[c.builderIndex].el.classList.add("tb_active_builder");c.Instances.Builder[c.builderIndex].lastRowAddBtn()}a.preventDefault();a.stopPropagation();if(!c.hasChanged&&!c.undoManager.hasUndo()||null!==this.isSaved||confirm(themifyBuilder.i18n.layoutEditConfirm)){null!==c.activeModel&&l.Lightbox.close();
var d=this,e=this.el.find(".themify_builder_content");if(null!==this.options){l.showLoader("show");a=c.Models.Registry.lookup(this.el.data("cid"));this.cache[this.id]=this.options;const f=function(a,h,p){if(-1!==p.data.indexOf("tb_load_module_partial",3))if(k(this).off("ajaxComplete",f),200===h.status){d.el=c.liveStylingInstance.$liveStyledElmt;e=d.el.find(".themify_builder_content");let a=e[0].innerHTML,f="";d.el.find(".themify-builder-generated-css").each(function(){f+=this.outerHTML});k(".themify_builder_content-"+
d.id).each(function(){const b=k(this).closest(".module");b.children("link.themify-builder-generated-css").remove();""!==f&&b[0].insertAdjacentHTML("afterbegin",f);this.innerHTML=a;c.Utils.loadContentJs(k(this))});l.showLoader("hide");b()}else l.showLoader("error")};k(m).ajaxComplete(f);const h=k.extend(!0,{},a.get("mod_settings"));h.unsetKey=!0;a.trigger("custom:preview:refresh",h)}else this.el[0].innerHTML=d.html,b(),k(".themify_builder_content-"+d.id).each(function(){k(this).closest(".active_module").find(".themify-builder-generated-css").removeAttr("disabled")}),
c.Utils.loadContentJs(e)}},save(a,b){a.preventDefault();a.stopPropagation();if(null!==c.activeModel){const a=l.Lightbox.$lightbox[0].getElementsByClassName("builder_save_button")[0];void 0!==a&&a.click()}if(c.undoManager.hasUndo()||null!==this.isReload||b){const d=this;this.old_settings=this.html=null;l.showLoader("show");c.Utils.saveBuilder(function(e){d.options=e.data.builder_data;c.hasChanged=null;d.isSaved=!0;b&&d.close(a)})}else l.showLoader("show"),setTimeout(function(){l.showLoader("hide")},
100)}},reLoad(a,b,d){function e(){"visual"===c.mode&&(c.liveStylingInstance.setCss(c.Mixins.Builder.toJSON(c.Instances.Builder[g].el)),c.Utils.loadContentJs(c.Instances.Builder[g].$el),c.id=!1);c.Instances.Builder[c.builderIndex].$el.triggerHandler("tb_init");l.showLoader("hide");"visual"===c.mode&&"desktop"!==c.activeBreakPoint&&(k("body",r.document).height(m.body.scrollHeight),setTimeout(function(){k("body",r.document).height(m.body.scrollHeight)},2E3));d&&d();c.hasChanged=!0}var f=void 0!==a.builder_data?
a.builder_data:a;const h=null!==c.Forms.LayoutPart.id,g=c.builderIndex;void 0!==a.used_gs&&(c.GS.styles=k.extend(!0,{},a.used_gs,c.GS.styles));let n=null,p="";h||(c.Models.Registry.destroy(),c.Instances.Builder={});"visual"===c.mode?(p="#themify_builder_content-"+b,c.id=b,h||(c.liveStylingInstance.reset(),c.editing=!1,u.body.addClass("sidebar-none full_width"),k("#sidebar,.page-title").remove())):p="#tb_row_wrapper";if(h){b=c.Instances.Builder[g].el.querySelectorAll("[data-cid]");c.Forms.LayoutPart.isReload=
!0;for(let a=0,d=b.length;a<d;++a){let d=b[a].dataset.cid,e=c.Models.Registry.lookup(d);e&&(e.destroy(),c.Models.Registry.remove(d))}c.Instances.Builder[g].$el.empty()}c.Instances.Builder[g]=new c.Views.Builder({el:p,collection:new c.Collections.Rows(f),type:c.mode});c.Instances.Builder[g].render();c.undoManager.reset();if(h){n=[];f=c.Instances.Builder[g].el.querySelectorAll("[data-cid]");for(let a=0,b=f.length;a<b;++a)n[f[a].dataset.cid]=1}"visual"===c.mode?c.bootstrap(n,e,void 0!==a.used_gs?a.used_gs:
null):e()},isValidate(a){const b=a.getElementsByClassName("tb_must_validate");var d=b.length;if(0===d)return!0;var e=!0;for(--d;-1<d;--d){var f=b[d].getElementsByClassName("tb_lb_option")[0],h=b[d].getAttribute("data-validation"),g=f.value;if(c.Forms.get_validator(h)(g))for(f.classList.remove("tb_field_error"),f=b[d].getElementsByClassName("tb_field_error_msg"),h=f.length-1;-1<h;--h)f[h].parentNode.removeChild(f[h]);else f.classList.contains("tb_field_error")||(e=m.createElement("span"),h="SELECT"===
f.tagName?f.parentNode:f,e.className="tb_field_error_msg",e.textContent=b[d].getAttribute("data-error-msg"),f.classList.add("tb_field_error"),h.parentNode.insertBefore(e,h.nextSibling)),e=!1}!1===e&&(a=l.Lightbox.$lightbox.find('[href="#'+a.getAttribute("id")+'"]')[0],a.parentNode.classList.contains("current")||a.click());return e}};c.Utils={onResizeEvents:[],gridClass:"col-full col2-1 col3-1 col4-1 col5-1 col6-1 col4-2 col4-3 col3-2".split(" "),_onResize(a,b){let d=k._data(z,"events"),e;d&&(d=d.resize);
k(r).off("resize.tb_visual").on("resize.tb_visual",function(a){e&&clearTimeout(e);e=setTimeout(function(){u.trigger("tfsmartresize");k(z).triggerHandler("tfsmartresize");if(c.zoomMeta.isActive){let a="50"==c.zoomMeta.size?2:1.25;k(".tb_workspace_container",r.document).css("height",Math.max(r.innerHeight*a,600))}},400)});if(d)for(let a=0,b=d.length;a<b;++a)void 0!==d[a].handler&&this.onResizeEvents.push(d[a].handler);k(z).off("resize");if(a){a=k.Event("resize",{type:"resize",isTrigger:!1});for(let b=
0,c=this.onResizeEvents.length;b<c;++b)try{this.onResizeEvents[b].apply(z,[a,k])}catch(g){}u.trigger("tfsmartresize");k(z).triggerHandler("tfsmartresize");"function"===typeof b&&b()}},_addNewColumn(a,b){a=c.Views.init_column({grid_class:a.newclass,component_name:a.component});b.appendChild(a.view.render().el)},filterClass(a){a=a.split(" ");const b=[];for(let c=a.length-1;-1<c;--c)-1!==this.gridClass.indexOf(a[c])&&b.push(a[c]);return b.join(" ")},_getRowSettings(a,b){b=b||"row";var d={},e=c.Models.Registry.lookup(a.getAttribute("data-cid"));
if(e){a=a.getElementsByClassName(b+"_inner")[0];d=[];for(let e=0,k=a.children,l=k.length;e<l;++e){var f=c.Models.Registry.lookup(k[e].getAttribute("data-cid"));if(f){let a=k[e].getElementsByClassName("tb_holder")[0],g=d.push({element_id:f.get("element_id"),grid_class:this.filterClass(k[e].className)});--g;if(void 0!==a){a=a.children;let e=[];for(let d=0,f=a.length;d<f;++d){var h=c.Models.Registry.lookup(a[d].getAttribute("data-cid"));h&&(b=h.get("mod_settings"),h=e.push({mod_name:h.get("mod_name"),
element_id:h.get("element_id")})-1,b&&0<Object.keys(b).length&&(delete b.cid,e[h].mod_settings=b),a[d].classList.contains("active_subrow")&&(e[h]=this._getRowSettings(a[d],"subrow")))}0<e.length&&(d[g].modules=e)}b=parseFloat(k[e].style.width);0<b&&!isNaN(b)&&(d[g].grid_width=b);(b=f.get("styling"))&&0<Object.keys(b).length&&(delete b.cid,d[g].styling=b)}}d={element_id:e.get("element_id"),cols:d,column_alignment:e.get("column_alignment"),gutter:e.get("gutter"),column_h:e.get("column_h")};b={gutter:"gutter-default",
column_alignment:M?"col_align_middle":"col_align_top"};f={desktop_dir:"ltr",tablet_dir:"ltr",tablet_landscape_dir:"ltr",mobile_dir:"ltr",col_tablet_landscape:"-auto",col_tablet:"-auto",col_mobile:"-auto"};for(let a in d)""!==d[a]&&null!==d[a]&&d[a]!==b[a]||delete d[a];b=e.get("styling");for(let b in f)e=a.getAttribute("data-"+b),null===e||""===e||e===f[b]||"-auto"===f[b]&&-1!==e.indexOf("-auto")||(d[b]=e.trim());b&&0<Object.keys(b).length&&(delete b.cid,d.styling=b)}return d},selectedGridMenu(a,b){var d=
ThemifyConstructor.breakpointsReverse;const e=c.Models.Registry.lookup(a.getAttribute("data-cid")),f=a.getElementsByClassName(b+"_inner")[0];var h=e.get("gutter");const g=e.get("column_alignment")||"col_align_top",k=e.get("column_h"),l=e.get("desktop_dir"),q="row"===b?e.get("styling"):null;b=[];const m={},t=f.children,v=t.length;for(let a=v-1;-1<a;--a)t[a].className=t[a].className.replace(/first|last/ig,""),1!==v&&(0===a?t[a].className+="rtl"===l?" last":" first":a===v-1&&(t[a].className+="rtl"===
l?" first":" last"));b.push("col-count-"+v);m["data-basecol"]=v;null!==q&&void 0!==q.row_anchor&&""!==q.row_anchor&&(a.getElementsByClassName("tb_row_anchor")[0].textContent=q.row_anchor);"gutter-default"!==h&&b.push(h);k&&b.push("col_auto_height");b.push(g);"ltr"!==l&&b.push("direction-rtl");for(a=d.length-1;-1<a;--a)h=e.get(d[a]+"_dir"),"ltr"!==h&&""!==h&&(m["data-"+d[a]+"_dir"]=h),"desktop"!==d[a]&&(h=e.get("col_"+d[a]),"-auto"!==h&&""!==h&&void 0!==h&&(m["data-col_"+d[a]]=h));for(d=b.length-1;-1<
d;--d)b[d]&&f.classList.add(b[d]);for(let a in m)f.setAttribute(a,m[a])},clear(a,b){void 0===b&&(b=Array.isArray(a));const d=!0===b?[]:{},e=void 0!==z.tbpDynamic?tbpDynamic.field_name:!1;for(let g in a)if(a.hasOwnProperty(g)&&"null"!==g)if(Array.isArray(a[g])){var f=this.clear(a[g],!0);0<f.length&&(!0===b?d.push(f):d[g]=f)}else if(g===e)if("{}"===a[g]||""===a[g])delete a[g],delete d[g];else{f=a[g];"string"===typeof f&&(f=JSON.parse(f));for(let b in f)"undefined"===typeof f[b].repeatable&&(void 0===
f[b].item?delete f[b]:void 0!==a[b]&&(delete a[b],delete d[b]));a[g]=d[g]=f}else if("object"===typeof a[g]){if("breakpoint_mobile"===g||"breakpoint_tablet"===g||"breakpoint_tablet_landscape"===g){f=a[g];for(let a in f)if(void 0===f[a]||null===f[a]||""===f[a])delete f[a];else if("px"===f[a]&&-1!==a.indexOf("_unit",2)){var h=a.replace("_unit","");if(void 0===f[h]||""===f[h])delete f[a],""===f[h]&&delete f[h]}}else f=this.clear(a[g],!1);f&&0<Object.keys(f).length&&(d[g]=f)}else if(null!==a[g]&&void 0!==
a[g]&&""!==a[g]&&"def"!==a[g]&&""!==g&&"pixels"!==a[g]&&"default"!==a[g]&&"|"!==a[g]&&!("hide_anchor"===g&&!a[g]||"show"===a[g]&&0===g.indexOf("visibility_")||"unstick_when_condition"===g&&"hits"===a[g]||"unstick_when_pos"===g&&"this"===a[g]||"unstick_when_element"===g&&"builder_end"===a[g]||("stick_at_pos_val_unit"===g||"unstick_when_pos_val_unit"===g)&&"px"===a[g]))if("custom_parallax_scroll_speed"!==g||a[g])if("unstick_when_check"!==a[g]&&("unstick_when_check"===g||"unstick_when_check_tl"===g||
"unstick_when_check_t"===g||"unstick_when_check_m"===g)||"builder_end"===a[g]&&("unstick_when_element"===g||"unstick_when_element_tl"===g||"unstick_when_element_t"===g||"unstick_when_element_m"===g)||"stick_at_check"===g&&"stick_at_check"!==a[g]||!("-1"!=a[g]&&a[g]||"stick_at_check_tl"!==g&&"stick_at_check_t"!==g&&"stick_at_check_m"!==g)){f="";if("unstick_when_element_tl"===g||"stick_at_check_tl"===g||"unstick_when_check_tl"===g)f="_ti";else if("unstick_when_element_t"===g||"stick_at_check_t"===g||
"unstick_when_check_t"===g)f="_t";else if("unstick_when_element_m"===g||"stick_at_check_m"===g||"unstick_when_check_m"===g)f="_m";delete d["unstick_when_el_row_id"+f];delete d["unstick_when_el_mod_id"+f];delete d["unstick_when_condition"+f];delete a["unstick_when_el_row_id"+f];delete a["unstick_when_el_mod_id"+f];delete a["unstick_when_condition"+f];delete d["unstick_when_pos"+f];delete d["unstick_when_pos_val"+f];delete d["unstick_when_element"+f];delete d["unstick_when_pos_val_unit"+f];delete a["unstick_when_pos"+
f];delete a["unstick_when_pos_val"+f];delete a["unstick_when_pos_val_unit"+f];delete a["unstick_when_element"+f];if("stick_at_check"===g||"stick_at_check_tl"===g||"stick_at_check_t"===g||"stick_at_check_m"===g){if("stick_at_check"===g||"-1"==a[g])delete a[g],delete d[g];delete a["stick_at_position"+f];delete d["stick_at_position"+f]}}else if(void 0===g||null===g||""===g||!1===g||"stick_at_position"===g&&"top"===a[g]||g===c.GS.key&&""===a[g].trim()||"background_gradient-css"===g||"cover_gradient-css"===
g||"cover_gradient_hover-css"===g||"background_image-type_image"===g||"custom_parallax_scroll_reverse_reverse"===g||"|single"===a[g]||"|multiple"===a[g]||("custom_parallax_scroll_reverse"===g||"custom_parallax_scroll_fade"===g||"visibility_all"===g||"sticky_visibility"===g)&&!a[g])delete a[g],delete d[g];else{if("builder_content"===g)"string"===typeof a[g]&&(a[g]=JSON.parse(a[g])),a[g]=this.clear(a[g],!0);else{f=[];if(0===g.indexOf("checkbox_")&&-1!==g.indexOf("_apply_all",6)){a[g]?d[g]=a[g]:f.push(g);
h=g.replace("_apply_all","").replace("checkbox_","");let b=["top","left","right","bottom"];for(let c=3;-1<c;--c){let e=h+"_"+b[c]+"_unit";"px"===a[e]?f.push(e):void 0!==a[e]&&null!==a[e]&&""!==a[e]&&(d[e]=a[e])}}else-1!==g.indexOf("gradient",3)?("180"==a[g]||"linear"===a[g]||a[g]===k.ThemifyGradient.default||!1===a[g]&&-1!==g.indexOf("-circle-radial",3))&&f.push(g):("px"===a[g]&&-1!==g.indexOf("_unit",2)||"background_zoom"===g&&""===a[g]||"none"===a[g]&&-1!==g.indexOf("frame_layout")||"solid"===a[g]||
!1===a[g]&&(-1!==g.indexOf("_user_role",3)||-1!==g.indexOf("_appearance",3))||!(a[g]&&"false"!==a[g]||"margin-top_opp_top"!==g&&"m_t_h_opp_top"!==g&&0!==g.indexOf("padding_opp_")&&0!==g.indexOf("margin_opp_")))&&f.push(g);if(0<f.length){for(h=f.length-1;-1<h;--h)delete d[f[h]],delete a[f[h]];f.length=0;continue}}!0===b?d.push(a[g]):d[g]=a[g]}else delete d.custom_parallax_scroll_reverse,delete d.custom_parallax_scroll_fade,delete d[g],delete a.custom_parallax_scroll_reverse,delete a.custom_parallax_scroll_fade,
delete a[g];return d},clearElementId(a,b){for(let e in a){!0===b?a[e].element_id=c.Utils.generateUniqueID():delete a[e].element_id;let f=void 0!==a[e].styling?a[e].styling:a[e].mod_settings;if(void 0!==f){if(void 0!==f.custom_css_id&&""!==f.custom_css_id)for(var d=2;;){let a=f.custom_css_id+"-"+d.toString(),b=m.getElementById(a);if(null===b||null===b.closest(".module_row")){f.custom_css_id=a;break}++d}void 0!==f.builder_content&&(d="string"===typeof f.builder_content?JSON.parse(f.builder_content):
f.builder_content,this.clearElementId(d,!0),f.builder_content=d)}void 0!==a[e].cols?this.clearElementId(a[e].cols,b):void 0!==a[e].modules&&this.clearElementId(a[e].modules,b)}},clearLastEmptyRow(a){for(let d=a.length-1;-1<d;--d){var b=void 0!==a[d].attributes?a[d].attributes:a[d];if(void 0===b.styling||null===b.styling||0===Object.keys(b.styling).length){b=b.cols;let e=!0;for(let a in b)if(void 0!==b[a].modules&&(0<b[a].modules.length||0<Object.keys(b[a].modules).length)||void 0!==b[a].styling&&
null!==b[a].styling&&0<Object.keys(b[a].styling).length){e=!1;break}if(!0===e)void 0!==a[d].cid&&(c.Models.Registry.remove(a[d].cid),a[d].destroy()),a.splice(d,1);else break}else break}},builderPlupload(a,b){const d=!!b;b=d?[b]:l.Lightbox.$lightbox[0].getElementsByClassName("tb_plupload_upload_uic");var e=b.length;if(0<e)for(a=d?!1:"new_elemn"===a?".plupload-clone":!1,void 0===this.pconfig&&(this.pconfig=JSON.parse(JSON.stringify(themify_builder_plupload_init)),this.pconfig.multipart_params._ajax_nonce=
themifyBuilder.tb_load_nonce,this.pconfig.multipart_params.topost=themifyBuilder.post_ID),--e;-1<e;--e)if(!b[e].classList.contains("tb_plupload_init")&&(!1===a||b[e].classList.contains(a))){let a=b[e];var f=a.getAttribute("id").replace("tb_plupload_upload_ui","");let g=k.extend(!0,{},this.pconfig),n=a.getAttribute("data-extensions"),p=["browse_button","container","drop_element","file_data_name"];g.multipart_params.imgid=f;for(let a=p.length-1;-1<a;--a)g[p[a]]=f+this.pconfig[p[a]];g.filters[0].extensions=
null!==n?n:null!==c.activeModel?g.filters[0].extensions.replace(/,zip|,txt/,""):"zip,txt";f=new r.plupload.Uploader(g);a.classList.add("tb_plupload_init");d&&f.bind("init",function(a){k(a.settings.browse_button).click()});f.bind("FilesAdded",function(a,b){a.refresh();a.start();l.showLoader("show")});f.bind("Error",function(a,b){a=k(".prompt-box .show-error");k(".prompt-box .show-login").hide();a.show();0<a.length&&a.html('<p class="prompt-error">'+b.message+"</p>");k(".overlay, .prompt-box").fadeIn(500)});
f.bind("FileUploaded",function(a,b,e){const f=JSON.parse(e.response);a=k("#tb_alert",r.document);e=200!==e.status||f.error?"error":"done";if(f.error)l.showLoader(e),alert(f.error);else if(d){const b=k("#tb_row_wrapper").children().clone(!0);a.promise().done(function(){f.custom_css&&(A=f.custom_css);c.Forms.reLoad(f,themifyBuilder.post_ID);const a=k("#tb_row_wrapper").children().clone(!0);l.Lightbox.close();c.undoManager.push("","","","import",{before:b,after:a,bid:themifyBuilder.post_ID})})}else l.showLoader(e),
a=this.getOption().container.closest(".tb_input"),e=a.getElementsByClassName("tb_uploader_input")[0],a=a.getElementsByClassName("thumb_preview")[0],e.value=f.large_url?f.large_url:f.url,void 0!==a&&ThemifyConstructor.file.setImage(a,f.thumb),u.triggerEvent(e,"change")});f.init();a.classList.remove("plupload-clone")}},grid(a){const b=[];a=parseInt(a);if(1===a)b.push({grid_class:"col-full"});else for(let c=0;c<a;++c)b.push({grid_class:"col"+a+"-1"});return[{cols:b}]},setCompactMode(a){a instanceof jQuery&&
(a=a.get());for(let b=a.length-1;-1<b;--b)185>a[b].clientWidth?a[b].classList.add("compact-mode"):a[b].classList.remove("compact-mode")},initNewEditor(a){if(3<parseInt(tinyMCE.majorVersion)){const b=tinyMCEPreInit.mceInit.tb_lb_hidden_editor;b.elements=a;b.selector="#"+a;a=new tinyMCE.Editor(a,b,tinyMCE.EditorManager);a.render();return a}},initQuickTags(a){"function"===typeof r.QTags&&(r.quicktags({id:a}),r.QTags._buttonsInit())},_getColClass(a){for(let b=0,c=a.length;b<c;++b)if(-1!==this.gridClass.indexOf(a[b]))return a[b].replace("col",
"")},getMouseEvents(){const a={mousedown:"mousedown",mousemove:"mousemove",mouseup:"mouseup"};u.isTouch&&(a.mousedown="touchstart",a.mousemove="touchmove",a.mouseup="touchend");return a},saveBuilder(a,b){if(null!==c.activeModel||0===c.builderIndex&&0<l.Lightbox.$lightbox.length&&l.Lightbox.$lightbox[0].classList.contains("tb_custom_css_lightbox")){var d=l.Lightbox.$lightbox[0].getElementsByClassName("builder_save_button")[0];d&&d.click()}d=c.Instances.Builder[c.builderIndex];const e=this,f=d.$el.data("postid"),
h=c.Mixins.Builder.toJSON(d.el);if(!0===b)return{id:f,data:h};c.GS.setImport(c.GS.styles,null,null,!0);null===A&&(A=themifyBuilder.custom_css,delete themifyBuilder.custom_css);l.showLoader("show");e.saveCss(h,A,f).done(function(){k.ajax({type:"POST",url:themifyBuilder.ajaxurl,cache:!1,data:{action:"tb_save_data",tb_load_nonce:themifyBuilder.tb_load_nonce,id:f,custom_css:A,data:JSON.stringify(c.Utils.clear(h)),sourceEditor:"visual"===c.mode?"frontend":"backend"},complete:function(b,d){"success"!==
d?(l.showLoader("error"),alert(themifyBuilder.i18n.errorSaveBuilder)):(b=b.responseJSON,k.isFunction(a)&&a.call(e,b),l.showLoader("hide"),c.editing=!0,u.body.triggerHandler("themify_builder_save_data",[b]))}})}).fail(function(){l.showLoader("error")})},saveCss(a,b,d){return k.ajax({type:"POST",url:themifyBuilder.ajaxurl,cache:!1,data:{css:JSON.stringify(c.GS.createCss(a,a[0]&&a[0].mod_name||null,!0)),action:"tb_save_css",custom_css:b,tb_load_nonce:themifyBuilder.tb_load_nonce,id:d}})},loadContentJs(a,
b){"module"===b&&"visual"===c.mode&&u.fontAwesome(a);u.reRun(a,b)},createClearBtn(a){a.siblings(".tb_clear_btn tf_close").click(function(){k(this).hide();a.val("").trigger("keyup")})},toRGBA(a){return ThemifyStyles.toRGBA(a)},getColor(a){let b=a.value;""!==b&&(null!==a.getAttribute("data-minicolors-initialized")?b=k(a).minicolors("rgbaString"):(a=a.getAttribute("data-opacity"),""!==a&&null!==a&&"1"!=a&&"0.99"!=a&&(b=this.toRGBA(b+"_"+a))));return b},getIcon(a,b){if("undefined"!==typeof themifyBuilder.fontello_prefix&&
(new RegExp(themifyBuilder.fontello_use_suffix?themifyBuilder.fontello_prefix+"$":"^"+themifyBuilder.fontello_prefix)).test(a))return b=m.createElement("i"),b.setAttribute("class",a),b;a="tf-"+a.trim().replace(" ","-");const c=m.createElementNS("http://www.w3.org/2000/svg","use"),e=m.createElementNS("http://www.w3.org/2000/svg","svg");let f="tf_fa "+a;b&&(f+=" "+b);e.setAttribute("class",f);c.setAttributeNS(null,"href","#"+a);e.appendChild(c);return e},getBPWidth(a){a=Array.isArray(themifyBuilder.breakpoints[a])?
themifyBuilder.breakpoints[a]:themifyBuilder.breakpoints[a].toString().split("-");return a[a.length-1]},generateUniqueID(){return(Math.random().toString(36).substr(2,4)+(new Date).getUTCMilliseconds().toString()).substr(0,7)},scrollTo(a){("desktop"===c.activeBreakPoint?k("html,body"):k("body",r.document)).scrollTop(a)},scrollToDropped(a,b){a||(a=c.Instances.Builder[c.builderIndex].el.getElementsByClassName("tb_element_cid_"+b)[0]);if(a)if("visual"===c.mode)this.scrollTo(k(a).offset().top-120);else if(b=
m.getElementsByClassName("edit-post-layout__content")[0],void 0!==b){if(a.classList.contains("module_row"))a=a.offsetTop;else{let b=a.closest(".module_row");null!==b?(b=k(b),a=b.offset().top+200-b.offsetParent().offset().top):a=a.offsetTop}k(b).scrollTop(a)}},addViewPortClass(a){a.style.transition="none";this.removeViewPortClass(a);let b=this.isInViewport(a);if(!1!==b){b=b.split(" ");for(let c=b.length-1;-1<c;--c)""!==b[c]&&a.classList.add(b[c])}a.style.transition=""},removeViewPortClass(a){const b=
["top","left","bottom","right"];for(let c=4;-1<c;--c)a.classList.remove("tb_touch_"+b[c])},isInViewport(a){a=a.getBoundingClientRect();let b="";0>a.left?b="tb_touch_left":a.right-1>=m.documentElement.clientWidth&&(b="tb_touch_right");if(0>a.top)b+=" tb_touch_top";else if(a.bottom+1>=m.documentElement.clientHeight||z.innerHeight+z.scrollY>=m.body.offsetHeight&&a.bottom+20>=m.documentElement.clientHeight)b+=" tb_touch_bottom";return""===b?!1:b},canvas:null,ctx:null,cache_images:{},resizeImage(a,b,d,
e){"0"===b&&(b="");if(!b&&!d)return new Promise((c,e)=>{"string"!==typeof a&&(a.style.visibility=a.style.display="");c([a,b,d,b,d])});null===this.canvas&&(this.canvas=m.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.ctx.imageSmoothingQuality="high",this.ctx.imageSmoothingEnabled=!0);const f=this;return new Promise((h,g)=>{let k=m.createElement("span");const l=function(a){let c=a.getAttribute("data-orig");const n=function(){b?(a.setAttribute("width",b),a.style.width&&(a.style.width=
b+"px")):a.removeAttribute("width");d?(a.setAttribute("height",d),a.style.height&&(a.style.height=d+"px")):a.removeAttribute("height")},l=function(){b&&(b=parseInt(b));d&&(d=parseInt(d));var g=e.naturalWidth,l=e.naturalHeight,p=g/l,q=b,m=d;q||(q=b=parseInt(m*p));m||(m=d=parseInt(q/p));var t=q/g,v=m/l;p=a.currentSrc;t=t>v?t:v;q=q/t+.5>>0;m=m/t+.5>>0;g=(g-q)/2>>0;l=(l-m)/2>>0;t=a.getAttribute("srcset");v=a.getAttribute("data-ext");v||a.hasAttribute("data-ext")||(v=p.slice((p.lastIndexOf(".")-1>>>0)+
2),"jpg"===v&&(v="jpeg"),v="image/"+v,a.setAttribute("data-ext",v));f.canvas.width=q;f.canvas.height=m;f.ctx.drawImage(e,g,l,q,m,0,0,q,m);t&&-1!==t.indexOf(p)?a.setAttribute("srcset",t.replaceAll(p,f.canvas.toDataURL(v,1))):a.setAttribute("src",f.canvas.toDataURL(v,1));n();k&&k.remove();a.style.visibility=a.style.display="";k=c=null;h([a,b,d,q,m])};if(!c){c=a.getAttribute("src").trim();if(0!==c.indexOf(themifyBuilder.upload_url)||a.closest("[data-hasEditor]")){k&&k.remove();a.style.visibility=a.style.display=
"";n();k=c=null;h([a,b,d,b,d]);return}{var p=a.getAttribute("width");const b=a.getAttribute("height");p&&b&&(p="-"+p+"x"+b,-1!==c.indexOf(p)&&(c=c.replace(p,"")));a.dataset.orig=c}}if(e)l();else{const h=u.hash(c+b+d);void 0!==f.cache_images[h]?(e=f.cache_images[h],l(),e=null):(e=new Image,e.src=c,e.crossOrigin="anonymous",e.decode().then(function(){l();f.cache_images[h]=e}).catch(b=>{k&&k.remove();a.style.visibility=a.style.display="";console.log(b);g()}))}};if("string"===typeof a){let b=0;const d=
setInterval(function(){++b;8<b&&clearInterval(d);const e=c.Instances.Builder[c.builderIndex].el.querySelector(a);if(null!==e){clearInterval(d);k.className="tf_loader tf_loader_center";const a=e.closest(".active_module");a?a.prepend(k):e.after(k);l(e)}},8)}else{if(!e){k.className="tf_loader tf_loader_center";const b=a.closest(".active_module");b?b.prepend(k):a.after(k)}l(a)}})},hideOnClick(a){void 0!==a[0]&&(a=a[0]);if(a.classList.contains("tb_ui_dropdown_items")||a.classList.contains("tb_down"))a.classList.add("tb_hide_option"),
a.previousElementSibling.blur(),setTimeout(function(){a.classList.remove("tb_hide_option");a=null},500)},calculateHeight(){"visual"===c.mode&&"desktop"!==c.activeBreakPoint&&(r.document.body.style.height=m.body.scrollHeight+"px")},changeOptions(a,b){const d="INPUT"===a.tagName&&"hide_anchor"!==b?"keyup":"change",e=this;"keyup"===d&&a.setAttribute("data-prev",a.value);e.custom_css_id=function(a,b,c,d){a=m.getElementById(d);return null===a||c[0].getAttribute("id")===d||null===a.closest(".module_row")?
(c[0].setAttribute("id",d),!0):!1};e.row_anchor=function(a,b,d,e){"visual"===c.mode&&(d.removeClass(c.liveStylingInstance.getRowAnchorClass(a.getAttribute("data-prev"))),""!==e&&d.addClass(c.liveStylingInstance.getRowAnchorClass(e)),d.data("anchor",e).attr("data-anchor",e));c.hasChanged=!0;d.find(".tb_row_anchor").first().text(e.replace("#",""));return!0};e.custom_css=function(a,b,d,e){"visual"===c.mode&&d.removeClass(a.getAttribute("data-prev")).addClass(e);return!0};e.layout=function(a,b,d,e){"visual"===
c.mode&&c.liveStylingInstance.bindRowWidthHeight(b,e,d);return!0};e.hide_anchor=function(a,b,d,e){"visual"===c.mode&&"1"===e&&d.data("hideAnchor",e).attr("data-hide-anchor",e);return c.hasChanged=!0};a.addEventListener(d,function(a){let f;var g=null!==c.activeModel&&c.ActionBar.cid===c.activeModel.cid;let n=!l.Lightbox.$lightbox[0].contains(this),p="hide_anchor"!==b?this.id:"hide_anchor",q="custom_css_id"===p,w=!0!==q||!1!==n&&!0!==g?void 0:l.Lightbox.$lightbox[0].getElementsByClassName("builder_save_button")[0],
t;t=!0===n&&!1===g?k(".tb_element_cid_"+c.ActionBar.cid):"visual"===c.mode?c.liveStylingInstance.$liveStyledElmt:k(".tb_element_cid_"+c.activeModel.cid);const v=!1===g&&!0===n?l.clone(t[0]):null;f=this.value;"keyup"===d&&"custom_css"!==b?((f=f.trim())&&(f=f.replace(/[^a-zA-Z0-9\-_]+/gi,"")),this.value=f):"layout"===b?f=a.detail.val:"hide_anchor"===b&&(f=this.checked?"1":"0");if(e[b].call(e,this,p,t,f)){q&&(k(this).next(".tb_field_error_msg").remove(),void 0!==w&&w.classList.remove("tb_disable_save"));
if(!0===n){const a=function(){let b=f;"keyup"===d&&(this.removeEventListener("change",a,{passive:!0,once:!0}),this.removeAttribute("data-isInit"),b=this.value.trim());let e=t.data("cid"),g=c.Models.Registry.lookup(e),h=k.extend(!0,{},g.get("styling"));h||(h={});const n=k.extend(!0,{},h);h[p]=b;g.set({styling:h},{silent:!0});null!==v&&c.undoManager.push(e,v,t,"save",{bsettings:n,asettings:k.extend(!0,{},h)})};"keyup"===d?this.getAttribute("data-isInit")||(this.setAttribute("data-isInit",1),this.addEventListener("change",
a,{passive:!0,once:!0})):a()}c.hasChanged=!0}else q&&(a=m.createElement("span"),a.className="tb_field_error_msg",a.textContent=ThemifyConstructor.label.errorId,this.parentNode.insertBefore(a,this.nextSibling),void 0!==w&&w.classList.add("tb_disable_save"));!0===g&&(g=n?l.Lightbox.$lightbox.find("#"+p):k("#"+c.ActionBar.el.id).find("#"+p),"keyup"===d?g.val(f).attr("data-prev",f):"layout"===b?(g.find(".selected").removeClass("selected"),""!==f?g.find("#"+f).addClass("selected"):g.children().first().addClass("selected")):
"hide_anchor"===b&&(g.find("INPUT")[0].checked=this.checked));"keyup"===d&&this.setAttribute("data-prev",f)},{passive:!0})},visibilityLabel(a,b){var d=b.cid;if(null!==c.activeModel&&d===c.activeModel.cid){var e=c.Forms.serialize("tb_options_visibility");0===Object.keys(e).length&&(e=void 0)}void 0===e&&(e="module"!==b.get("elType")?b.get("styling"):b.get("mod_settings"));if(e&&(b="",a=a.classList.contains("tb_visibility_hint")?a:a.getElementsByClassName("tb_visibility_hint")[0],d={visibility_desktop:themifyBuilder.i18n.de,
visibility_mobile:themifyBuilder.i18n.mo,visibility_tablet:themifyBuilder.i18n.ta,visibility_tablet_landscape:themifyBuilder.i18n.ta_l,sticky_visibility:themifyBuilder.i18n.s_v},void 0!==a)){if("hide_all"===e.visibility_all)b=themifyBuilder.i18n.h_a;else{let a;for(let c in d)a=""===b?"":", ",b+="hide"===e[c]?a+d[c]:""}""!==b?(e=a.getElementsByTagName("span")[0],void 0===e&&(e=m.createElement("span"),a.appendChild(e)),e.textContent=b,a.classList.add("tb_has_visiblity")):a.classList.remove("tb_has_visiblity")}}};
c.ActionBar={cid:null,topH:null,type:null,disable:null,prevExpand:null,needClear:!0,el:null,breadCrumbs:null,breadCrumbsPath:{lightbox:null,rightClick:null},disablePosition:null,isInit:null,isHoverMode:!0,darkMode:null,hoverCid:null,contextMenu:null,contextMenuAnimate:null,init(){if(null===this.isInit&&!0!==c.GS.isGSPage){this.isInit=!0;this.el=m.createElement("div");this.breadCrumbs=m.createElement("ul");this.el.id="tb_component_bar";this.breadCrumbs.className="tb_action_breadcrumb";this.el.addEventListener("mousedown",
this.mouseDown.bind(this));this.topH=c.toolbar.$el.height();"visual"===c.mode?m.body.appendChild(this.el):c.Instances.Builder[c.builderIndex].el.parentNode.appendChild(this.el);m.addEventListener("click",this.click.bind(this));m.addEventListener("dblclick",this.click.bind(this));c.Instances.Builder[0].el.addEventListener("mouseover",this.enter);k(c.Instances.Builder[0].el).on("mouseenter",".tb_action_wrap",function(){const a=this.closest(".active_module");a&&a.classList.add("active_action_bar")}).on("mouseleave",
".tb_action_wrap",function(){const a=this.closest(".active_module");a&&a.classList.remove("active_action_bar")});"visual"===c.mode&&r.document.addEventListener("click",this.click.bind(this));var a="visual"===c.mode?null:m.getElementById("tb_canvas_block");null===a?(m.addEventListener("keydown",this.actions.bind(this),{passive:!0}),r.document.addEventListener("keydown",this.actions.bind(this),{passive:!0})):a.addEventListener("keydown",this.actions.bind(this),{passive:!0});this.changeMode();this.initRightClick(!0)}},
changeMode(){this.hoverCid=null;const a=m.body.classList;!0===this.isHoverMode?(a.remove("tb_click_mode"),a.add("tb_hover_mode"),this.el.removeEventListener("click",this.actions)):(a.remove("tb_hover_mode"),a.add("tb_click_mode"),this.el.addEventListener("click",this.actions))},changeDarkMode(){var a=m.getElementById("darkmode-ui"),b="visual"===c.mode?r.document.getElementById("darkmode-ui"):null;!0===this.darkMode?a?(a.disabled=!1,b&&(b.disabled=!1)):(a=r.document.createElement("link"),b=m.getElementById("visual"!==
c.mode?"themify-builder-admin-ui-css":"themify-builder-inline-editor-css"),a.rel="stylesheet",a.href=themifyBuilder.builder_url+"/css/editor/darkmode-ui.css",a.id="darkmode-ui",b.parentNode.insertBefore(a,b.nextSibling),"visual"===c.mode&&r.document.head.appendChild(a.cloneNode())):(a.disabled=!0,b&&(b.disabled=!0))},initRightClick(a){localStorage.getItem("tb_right_click")?!0===a?c.toolbar.el.getElementsByClassName("tb_right_click_mode")[0].checked=!1:(c.Instances.Builder[0].el.removeEventListener("contextmenu",
this.rightClick),this.contextMenu=this.contextMenuAnimate=null):(c.Instances.Builder[0].el.addEventListener("contextmenu",this.rightClick),c.ActionBar.el.removeEventListener("contextmenu",this.rightClick),!0!==this.isHoverMode&&c.ActionBar.el.addEventListener("contextmenu",this.rightClick))},enter(a){const b=c.ActionBar;if(null===b.disable&&(c.Mixins.Builder.columnHover(a.target),!0===b.isHoverMode&&null===b.disablePosition)){"click"===a.type&&a.preventDefault();a.stopPropagation();var d=a.target;
let g=null;var e=d.classList;if(null!==b.prevExpand&&void 0!==b.prevExpand){var f=d.closest(".active_module");if(b.prevExpand.contains(d)){if(e.contains("tb_inner_action_more")||e.contains("tb_action_more")){var h=d.getElementsByTagName("ul")[0];void 0!==h&&c.Utils.addViewPortClass(h)}h=b.prevExpand.getElementsByClassName("tb_row_settings")[0];if(void 0!==h){f=m.getElementById(h.getAttribute("data-href"));if(f.contains(d))return;f.classList.remove("selected");h.classList.remove("selected")}if("module"===
b.type||"column"===b.type){"column"===b.type&&(b.hoverCid=d.parentNode.getAttribute("data-cid"));return}}else{h="module"!==b.type;if(!1===h)"visual"!==c.mode?(h=f,h=null!==h?h.getAttribute("data-cid")!==b.hoverCid:!0):(f=d.closest(".tb_dragger_top"),null!==f&&f.classList.contains("tb_dragger_padding")&&c.EdgeDrag.setModulePosition(f));else if(e.contains("tb_clicked"))return;!0===h&&b.clear()}}if(null===d.closest(".tb_dragger_lightbox")){if(e.contains("tb_action_wrap"))g=!e.contains("tb_clicked");
else{if("LI"===d.nodeName&&e.contains("tb_row_settings")&&!e.contains("selected")){b.actions(a);return}if(!e.contains("tb_grid_drag")){d=d.closest("[data-cid]");if(!d)return;e=d.getAttribute("data-cid");if(b.hoverCid===e)return;b.hoverCid=e;h=c.Models.Registry.lookup(e);e=h.get("elType");if("module"===e)g=!0;else if("visual"===c.mode){b.clear();c.EdgeDrag.addEdges(e,h,d);return}}}!0===g&&b.click(a)}}},rightClickGS(a,b,d){this.disable=!0;null!==c.activeModel&&k(".builder_save_button",ThemifyBuilderCommon.Lightbox.$lightbox).click();
const e=c.Instances.Builder[c.builderIndex].el.getElementsByClassName("tb_element_clicked"),f=c.GS.key;b=b.split(" ");for(let g=e.length-1,n=b.length;-1<g;--g){let p=c.Models.Registry.lookup(e[g].getAttribute("data-cid")),m=l.clone(e[g]),w="module"===p.get("elType")?"mod_settings":"styling",t=k.extend(!0,{},p.get(w)),v=k.extend(!0,{},t);c.activeModel=p;if(t[f])if(!0===d)a&&-1!==t[f].indexOf(a)&&(t[f]=t[f].split(" "),t[f].splice(t[f].indexOf(a),1),t[f]=t[f].join(" "));else for(var h=0;h<n;++h)-1===
t[f].indexOf(b[h])&&(t[f]+=" "+b[h]);else{if(0===n)continue;t[f]=b.join(" ")}h={};h[w]=t;p.set(h,{silent:!0});c.GS.generateValues(a,t[f].split(" "),d);c.undoManager.push(p.cid,m,k(e[g]),"save",{bsettings:v,asettings:t})}this.disable=null;c.activeModel=null},rightClick(a,b){a.stopImmediatePropagation();const d=c.ActionBar;if(!(null!==d.contextMenuAnimate||"visual"===c.mode&&m.activeElement.contentEditable&&c.liveStylingInstance.$liveStyledElmt&&c.liveStylingInstance.$liveStyledElmt[0].contains(m.activeElement))){d.contextMenuAnimate=
!0;if(null===d.contextMenu){const a=function(a){a.stopPropagation();"click"===a.type&&null===a.target.closest(".tb_visibility_wrap")&&a.preventDefault();if("LI"===a.target.nodeName||a.target.classList.contains("toggle_switch")){var b="LI"===a.target.nodeName?a.target.getAttribute("data-action"):"visibility";if(b){d.disable=!0;d.hoverCid=null;if("undo"===b||"redo"===b)if(a="undo"===b?c.undoManager.btnUndo:c.undoManager.btnRedo,"undo"===b&&c.undoManager.hasUndo()||"redo"===b&&c.undoManager.hasRedo())k(a).triggerHandler("click"),
d.disable=null;else{d.disable=null;return}else{var e=this.classList.contains("tb_multiply_selected");let p,m,q,t,w,r,v,u=c.Instances.Builder[c.builderIndex].el.getElementsByClassName("tb_element_clicked"),x=void 0;"gs_in"!==b&&"move"!==b&&(!0!==e||"delete"!==b&&"paste"!==b||(x=!0),k(".builder_save_button",ThemifyBuilderCommon.Lightbox.$lightbox).click());if("reset"===b)p=c.activeModel,m=k.extend(!0,{},ThemifyConstructor.values),q=ThemifyConstructor.component,t=ThemifyConstructor.beforeData,w=!0===
c.hasChanged,r="visual"===c.mode?c.liveStylingInstance.prefix:null,v="visual"===c.mode?c.liveStylingInstance.$liveStyledElmt:null;else{if("move"===b){d.disable=null;return}if("gs_in"===b){if(!1===e){b=c.Models.Registry.lookup(u[0].dataset.cid);var f=k.extend(!0,{},ThemifyConstructor.values);ThemifyConstructor.values="module"===b.get("elType")?b.get("mod_settings"):b.get("styling")}if(b=c.GS.globalStylesHTML())a=d.contextMenu.querySelector("#tb_inline_gs"),a.innerHTML="",a.appendChild(b),a.getElementsByClassName("tb_gs_icon")[0].click(),
a.querySelector('[data-action="insert"]').click(),a.classList.add("tb_inline_gs_show"),c.Utils.addViewPortClass(d.contextMenu);!1===e&&(ThemifyConstructor.values=f);d.disable=null;return}}for(e=u.length-1;-1<e;--e){f=u[e].getAttribute("data-cid");let d=c.Models.Registry.lookup(f);var g=d.get("elType"),h="module"===g?d.get("mod_settings"):d.get("styling");if("reset"===b||"gs_r"===b){if("gs_r"===b&&void 0===h[c.GS.key])continue;if(null!==c.activeModel&&c.activeModel.cid===f){var n=ThemifyBuilderCommon.Lightbox.$lightbox.find(".reset-styling")[0];
if(void 0!==n){n.click();continue}}n=l.clone(u[e]);let m;c.activeModel=d;"reset"===b&&(ThemifyConstructor.component=g,ThemifyConstructor.values=h);let q="module"===g?"mod_setting":"styling";"visual"===c.mode&&(c.liveStylingInstance.$liveStyledElmt?c.liveStylingInstance.prefix=ThemifyStyles.getBaseSelector("module"===g?c.activeModel.get("mod_name"):g,c.activeModel.get("element_id")):c.liveStylingInstance.init(!0),c.liveStylingInstance.$liveStyledElmt=k(u[e]));g=k.extend(!0,{},h);"reset"===b?(h=ThemifyConstructor.resetStyling(a,
null!==p&&p.cid!==f),"visual"===c.mode&&(m=k.extend(!0,{},h)),h=k.extend(!0,{},ThemifyConstructor.values)):(delete h[c.GS.key],c.GS.generateValues(null,[],!0));let t={};t[q]=h;d.set(t,{silent:!0});c.hasChanged=!0;c.undoManager.push(f,n,k(u[e]),"save",{bsettings:g,asettings:h,styles:m});m=null}else("delete"!==b&&"visibility"!==b||"column"!==g)&&d.trigger(b,a,a.target,x)}"reset"===b?(c.hasChanged=w,c.activeModel=p,ThemifyConstructor.values=m,ThemifyConstructor.component=q,ThemifyConstructor.beforeData=
t,"visual"===c.mode&&(c.liveStylingInstance.$liveStyledElmt=v,c.liveStylingInstance.prefix=r)):"edit"!==b&&(c.activeModel=null);d.disable=null}"visibility"!==b&&d.hideContextMenu()}}},b=function(a){a.stopPropagation();a.target.classList.contains("tb_inner_action_more")&&(a=a.target.getElementsByTagName("ul")[0])&&c.Utils.addViewPortClass(a)};d.contextMenu=m.getElementById("tb_right_click");null===d.contextMenu&&(d.contextMenu=m.getElementById("tmpl-builder_right_click").content,m.body.appendChild(d.contextMenu),
d.contextMenu=m.getElementById("tb_right_click"),d.contextMenu.addEventListener("click",a),d.contextMenu.addEventListener("mouseover",b,{passive:!0}),d.contextMenu.getElementsByClassName("tb_r_name")[0].addEventListener("mousedown",function(a){1===a.which&&!d.contextMenu.classList.contains("tb_multiply_selected")&&!d.contextMenu.classList.contains("tb_component_column")&&(a.preventDefault(),a.stopPropagation(),a=c.Instances.Builder[c.builderIndex].el.getElementsByClassName("tb_element_clicked")[0])&&
(d.hideContextMenu(),d.cid=a.dataset.cid,d.moveComponent())}))}var e=!0;!0!==d.isHoverMode&&null!==d.cid?b=c.Instances.Builder[c.builderIndex].el.querySelector('[data-cid="'+d.cid+'"]'):b?e=!1:b=k(a.target).closest("[data-cid]")[0];if(void 0===b)d.contextMenuAnimate=null;else{a.preventDefault();d.hideContextMenu(a.target.classList.contains("tb_bread"));d.disablePosition=!0;m.body.classList.add("tb_right_click_open");d.contextMenu.className="tb_show_context";var f=a.pageX,h=a.pageY,g=c.Models.Registry.lookup(b.dataset.cid),
n=g.get("elType"),p=function(k){if("transform"===k.propertyName){var l=c.Instances.Builder[c.builderIndex].el,m=this.getElementsByClassName("tb_r_name")[0],q=this.getElementsByClassName("tb_action_breadcrumb")[0],r=function(a){a.preventDefault();a.stopPropagation();var b=a.target.getAttribute("data-id");b&&(this.removeEventListener("click",r),d.hideContextMenu(!0),b=c.Instances.Builder[c.builderIndex].el.getElementsByClassName("tb_element_cid_"+b)[0],void 0!==b&&d.rightClick(a,b))};this.removeEventListener("transitionend",
p,{passive:!0});this.className="tb_component_"+n;"module"===n&&(this.className+=" tb_module_"+g.get("mod_name"));q.innerHTML="";if(!0===a.ctrlKey||!0===a.metaKey)b.classList.add("tb_element_clicked");else if(!b.classList.contains("tb_element_clicked")){k=l.getElementsByClassName("tb_element_clicked");for(let a=k.length-1;-1<a;--a)k[a].classList.remove("tb_element_clicked");b.classList.add("tb_element_clicked")}k=l.getElementsByClassName("tb_element_clicked").length;1<k?(this.className+=" tb_multiply_selected",
m.textContent=themifyBuilder.i18n.multiSelected):(d.breadCrumbsPath.rightClick=d.getBreadCrumbPath(c.Instances.Builder[0].el.getElementsByClassName("tb_element_cid_"+(null===d.breadCrumbsPath.rightClick?g.cid:d.breadCrumbsPath.rightClick[d.breadCrumbsPath.rightClick.length-1]))[0],"rightClick"),q.appendChild(d.getBreadCrumbs(b,"rightClick")),m.textContent="module"===n?themifyBuilder.modules[g.get("mod_name")].name:n);q.addEventListener("click",r);var u=function(a){"transform"===a.propertyName?(this.removeEventListener("transitionend",
u,{passive:!0}),c.Utils.addViewPortClass(this),d.contextMenuAnimate=null):(this.style.top=h+"px",!0===e&&(this.style.left=f+"px"))};this.addEventListener("transitionend",u,{passive:!0});c.undoManager.hasUndo()||(this.className+=" tb_undo_disabled");"column"===n&&(this.className+=" tb_visibility_disabled");c.undoManager.hasRedo()||(this.className+=" tb_redo_disabled");this.className+=" tb_show_context"}};d.contextMenu.addEventListener("transitionend",p,{passive:!0});setTimeout(function(){d.contextMenu.className=
""},18)}}},hideContextMenu(a){null!==this.contextMenu&&(this.contextMenu.style.top="",this.contextMenu.querySelector("#tb_inline_gs").classList.remove("tb_inline_gs_show"),m.body.classList.remove("tb_right_click_open"),this.disablePosition=this.hoverCid=null,!0!==a&&(c.ActionBar.breadCrumbsPath.rightClick=null))},mouseDown(a){1!==a.which||"row"!==this.type&&"subrow"!==this.type||!a.target.classList.contains("tb_move")||(a.preventDefault(),a.stopPropagation(),this.moveComponent())},moveComponent(){var a=
c.Instances.Builder[c.builderIndex].el.getElementsByClassName("tb_element_cid_"+this.cid)[0];if(void 0!==a){let b=a.classList.contains("module_row")?a.getElementsByClassName("tb_row_action")[0]:a;a=k(a).offset();let c;this.clear();"function"===typeof Event?c=new Event("mousedown",{bubbles:!0,cancelable:!1}):(c=m.createEvent("Event"),c.initEvent("mousedown",!0,!1));c.pageX=a.left;c.pageY=a.top;c.which=1;b.dispatchEvent(c)}},click(a){if(c.isPreview||!0===this.disable)return!0;var b=a.target,d=b.tagName,
e=null,f=c.Instances.Builder[c.builderIndex].lastRow,h="visual"===c.mode&&b.ownerDocument===r.document?void 0:k(b).closest("[data-cid]")[0],g=a.type;if("click"===g){var n=l.Lightbox.$lightbox[0];this.hideContextMenu();e=!0===a.ctrlKey||!0===a.metaKey;if(r.document.body.classList.contains("tb_standalone_lightbox")&&!r.document.body.classList.contains("modal-open")){c.toolbar.el.contains(b)||n.contains(b)||n.classList.contains("tb_predesigned_lightbox")||n.classList.contains("tb_custom_css_lightbox")||
l.Lightbox.close();var p=r.document.getElementsByClassName("tb_current_menu_selected")[0];void 0!==p&&p.classList.remove("tb_current_menu_selected")}f&&!f.contains(b)&&f.classList.remove("expanded");if(!n.contains(b)&&(!1===e&&this.clearClicked(),void 0!==h)){if(!0===e&&h.classList.contains("tb_element_clicked")){h.classList.remove("tb_element_clicked");return}h.classList.add("tb_element_clicked")}}else if("dblclick"===g&&null!==c.Forms.LayoutPart.id&&b.classList.contains("tb_overlay")){c.Forms.LayoutPart.save(a,
!0);return}f=("click"===g||"dblclick"===g)&&"visual"===c.mode&&l.Lightbox.dockMode.get();if(void 0===h||h.classList.contains("tb_active_layout_part"))"LI"===d&&b.classList.contains("tb_bread")?(a=c.Models.Registry.lookup(b.getAttribute("data-id")),"setting"!==ThemifyConstructor.clicked&&"module"===ThemifyConstructor.component&&(b=l.Lightbox.$lightbox[0].getElementsByClassName("tb_lightbox_top_bar")[0].querySelector(".current a").getAttribute("href"),l.Lightbox.$lightbox.off("themify_opened_lightbox.tb_breadCrumbs").on("themify_opened_lightbox.tb_breadCrumbs",
function(){"row"===ThemifyConstructor.component?l.Lightbox.$lightbox.off("themify_opened_lightbox.tb_breadCrumbs")[0].getElementsByClassName("tb_lightbox_top_bar")[0].querySelector('a[href="'+this+'"]').click():null===c.activeModel&&l.Lightbox.$lightbox.off("themify_opened_lightbox.tb_breadCrumbs")}.bind(b))),this.breadCrumbsPath.lightbox=this.getBreadCrumbPath(c.Instances.Builder[0].el.getElementsByClassName("tb_element_cid_"+(null===this.breadCrumbsPath.lightbox?c.activeModel.cid:this.breadCrumbsPath.lightbox[this.breadCrumbsPath.lightbox.length-
1]))[0]),a.trigger("edit","breadcrumb")):this.el.contains(b)||"click"===a.type&&b.classList.contains("tb_dragger")||this.clear();else{"visual"!==c.mode||"A"!==d&&null===b.closest("a")||a.preventDefault();var q=h.getAttribute("data-cid");n=c.Models.Registry.lookup(q);p=n.get("elType");const k="row"===p&&h.classList.contains("tb-page-break");if(n){if("dblclick"===g){if((!0===f||"INPUT"===d||!0===k||b.classList.contains("tb_dragger_lightbox")||null!==b.closest(".tb_clicked"))&&"tb_row_options"!==b.id)return;
a.preventDefault();a.stopPropagation();!1===f&&!0!==this.isHoverMode?(h.classList.add("tb_element_clicked"),u.body[0].classList.add("tb_action_active"),"visual"===c.mode&&c.EdgeDrag.addEdges("module"===p?n.get("mod_name"):p,n,h)):h.classList.remove("tb_element_clicked");if(!b.classList.contains("tb_row_settings")){this.hoverCid=null;n.trigger("edit",a,b);return}}else if("click"===g&&!1===f&&(b.classList.contains("tb_dragger")||null!==b.closest(".tb_dragger_options")))return;d=!0===this.isHoverMode;
const l=!0!==d&&null!==this.cid,w="module"!==p?b.classList.contains("tb_action_wrap"):!0===d;this.cid=q;this.type=p;if(!0===k&&"row"===p)this.clear(),b.classList.contains("tb_row_anchor")&&(a.preventDefault(),a.stopPropagation(),n.trigger("delete",a,b));else if((!1===w||"module"===p&&!0===d)&&null!==b.closest(".tb_action_wrap"))"click"===g&&this.actions(a);else if(!0===d&&"click"===g&&!0===this.needClear)!0===f&&!1===e&&n.trigger("edit",a,b);else if(this.clear(),!0===l&&"click"===g&&!1===e&&!1===
f&&!0===this.needClear){u.body[0].classList.add("tb_action_active");const a=this,b=function(){this.removeEventListener("mousemove",b,{passive:!0,once:!0});null===a.cid&&(u.body[0].classList.remove("tb_action_active"),a.clearClicked())};m.addEventListener("mousemove",b,{passive:!0,once:!0})}else{this.cid=q;this.type=p;g=m.getElementById("tmpl-builder_"+p+"_action").content.cloneNode(!0);if(!0===w){this.prevExpand="module"===p?h.getElementsByClassName("tb_module_action")[0]:b;if(void 0===this.prevExpand){this.clear();
return}this.prevExpand.appendChild(g);this.prevExpand.setAttribute("id",this.el.id);this.prevExpand.closest(".tb_action_wrap").classList.add("tb_clicked");!0===d&&"module"===p&&(e=h.getBoundingClientRect(),g=this.prevExpand.classList,70>e.height||200>e.width?(g.add("tb_small_action_bar"),g.remove("tb_small_action_bar_top","tb_small_action_bar_bottom"),q=this.prevExpand.getBoundingClientRect().top,40>q||40>q-c.Instances.Builder[c.builderIndex].el.getBoundingClientRect().top?g.add("tb_small_action_bar_top"):
g.add("tb_small_action_bar_bottom"),g.toggle("tb_small_action_bar_height",70>e.height),g.toggle("tb_small_action_bar_width",200>e.width)):g.remove("tb_small_action_bar"),"visual"===c.mode&&c.EdgeDrag.addEdges(n.get("mod_name"),n,h))}else("row"!==p||"row"===p&&null!==this.breadCrumbsPath.lightbox)&&this.setBreadCrumbs(h),this.el.className="tb_show_toolbar tb_"+p+"_action",e=m.createElement("div"),e.className="tb_action_label_wrap",e.appendChild(g),"visual"===c.mode&&("module"===p?(g=n.get("mod_name"),
this.el.className+=" tb_"+g+"_action",g=themifyBuilder.modules[g].name):(g=p,"row"===p&&(q=n.get("styling").row_anchor,void 0!==q&&(q=q.trim(),""!==q&&(g+=" #"+q)))),q=m.createElement("div"),q.className="tb_data_mod_name",q.textContent=g.charAt(0).toUpperCase()+g.slice(1),e.appendChild(q)),this.el.appendChild(e);!0!==d&&(h.classList.add("tb_element_clicked"),u.body[0].classList.add("tb_action_active"),"visual"===c.mode&&c.EdgeDrag.addEdges("module"===p?n.get("mod_name"):p,n,h));if(!0===f&&(n.trigger("edit",
a,b),!0===d||null!==this.disablePosition&&!1!==w&&!0===d))return;null===this.disablePosition&&(!1===w&&!0!==d?(b=a.pageX,h=a.pageY,"visual"!==c.mode&&(h=c.Instances.Builder[0].el.getBoundingClientRect(),b=a.clientX-h.left,h=a.clientY-h.top+30),this.setPosition(this.el,{left:b,top:h})):c.Utils.addViewPortClass(this.prevExpand))}}else!0!==isHoverMode&&this.clear()}},setBreadCrumbs(a){for(;null!==this.breadCrumbs.firstChild;)this.breadCrumbs.removeChild(this.breadCrumbs.lastChild);this.breadCrumbs.appendChild(this.getBreadCrumbs(a));
null===this.el.firstChild?this.el.appendChild(this.breadCrumbs):this.el.insertBefore(this.breadCrumbs,this.el.firstChild)},getBreadCrumbPath(a,b){b="rightClick"!==b?"lightbox":b;b=null!==this.breadCrumbsPath[b]?this.breadCrumbsPath[b]:[];if(0<b.length)return b;if(void 0!==a){var c=a.getAttribute("data-cid");for(c&&b.push(c);!a.classList.contains("module_row");)a=a.parentNode,(c=a.getAttribute("data-cid"))&&b.push(c)}return b},getBreadCrumbs(a,b){const d=this.getBreadCrumbPath(a,b),e=m.createDocumentFragment();
if(void 0!==a)for(a="rightClick"===b?a.dataset.cid:c.activeModel?c.activeModel.cid:c.ActionBar.cid,b=d.length-1;-1<b;--b){let f=m.createElement("li"),h=c.Models.Registry.lookup(d[b]),g=h.get("elType");f.textContent="column"===g?h.get("component_name"):"module"===g?h.get("mod_name"):g;f.className="tb_bread tb_bread_"+g;a===d[b]&&(f.className+=" tb_active_bc");f.setAttribute("data-id",d[b]);e.appendChild(f)}return e},actions(a){var b=c.ActionBar,d=a.target,e=d.tagName;if("keydown"===a.type){if("INPUT"!==
e&&"TEXTAREA"!==e&&!themifyBuilder.disableShortcuts&&!l.Lightbox.$lightbox[0].contains(d)&&("visual"!==c.mode||!m.activeElement.contentEditable&&c.liveStylingInstance.$liveStyledElmt[0].contains(m.activeElement))){d=a.keyCode;var f=m.getElementsByClassName("tb_element_clicked");e=f.length;if(0<e){"keydown"!==a.type&&(a.preventDefault(),a.stopPropagation());var h=null,g=null,n=void 0,p=!0===a.ctrlKey||!0===a.metaKey;46===d||8===d?h="delete":!0===p&&(67===d?(h="copy",e=1):68===d?h="duplicate":86===
d&&(h="paste",!0===a.shiftKey&&(g="style")));1<e&&("delete"===h||"paste"===h)&&(n=!0,null!==c.activeModel&&l.Lightbox.$lightbox.is(":visible")&&ThemifyConstructor.saveComponent());for(let l=e-1;-1<l;--l){let m=f[l];if(null===h){if(!0===p&&1===e&&(38===d||40===d)){let c=38===a.which?"up":"down";var q="up"===c?m.previousElementSibling:m.nextElementSibling;if(null!==q){if(m.classList.contains("module_row")){if(!q.classList.contains("module_row"))continue}else if(m.classList.contains("active_module")){if(!q.classList.contains("active_module"))continue;
k(m.parentNode.closest(".tb_holder"))}else continue;q&&(q=k(m),"up"===c?q.prev().before(q):q.next().after(q),!0!==b.isHoverMode&&m.classList.add("tb_element_clicked"))}}}else"delete"===h&&m.classList.contains("module_column")||c.Models.Registry.lookup(k(m).closest("[data-cid]")[0].getAttribute("data-cid")).trigger(h,a,g,n)}"delete"!==h&&!0===b.isHoverMode||b.clear()}}}else if(a.stopPropagation(),"click"===a.type&&null!==d.closest(".switch-wrapper"))d.classList.contains("toggle_switch")&&c.Models.Registry.lookup(k(d).closest("[data-cid]")[0].getAttribute("data-cid")).trigger("visibility",
a,d);else if(a.preventDefault(),null===b.cid||"LI"!==e&&"SPAN"!==e&&"A"!==e)d.parentNode.classList.contains("tb_help")&&d.focus();else if(n=(f=d.classList.contains("tb_bread"))?d.getAttribute("data-id"):b.cid,h=c.Models.Registry.lookup(n),g=d.classList,p=null,h)if(u.body[0].classList.remove("tb_component_menu_active"),!0===f)b.needClear=null,b.disablePosition=!0,m.getElementsByClassName("tb_element_cid_"+n)[0].click(),b.disablePosition=null,"visual"===c.mode&&(a=b.el.getBoundingClientRect(),a.right>=
m.body.clientWidth&&b.setPosition(b.el,{left:a.left,top:b.el.offsetTop+55})),b.needClear=!0;else if(f=d.getAttribute("data-href"),!0===b.isHoverMode&&"tb_row_options"===f&&"click"===a.type)h.trigger("edit",a,d);else if(f)for(a=d.parentNode.getElementsByTagName("li"),d=a.length-1;-1<d;--d)h=(e=a[d].getAttribute("data-href"))?m.getElementById(e):null,g=a[d].classList.contains("selected"),a[d].classList.remove("selected"),null!==h&&h.classList.remove("selected"),e!==f||g||("tb_row_options"===e||"tb_rgrids"===
e?b.gridMenu(h):"tb_roptions"===e&&0===h.children.length&&b.setRowOptions(h),h.classList.add("selected"),a[d].classList.add("selected"),c.Utils.addViewPortClass(h),u.body[0].classList.add("tb_component_menu_active"));else{if(g.contains("tb_edit")||g.contains("tb_styling")||g.contains("tb_visibility_component")||g.contains("tb_swap"))p="edit";else if(g.contains("tb_duplicate"))p="duplicate";else if(g.contains("tb_save_component"))p="save";else if(g.contains("tb_delete"))p="delete";else if(g.contains("tb_import")||
g.contains("tb_export"))p="importExport";else if(g.contains("tb_copy_component"))p="copy";else if(g.contains("tb_paste_component")||g.contains("tb_paste_style"))p="paste";else{if("LI"===e||"SPAN"===e||g.contains("tb_action_more")||g.contains("tb_inner_action_more")){a=d.closest("li");if(null===a)return;h=a.parentNode;f=h.classList;e=f.contains("tb_grid_list")||f.contains("tb_column_alignment")||f.contains("tb_column_gutter")||f.contains("tb_column_direction")||f.contains("tb_column_height")||f.contains("grid_tabs");
d=d.classList.contains("selected");h=h.children;if(e&&d)return;for(g=h.length-1;-1<g;--g)if(h[g].classList.remove("selected"),!1===e)for(n=h[g].getElementsByClassName("selected"),p=n.length-1;-1<p;--p)n[p].classList.remove("selected");d||(a.classList.add("selected"),u.body[0].classList.add("tb_component_menu_active"));if(e)f.contains("tb_column_alignment")?b._columnAlignmentClicked(a):f.contains("tb_column_gutter")?b._gutterChange(a):f.contains("tb_column_direction")?b._columnDirectionClicked(a):
f.contains("tb_column_height")?b._columnHeight(a):f.contains("grid_tabs")?b._switchGridTabs(a):f.contains("tb_grid_list")&&b._gridClicked(a);else{h=null!==b.prevExpand?b.prevExpand.children:b.el.getElementsByClassName("tb_action_label_wrap")[0].children;for(f=h.length-1;-1<f;--f)h[f].classList.remove("selected");d||null!==b.prevExpand&&"column"!==b.type||(b=a.getElementsByTagName("ul")[0],void 0!==b&&c.Utils.addViewPortClass(b))}}return}if(!0!==b.isHoverMode)b.clear();else{let a=d.closest(".tb_action_more");
null!==a&&(a=a.getElementsByTagName("ul")[0],a.style.display="none",setTimeout(function(){null!==a&&(a.style.display="")},100))}h.trigger(p,a,d)}},_switchGridTabs(a){c.ActionBar.disable=c.clearOnModeChange=!0;c.ActionBar.hoverCid=null;c.scrollTo=k(".tb_element_cid_"+this.cid);ThemifyConstructor.lightboxSwitch(a.getAttribute("data-id"));"visual"!==c.mode&&this.gridMenu(a.closest(".tb_toolbar_tabs"))},_gridClicked(a){var b=k(a),d=b.data("grid"),e=this.type;let f;var h=k(".tb_element_cid_"+this.cid).first();
let g=!1;var n=c.activeBreakPoint,p="desktop"===n;a=l.clone(h.closest(".module_row"));g="subrow"===e;f=h.find("."+e+"_inner").first();if(p){n=f;let a=b.data("col");n=n.add(k("#tb_rgrids"));void 0===a&&(a=1,b.data("col",a));for(h=6;0<h;--h)n.removeClass("col-count-"+h);n.addClass("col-count-"+a);f.attr("data-basecol",a);p&&b.closest(".tb_grid_menu").find(".tb_grid_reposnive .tb_grid_list").each(function(){let b=k(this).find(".selected"),c=k(this).data("type"),d=b.data("col");void 0!==d&&(d>a||4===
a&&3===d||4<=a&&4<=d&&a!=d)&&(b.removeClass("selected"),f.removeClass("tb_grid_classes col-count-"+f.attr("data-basecol")+" "+f.attr("data-col_"+c)).attr("data-col_"+c,""),k(this).closest(".tb_grid_list").find("."+c+"-auto").addClass("selected"))})}else return"-auto"!==d[0]?(a="column"+d.join("-"),d=b.data("col"),3===d&&f.attr("data-basecol")>d&&(a+=" tb_3col"),f.removeClass(f.attr("data-col_tablet")+" "+f.attr("data-col_tablet_landscape")+" "+f.attr("data-col_mobile")).addClass(a+" tb_grid_classes col-count-"+
f.attr("data-basecol")).attr("data-col_"+n,a)):f.removeClass("tb_grid_classes tb_3col col-count-"+f.attr("data-basecol")+" "+f.attr("data-col_"+n)).attr("data-col_"+n,""),"visual"===c.mode&&(k("body",r.document).height(m.body.scrollHeight),c.Utils.calculateHeight()),c.Utils.setCompactMode(f.children(".module_column")),!1;b=f.children(".module_column");n=d.length;p="module_column"+(g?" sub_column":"")+" col";for(h=0;h<n;++h)e=b.eq(h),0<e.length?e.removeClass(c.Utils.gridClass.join(" ")).addClass(p+
d[h]):c.Utils._addNewColumn({newclass:p+d[h],component:g?"sub-column":"column"},f[0]);n<f.children().length&&f.children(".module_column").eq(n-1).nextAll().each(function(){k(this).find(".tb_holder").first().children().appendTo(k(this).prev().find(".tb_holder").first());k(this).remove()});d=f.children();d.removeClass("first last");f.hasClass("direction-rtl")?(d.last().addClass("first"),d.first().addClass("last")):(d.first().addClass("first"),d.last().addClass("last"));c.hasChanged=!0;h=f.closest(".module_row");
c.Mixins.Builder.columnDrag(null,b);u.body.triggerHandler("tb_grid_changed",[h,f]);c.undoManager.push(h.data("cid"),a,h,"row")},_columnHeight(a){a=k(a).data("value");if(void 0!==a){var b=k(".tb_element_cid_"+this.cid).first(),d=c.Models.Registry.lookup(this.cid),e=l.clone(b);b=b.find("."+this.type+"_inner").first();""===a?b.removeClass("col_auto_height"):b.addClass("col_auto_height");d.set({column_h:a},{silent:!0});c.undoManager.push(this.cid,e,k(".tb_element_cid_"+this.cid).first(),"row")}},_columnAlignmentClicked(a){a=
k(a);if(a=a.data("alignment")){var b=k(".tb_element_cid_"+this.cid).first(),d=c.Models.Registry.lookup(this.cid),e=l.clone(b);b.find("."+this.type+"_inner").first().removeClass(d.get("column_alignment")).addClass(a);d.set({column_alignment:a},{silent:!0});c.undoManager.push(this.cid,e,k(".tb_element_cid_"+this.cid).first(),"row")}},_columnDirectionClicked(a){a=k(a);if(a=a.data("dir")){var b=k(".tb_element_cid_"+this.cid).first().find("."+this.type+"_inner").first(),d=b.children(".module_column"),
e=d.first();d=d.last();var f=c.Models.Registry.lookup(this.cid),h={};h[c.activeBreakPoint+"_dir"]=a;f.set(h,{silent:!0});"rtl"===a?(e.removeClass("first").addClass("last"),d.removeClass("last").addClass("first"),b.addClass("direction-rtl")):(e.removeClass("last").addClass("first"),d.removeClass("first").addClass("last"),b.removeClass("direction-rtl"));b.attr("data-"+c.activeBreakPoint+"_dir",a)}},_gutterChange(a){if(a=k(a).data("value")){var b=k(".tb_element_cid_"+this.cid).first(),d=c.Models.Registry.lookup(this.cid),
e=d.get("gutter"),f=l.clone(b);b=b.find("."+this.type+"_inner").first();c.Mixins.Builder.columnDrag(null,b[0].children,e,a);b.removeClass(e).addClass(a);d.set({gutter:a},{silent:!0});c.undoManager.push(this.cid,f,k(".tb_element_cid_"+this.cid).first(),"row")}},gridMenu(a){var b=c.activeBreakPoint,d="desktop"===b,e=c.Models.Registry.lookup(this.cid),f=e.get(b+"_dir"),h=e.get("column_alignment");const g=e.get("column_h");e=e.get("gutter");var k=(a.closest(".module_"+this.type)||m.getElementsByClassName("tb_element_cid_"+
this.cid)[0]).getElementsByClassName(this.type+"_inner")[0],l=k.children,q=l.length,r=a.getElementsByClassName("tb_grid_"+b)[0];const t="tb_rgrids"===a.id?a:a.querySelector("#tb_rgrids");a=!0===d?void 0:k.getAttribute("data-col_"+b);k=[];for(let a=0;a<q;++a)k.push(c.Utils._getColClass(l[a].className.split(" ")));for(l=6;-1<l;--l)t.classList.remove("col-count-"+l);t.classList.add("col-count-"+q);k=k.join("-");k="grid-layout-"+("2-1-2-1"===k?"4-2-4-2":k);l=r.getElementsByClassName("tb_grid_list")[0].getElementsByTagName("li");
a="-auto"!==a&&a?"grid-layout-"+a.replace(/column|tb_3col/ig,"").trim():!1;!1!==d||!1!==a&&1!==q||(a=b+"-auto");for(b=l.length-1;-1<b;--b)q=!0===d&&l[b].classList.contains(k)||!1===d&&l[b].classList.contains(a),l[b].classList.toggle("selected",q);if("ltr"!==f)for(l=r.getElementsByClassName("tb_column_direction")[0].getElementsByTagName("li"),b=l.length-1;-1<b;--b)l[b].classList.toggle("selected",l[b].getAttribute("data-dir")===f);if(!0===d){if("col_align_top"!==h||!0===M)for(d=r.getElementsByClassName("tb_column_alignment")[0].getElementsByTagName("li"),
f=d.length-1;-1<f;--f)d[f].classList.toggle("selected",d[f].getAttribute("data-alignment")===h);if("gutter-default"!==e)for(h=r.getElementsByClassName("tb_column_gutter")[0].getElementsByTagName("li"),d=h.length-1;-1<d;--d)h[d].classList.toggle("selected",h[d].getAttribute("data-value")===e);if(g)for(e=r.getElementsByClassName("tb_column_height")[0].getElementsByTagName("li"),r=e.length-1;-1<r;--r)e[r].classList.toggle("selected",e[r].getAttribute("data-value")==g)}},setRowOptions(a){var b=null;const d=
c.activeModel,e=ThemifyConstructor.component,f=c.Models.Registry.lookup(this.cid),h=f.get("styling")||{};null!==d&&(b="module"===c.activeModel.get("elType")?"mod_settings":"styling",b=c.activeModel.get(b));if(void 0!==a.children[0])for(;a.firstChild;)a.removeChild(a.lastChild);ThemifyConstructor.values=h;ThemifyConstructor.component=this.type;c.activeModel=f;a.appendChild(ThemifyConstructor.create(ThemifyConstructor.data.row.setting.options.slice(0,6)));ThemifyConstructor.values=b;c.activeModel=d;
ThemifyConstructor.component=e},clear(){if(null!==this.type){this.cid=this.type=null;for(this.el.classList.remove("tb_show_toolbar");null!==this.el.firstChild;)this.el.removeChild(this.el.lastChild);if(null!==this.prevExpand&&void 0!==this.prevExpand){for(;null!==this.prevExpand.firstChild;)this.prevExpand.removeChild(this.prevExpand.lastChild);this.prevExpand.removeAttribute("id");"visual"===c.mode&&(this.prevExpand.style.top="");this.prevExpand.closest(".tb_action_wrap").classList.remove("tb_clicked");
this.prevExpand=null}this.clearSelected();u.body[0].classList.remove("tb_action_active","tb_component_menu_active")}},clearSelected(){"visual"===c.mode&&c.EdgeDrag.clearEdges()},clearClicked(){const a=c.Instances.Builder[0].el.getElementsByClassName("tb_element_clicked");for(let b=a.length-1;-1<b;--b)a[b].classList.remove("tb_element_clicked")},setPosition(a,b){a.removeAttribute("data-top");var d=a.getBoundingClientRect();const e=d.width;d=d.height+40;const f="visual"===c.mode?z.pageYOffset:c.toolbar.el.offsetTop+
this.topH,h="visual"===c.mode?m.body:c.Instances.Builder[0].el,g=h.clientWidth;b=void 0!==b.nodeType?k(b).offset():b;b.right=b.bottom="";b.left-=parseFloat(e/2);b.top-=d;b.left+e>g?(b.left="auto",b.right=10):0>b.left&&(b.left=30);b.top>h.clientHeight?"visual"!==c.mode&&(b.top="auto",b.bottom=50):f>b.top&&(a.dataset.top=!0,b.top+=2*d-25,"visual"!==c.mode&&(b.top-=d/2));for(let c in b)a.style[c]="auto"!==b[c]&&""!==b[c]?b[c]+"px":b[c]}};c.Forms.register_validator=function(a,b){this.Validators[a]=b};
c.Forms.get_validator=function(a){return void 0!==this.Validators[a]?this.Validators[a]:this.Validators.not_empty};c.Forms.register_validator("email",function(a){const b=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;a=a.split(",");for(let c=a.length-1;-1<c;--c)if(!b.test(a[c]))return!1;return!0});c.Forms.register_validator("not_empty",function(a){return!(!a||""===a.trim())});c.GS={styles:{},initContent:!1,
loadingPosts:!1,allLoaded:!1,el:null,dropdown:null,isShown:null,field:null,isGSPage:m.body.classList.contains("gs_post"),activeGS:null,xhr:null,key:"global_styles",previousModel:null,liveInstance:null,init(){if(!0===this.isGSPage)if(r.document.body.classList.add("gs_post"),"visual"!==c.mode||!0===u.is_builder_loaded)this.openStylingPanel();else{const a=this;r.Themify.body.one("themify_builder_ready",function(b){a.openStylingPanel()})}else null!==themifyBuilder.globalStyles&&(this.extend(this.styles,
themifyBuilder.globalStyles),themifyBuilder.globalStyles=null)},extend(a,b){for(let c in b)void 0!==b[c]&&(a[c]=b[c]);return a},openStylingPanel(){const a=function(){null===ThemifyConstructor.label&&(ThemifyConstructor.label=themifyBuilder.i18n.label);var b=themifyBuilder.globalStyleData.type;switch(b){case "row":case "column":b="module_"+b;break;case "subrow":b="active_subrow";break;default:b="active_module"}b=c.Models.Registry.lookup(c.Instances.Builder[c.builderIndex].el.getElementsByClassName(b)[0].dataset.cid);
b.set("styleClicked",{silent:!0});c.isPreview=!1;b.trigger("edit",null);c.isPreview=!0;u.body.one("themify_builder_save_data",a)};a();c.toolbar.el.getElementsByClassName("tb_toolbar_builder_preview")[0].click()},setCss(a,b,d){"visual"===c.mode&&c.liveStylingInstance.setCss(a,b,d)},createCss(a,b,c){ThemifyStyles.GS={};a=ThemifyStyles.createCss(a,b,c,this.styles);if(!0===c&&0<Object.keys(this.styles).length&&a.gs){a.gs.used="";for(let b in this.styles)a.gs.used+=""===a.gs.used?"":", ",a.gs.used+=this.styles[b].title}return a},
findUsedItems(a){a=JSON.stringify(a);var b=/"global_styles":"(.*?)"/mg;let c,e="";for(;null!==(c=b.exec(a));)e+=" "+c[1].trim();e=e.trim();if(""!==e){e=k.unique(e.split(" "));a=[];for(b=e.length-1;-1<b;--b)void 0!==this.styles[e[b]]&&a.push(e[b]);return a}return!1},globalStylesHTML(){if(!0===this.isGSPage||null!==this.activeGS)return!1;const a=m.createElement("div");var b=m.createElement("div");const d=m.createElement("span");this.isShown=null;this.field=ThemifyConstructor.hidden.render({id:c.GS.key,
is_responsive:!1,value:ThemifyConstructor.values[c.GS.key],control:!1},ThemifyConstructor);a.className="tb_gs_container";if(this.field.value){let a=this.field.value.split(" "),b="";for(let c=a.length-1;-1<c;--c)void 0!==this.styles[a[c]]&&(b+=" "+a[c]);b=b.trim();this.field.value=b}else this.field.value="";b.className="tb_gs_icon";b.addEventListener("click",function(a){if(a.target.classList.contains("tb_gs_icon")){const b=this.el;if(b.classList.contains("tb_gs_dropdown_opened"))a.stopPropagation(),
b.classList.remove("tb_gs_dropdown_action","tb_gs_dropdown_opened");else{b.classList.add("tb_gs_dropdown_opened","tb_gs_dropdown_action");const a=function(d){null===b||b.contains(d.target)||(m.removeEventListener("click",a,{passive:!0}),"visual"===c.mode&&r.document.removeEventListener("click",a,{passive:!0}),b.classList.remove("tb_gs_dropdown_action","tb_gs_dropdown_opened"))};m.addEventListener("mousedown",a,{passive:!0});"visual"===c.mode&&r.document.addEventListener("mousedown",a,{passive:!0})}}}.bind(this),
{passive:!0});d.className="tb_gs_tooltip";d.textContent=themifyBuilder.i18n.gs;b.appendChild(c.Utils.getIcon("ti-brush-alt"));b.appendChild(d);a.appendChild(this.field);a.appendChild(b);this.el=a;""!==this.field.value&&(b=this.stylingOverlay(),null!==b&&a.appendChild(b));a.addEventListener("click",this.initClickEvent.bind(this));this.initContent=!1;return this.el},initHTML(){var a=m.createElement("div"),b=this.field.value.trim();if(""!==b){b=b.split(" ");for(let c=0,e=b.length;c<e;++c)void 0!==this.styles[b[c]]&&
a.appendChild(this.createSelectedItem(b[c]))}a.className="tb_gs_selected_styles";this.el.appendChild(a);a=this.el.getElementsByClassName("tb_gs_icon")[0];a.parentNode.insertBefore(m.getElementById("tmpl-global_styles").content.cloneNode(!0),a.nextSibling);this.initContent=!0},createSelectedItem(a){const b=this.styles[a],d=m.createElement("div"),e=m.createElement("span"),f=m.createElement("span"),h=m.createElement("span");d.className="tb_selected_style";d.dataset.styleId=a;h.className="tb_gs_edit";
h.appendChild(c.Utils.getIcon("ti-pencil"));d.appendChild(h);e.innerText=b.title;d.appendChild(e);f.className="tb_delete_gs tf_close";d.appendChild(f);return d},saveAs(){const a=this;l.LiteLightbox.prompt(themifyBuilder.i18n.enterGlobalStyleName,function(b){if(null!==b){if(""===b)return alert(themifyBuilder.i18n.enterGlobalStyleName),a.saveAs(),!1;a.saveAsCallback(b)}})},saveAsCallback(a){ThemifyConstructor.setStylingValues(c.activeBreakPoint);let b=c.activeModel.get("elType");const d=this,e=c.Utils.clear(ThemifyConstructor.values);
"module"===b&&(b=c.activeModel.get("mod_name"));delete e[this.key];k.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_save_as_new_global_style",tb_load_nonce:themifyBuilder.tb_load_nonce,type:b,styles:e,title:a},beforeSend(){l.showLoader("show")},error(){l.showLoader("error")},success(a){l.showLoader("hide");"success"===a.status?(a=a.post_data,d.styles[a.class]=a,c.Utils.saveCss(c.Utils.clear(a.data),"",a.id),l.LiteLightbox.confirm(themifyBuilder.i18n.addSavedGS,function(b){if("yes"===
b){d.isGSPage=!0;b=d.field.value;l.Lightbox.$lightbox[0].getElementsByClassName("reset-styling")[0].click();d.isGSPage=!1;b=a.class+" "+b;b=b.trim();d.field.value=b;b=b.split(" ");const e=d.el.getElementsByClassName("tb_gs_selected_styles")[0];e.innerHTML="";for(let a=0,c=b.length;a<c;++a)e.appendChild(d.createSelectedItem(b[a]));c.GS.generateValues(null,b,!0);b=d.stylingOverlay();null!==b&&d.el.appendChild(b)}d.addItemToDropdown([a.class])},{buttons:{no:{label:ThemifyConstructor.label.no},yes:{label:ThemifyConstructor.label.y}}})):
alert(a.msg)}})},delete(a){if(null!==this.field){c.hasChanged=!0;var b=this.el.querySelector('.global_style_item[data-style-id="'+a+'"]');const d=this.el.querySelector('.tb_selected_style[data-style-id="'+a+'"]');null!==b&&b.classList.remove("selected");null!==d&&d.parentNode.removeChild(d);b=this.field.value.trim().split(" ");b.splice(b.indexOf(a),1);this.field.value=b=b.join(" ");null!==c.ActionBar.contextMenu&&c.ActionBar.contextMenu.contains(this.field)?c.ActionBar.rightClickGS(a,b,!0):this.generateValues(a,
b.split(" "),!0);return!0}},insert(a){if(null!==this.field){c.hasChanged=!0;null!==this.dropdown&&this.dropdown.querySelector('.global_style_item[data-style-id="'+a+'"]').classList.add("selected");this.el.getElementsByClassName("tb_gs_selected_styles")[0].appendChild(this.createSelectedItem(a));let d=this.field.value+" "+a;this.field.value=d=d.trim();if(""!==d){var b=this.stylingOverlay();null!==b&&(this.el.classList.add("tb_gs_dropdown_action"),this.el.appendChild(b))}null!==c.ActionBar.contextMenu&&
c.ActionBar.contextMenu.contains(this.field)?c.ActionBar.rightClickGS(a,d):this.generateValues(a,d.split(" "))}},search(){const a=this;this.el.querySelector("#global-style-search").addEventListener("input",function(b){const c=b.target.value.toUpperCase(),e=this.el,f=function(){const a=e.getElementsByClassName("tb_gs_list")[0].getElementsByClassName("global_style_item");for(let b=a.length-1;-1<b;--b){let d=a[b].getElementsByClassName("global_style_title")[0];d&&(a[b].style.display=-1<d.innerHTML.toUpperCase().indexOf(c)?
"":"none")}};null!==a.xhr&&(a.xhr.abort(),a.xhr=null);a.allLoaded||setTimeout(function(){a.loadMore(c,f)},100);f()}.bind(this),{passive:!0})},addItemToDropdown(a){if(null!==this.dropdown){var b=m.createDocumentFragment(),c=this.field.value.split(" "),e=this.dropdown.getElementsByClassName("tb_no_gs_item")[0];for(let d=0,e=a.length;d<e;++d){let e=this.styles[a[d]],f=m.createElement("div"),h=m.createElement("span"),k=m.createElement("span");f.className="global_style_item";f.className+=-1!==c.indexOf(a[d])?
" selected":"";f.dataset.styleId=a[d];k.className="global_style_title";k.innerText=e.title;h.className="global_style_type";h.innerText=e.type;f.appendChild(k);f.appendChild(h);b.appendChild(f)}e.parentNode.insertBefore(b,e)}},loadMore(a,b){const c=this,e=[];this.loadingPosts=!0;for(let a in this.styles)void 0!==this.styles[a].id&&e.push(this.styles[a].id);this.xhr=k.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{s:a,action:"tb_get_gs_posts",tb_load_nonce:themifyBuilder.tb_load_nonce,
loaded:e},success(d){c.extend(c.styles,d);d=Object.keys(d);a||(c.allLoaded=10>d.length);c.addItemToDropdown(d);c.loadingPosts=!1;b&&b()}})},initDropdown(){this.dropdown=this.el.getElementsByClassName("tb_gs_list")[0];const a=Object.keys(this.styles);this.addItemToDropdown(a);10>a.length&&!1===this.allLoaded&&this.loadMore();!1===this.allLoaded&&this.dropdown.addEventListener("scroll",this.onScroll.bind(this),{passive:!0});this.search()},initClickEvent(a){!0!==this.initContent&&this.initHTML();const b=
a.target,c=b.classList;if("LABEL"===b.nodeName||c.contains("tb_open_gs"))return!0;"insert"===b.dataset.action?(a.preventDefault(),a.stopImmediatePropagation(),this.el.classList.remove("tb_gs_dropdown_action"),void 0===b.dataset.init&&(this.initDropdown(),b.dataset.init=!0)):c.contains("global_style_title")?(a.preventDefault(),a.stopImmediatePropagation(),this.insert(b.parentNode.dataset.styleId)):c.contains("tb_delete_gs")?(a.preventDefault(),a.stopImmediatePropagation(),this.delete(b.parentNode.getAttribute("data-style-id"))):
"save"===b.dataset.action?(a.preventDefault(),a.stopImmediatePropagation(),this.saveAs()):c.contains("tb_gs_edit")&&this.liveEdit(b.parentNode.dataset.styleId)},onScroll(a){!1===this.allLoaded&&!1===this.loadingPosts&&(a=a.target,a=Math.max(a.scrollHeight-(a.scrollTop+a.offsetHeight),0),0<a&&200>=a&&(this.loadingPosts=!0,this.loadMore()))},updated(a,b,d,e){!1===this.isGSPage&&"visual"===c.mode&&"module"!==c.activeModel.get("elType")&&this.extraStyle(b,d,e)},setImport(a,b,c,e){if(!0!==e)for(let b in a)void 0!==
this.styles[b]&&delete a[b];if(0<Object.keys(a).length){this.loadingPosts=!0;const d=this;l.showLoader("show");k.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{onlySave:e?1:0,action:"tb_import_gs_posts_ajax",tb_load_nonce:themifyBuilder.tb_load_nonce,data:JSON.stringify(a)},error(){l.showLoader("error")},success(a){d.loadingPosts=!1;if(a)for(let b in a)d.styles[b]=a[b];b&&b(c);l.showLoader("hide")}})}else b&&b(c)},generateValues(a,b,d){if(!0!==this.isGSPage&&"visual"===c.mode){var e=
c.activeModel.get("elType");"module"===e&&(e=c.activeModel.get("mod_name"));var f=c.activeModel.get("element_id");f={styling:ThemifyStyles.generateGSstyles(b,e,this.styles),element_id:f};ThemifyStyles.disableNestedSel=!0;null===this.liveInstance&&(this.liveInstance=c.createStyleInstance(),this.liveInstance.init(!0,!0));e=this.createCss([f],e);var h=this.liveInstance,g=[],k=c.activeBreakPoint,l=h.prefix,m=new RegExp(l,"g");ThemifyStyles.disableNestedSel=null;if(!0===d){d=ThemifyConstructor.breakpointsReverse;
for(var r=d.length-1;-1<r;--r){c.activeBreakPoint=d[r];h.setMode(d[r],!0);var t=h.currentSheet;t=t.cssRules?t.cssRules:t.rules;for(var v=t.length-1;-1<v;--v)if(-1!==t[v].selectorText.indexOf(l)){let a=t[v].selectorText.replace(/,\s+/g,",").replace(m,"").split(","),b=t[v].cssText.split("{")[1].split(";");if(-1!==a[0].indexOf(".tb_text_wrap"))for(var u=a.length-1;0<u;--u)-1!==a[u].indexOf(".tb_text_wrap")&&a.splice(u,1);for(u=b.length-2;-1<u;--u)h.setLiveStyle(b[u].trim().split(": ")[0].trim(),"",a)}}}delete e.gs;
for(let a in e)if("fonts"===a||"cf_fonts"===a)for(let b in e[a])l=b,0<e[a][b].length&&(l+=":"+e[a][b].join(",")),g.push(l);else{c.activeBreakPoint=a;h.setMode(a,!0);for(let b in e[a]){l=b.replace(/,\s+/g,",").replace(m,"").split(",");for(let c=0,f=e[a][b].length;c<f;++c)for(d=e[a][b][c].split(";"),r=d.length-2;-1<r;--r)""!==d[r]&&(t=d[r].split(":")[0],v=d[r].replace(t+":","").trim(),"background-image"===t&&-1!==d[r].indexOf("svg")&&-1!==d[r].indexOf("data:")&&(v+=";"+d[r+1]),h.setLiveStyle(t,v,l))}}0<
g.length&&ThemifyConstructor.font_select.loadGoogleFonts(g.join("|"));c.activeBreakPoint=k;this.updated(a,e,f,b);this.liveInstance=null}},extraStyle(a,b,d){var e=null!==this.liveInstance?this.liveInstance:c.liveStylingInstance,f=e.prefix.length-1,h=0!==e.getComponentBgOverlay(c.activeModel.get("elType")).length;d=e.$liveStyledElmt;var g=h,k={top:!1,bottom:!1,left:!1,right:!1},l=0;a:for(var q in a)if("fonts"!==q&&"cf_fonts"!==q&&"gs"!==q)for(let b in a[q]){!1===g&&(g=-1!==b.indexOf("builder_row_cover",
f));if(-1!==b.indexOf("tb_row_frame",f))for(let a in k)if(!1===k[a]&&-1!==b.indexOf("tb_row_frame_"+a,f)){k[a]=!0;++l;break}if(!0===g&&4===l)break a}!1===h&&!0===g&&e.addOrRemoveComponentOverlay();if(0<l){a=m.createDocumentFragment();for(var r in k)!0===k[r]&&0===d.children(".tb_row_frame_"+r).length&&(q=m.createElement("div"),q.className="tf_abs tb_row_frame tb_row_frame_"+r,a.appendChild(q));d.children(".tb_action_wrap").after(a)}(r=void 0!==b.styling?b.styling.background_type:"none")||(r="image");
"image"===r&&"builder-parallax-scrolling"===b.styling.background_repeat&&b.styling.background_image?(d[0].classList.add("builder-parallax-scrolling"),ThemifyBuilderModuleJs.backgroundScrolling(d)):(d[0].classList.remove("builder-parallax-scrolling"),d[0].style.backgroundPosition="","image"===r&&"builder-zoom-scrolling"===b.styling.background_repeat&&b.styling.background_image?(d[0].classList.add("builder-zoom-scrolling"),ThemifyBuilderModuleJs.backgroundZoom(d)):(d[0].classList.remove("builder-zoom-scrolling"),
d[0].style.backgroundSize=""))},liveEdit(a){let b={styleClicked:!0},d,e=!1;if(null===c.activeModel&&null!==c.ActionBar.contextMenu&&c.ActionBar.contextMenu.contains(this.field)){var f=c.Instances.Builder[c.builderIndex].el.getElementsByClassName("tb_element_clicked")[0];if(void 0===f)return;c.activeModel=c.Models.Registry.lookup(f.getAttribute("data-cid"));b.element_id=c.activeModel.get("element_id");this.previousModel=c.activeModel.cid;e=!0;c.Utils.scrollToDropped(f)}else null!==c.activeModel&&(this.previousModel=
c.activeModel.cid,b.element_id=c.activeModel.get("element_id"),ThemifyConstructor.saveComponent(!0));const h=this.styles[a],g=this,n=ThemifyConstructor.label.done,p="visual"===c.mode?k.extend(!0,{},c.liveStylingInstance):null;f=k.extend(!0,{},h.data[0]);const q=h.type;this.activeGS=a;"row"===q?(delete f.cols,delete f.styling[this.key],d=c.Views.init_row(f)):"subrow"===q?(delete f.cols,delete f.styling[this.key],d=c.Views.init_subrow(f)):(delete f.styling,"column"===q?(delete f.cols[0].modules,delete f.cols[0].styling[this.key],
d=c.Views.init_column(f.cols[0])):(delete f.cols[0].styling,delete f.cols[0].modules[0].mod_settings[this.key],d=c.Views.init_module(f.cols[0].modules[0])));l.Lightbox.$lightbox[0].className+=" gs_post";ThemifyConstructor.label.done=ThemifyConstructor.label.s_s;c.ActionBar.hideContextMenu();l.Lightbox.$lightbox.one("themify_opened_lightbox.tb_gs_edit",function(){this.getElementsByClassName("current")[0].getElementsByClassName("tb_tooltip")[0].textContent=ThemifyConstructor.label.g_s+" - "+h.title});
d.model.set(b,{silent:!0});d.model.trigger("edit",null);const r=function(){u.body.off("themify_builder_lightbox_close.tb_gs_edit themify_builder_save_component.tb_gs_edit");l.Lightbox.$lightbox[0].classList.remove("gs_post");ThemifyConstructor.label.done=n;d.model.destroy();if("visual"===c.mode){if(p.prefix&&(c.liveStylingInstance=p,c.liveStylingInstance.$liveStyledElmt=k(m.querySelector(p.prefix)),null!==g.previousModel&&("row"===q||"column"===q||"subrow"===q))){const a=c.Models.Registry.lookup(g.previousModel);
a&&"module"===a.get("elType")&&(c.liveStylingInstance.getComponentBgOverlay().remove(),c.liveStylingInstance.removeBgSlider(),c.liveStylingInstance.removeBgVideo(),c.liveStylingInstance.$liveStyledElmt.children(".tb_row_frame").remove(),c.liveStylingInstance.$liveStyledElmt[0].classList.remove("builder-zoom-scrolling","builder-zooming"))}g.liveInstance=null}g.activeGS=null};u.body.one("themify_builder_lightbox_close.tb_gs_edit",function(a){r();e?g.previousModel=null:g.reopenPreviousPanel()}).one("themify_builder_save_component.tb_gs_edit",
function(a,b){a=g.activeGS;const d=g.styles[a],f=g.previousModel;delete ThemifyConstructor.values.cid;ThemifyConstructor.setStylingValues(c.activeBreakPoint);var h=ThemifyConstructor.values;const m=c.activeModel;delete h[this.key];"row"===q||"subrow"===q?(d.data[0].styling=h,delete d.data[0].cols):(delete d.data[0].styling,delete d.data[0].cols[0].grid_class,"column"===q?(delete d.data[0].cols[0].modules,d.data[0].cols[0].styling=h):(delete d.data[0].cols[0].styling,d.data[0].cols[0].modules[0].mod_settings=
h));l.showLoader("show");c.Utils.saveCss(d.data,"",d.id);d.data=c.Utils.clear(d.data);g.styles[a].data=d.data;g.activeGS=null;g.previousModel=null;if("visual"===c.mode&&c.hasChanged){h=c.Models.Registry.items;for(let b in h){let d="module"===h[b].get("elType")?h[b].get("mod_settings"):h[b].get("styling");void 0!==d[g.key]&&""!==d[g.key]&&-1!==d[g.key].indexOf(a)&&(c.activeModel=h[b],g.generateValues(a,d[g.key].split(" "),!0))}g.liveInstance=null}c.activeModel=m;g.previousModel=f;r(!0);c.hasChanged=
!1;k.ajax({type:"POST",url:themifyBuilder.ajaxurl,dataType:"json",data:{action:"tb_update_global_style",tb_load_nonce:themifyBuilder.tb_load_nonce,data:d.data,id:d.id},error(){l.showLoader("error")},success(){b||e?g.previousModel=null:g.reopenPreviousPanel();l.showLoader("hide")}})})},reopenPreviousPanel(a){void 0!==a?a.model.trigger("edit",a.e,a.target):null!==this.previousModel&&(a=c.Models.Registry.lookup(this.previousModel),null!==a&&(a.set({styleClicked:!0},{silent:!0}),a.trigger("edit",null)),
this.previousModel=null)},stylingOverlay(){if(null===this.isShown&&null!==c.activeModel&&(null===this.el.parentNode||!this.el.parentNode.classList.contains("tb_inline_gs_show"))){this.isShown=!0;const a=m.createElement("div"),b=m.createElement("p");a.className="tb_gs_options_overlay";b.textContent=themifyBuilder.i18n.has_gs;a.addEventListener("click",function(a){a.preventDefault();a.stopPropagation();this.parentNode.removeChild(this)},{once:!0});a.appendChild(b);return a}return null}}})(jQuery,Backbone,
Themify,window,window.top,document,ThemifyBuilderCommon);
